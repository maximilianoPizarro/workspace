2015-09-14 20:14:13,234 [main] INFO  c.n.h.c.p.n.NettyAsyncHttpProvider - Number of application's worked threads is 2
2015-09-14 20:14:15,875 [pool-6-thread-1] INFO  c.n.h.c.p.n.NettyAsyncHttpProvider - Number of application's worked threads is 2
2015-09-14 20:14:17,156 [main] ERROR o.e.r.i.r.repo.ModelRepositoryIndex - Failed to open search index.
org.apache.lucene.index.IndexNotFoundException: no segments* file found in org.apache.lucene.store.SimpleFSDirectory@E:\Orientacion a objetos\EclipsePortable\Data\workspace\.metadata\.plugins\org.eclipse.recommenders.rcp\index lockFactory=org.apache.lucene.store.NativeFSLockFactory@13f9ef: files: []
	at org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(SegmentInfos.java:712) ~[org.apache.lucene.core_3.5.0.v20120319-2345.jar:3.5.0 1204988 - simon - 2011-11-22 14:46:51]
	at org.apache.lucene.index.DirectoryReader.open(DirectoryReader.java:75) ~[org.apache.lucene.core_3.5.0.v20120319-2345.jar:3.5.0 1204988 - simon - 2011-11-22 14:46:51]
	at org.apache.lucene.index.IndexReader.open(IndexReader.java:462) ~[org.apache.lucene.core_3.5.0.v20120319-2345.jar:3.5.0 1204988 - simon - 2011-11-22 14:46:51]
	at org.apache.lucene.index.IndexReader.open(IndexReader.java:308) ~[org.apache.lucene.core_3.5.0.v20120319-2345.jar:3.5.0 1204988 - simon - 2011-11-22 14:46:51]
	at org.eclipse.recommenders.internal.rcp.repo.ModelRepositoryIndex.open(ModelRepositoryIndex.java:64) ~[org.eclipse.recommenders.rcp_1.0.0.v20120612-2305-b156.jar:na]
	at org.eclipse.recommenders.internal.rcp.wiring.RecommendersModule$ServicesInitializer.<init>(RecommendersModule.java:353) [org.eclipse.recommenders.rcp_1.0.0.v20120612-2305-b156.jar:na]
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) [na:1.6.0_18]
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source) [na:1.6.0_18]
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source) [na:1.6.0_18]
	at java.lang.reflect.Constructor.newInstance(Unknown Source) [na:1.6.0_18]
	at com.google.inject.internal.DefaultConstructionProxyFactory$1.newInstance(DefaultConstructionProxyFactory.java:85) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.ConstructorInjector.construct(ConstructorInjector.java:85) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.ConstructorBindingImpl$Factory.get(ConstructorBindingImpl.java:254) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1031) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.Scopes$1$1.get(Scopes.java:65) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.InternalInjectorCreator$1.call(InternalInjectorCreator.java:204) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.InternalInjectorCreator$1.call(InternalInjectorCreator.java:198) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1024) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.InternalInjectorCreator.loadEagerSingletons(InternalInjectorCreator.java:198) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.InternalInjectorCreator.injectDynamically(InternalInjectorCreator.java:179) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.InternalInjectorCreator.build(InternalInjectorCreator.java:109) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.Guice.createInjector(Guice.java:95) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.Guice.createInjector(Guice.java:72) [com.google.inject_3.0.0.v201203062045.jar:na]
	at org.eclipse.recommenders.injection.InjectionService.getInjector(InjectionService.java:47) [org.eclipse.recommenders.injection_1.0.0.v20120612-2305-b156.jar:na]
	at org.eclipse.recommenders.injection.ExtensionFactory.<init>(ExtensionFactory.java:28) [org.eclipse.recommenders.injection_1.0.0.v20120612-2305-b156.jar:na]
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) [na:1.6.0_18]
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source) [na:1.6.0_18]
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source) [na:1.6.0_18]
	at java.lang.reflect.Constructor.newInstance(Unknown Source) [na:1.6.0_18]
	at java.lang.Class.newInstance0(Unknown Source) [na:1.6.0_18]
	at java.lang.Class.newInstance(Unknown Source) [na:1.6.0_18]
	at org.eclipse.core.internal.registry.osgi.RegistryStrategyOSGI.createExecutableExtension(RegistryStrategyOSGI.java:184) [org.eclipse.equinox.registry_3.5.200.v20120522-1841.jar:na]
	at org.eclipse.core.internal.registry.ExtensionRegistry.createExecutableExtension(ExtensionRegistry.java:905) [org.eclipse.equinox.registry_3.5.200.v20120522-1841.jar:na]
	at org.eclipse.core.internal.registry.ConfigurationElement.createExecutableExtension(ConfigurationElement.java:243) [org.eclipse.equinox.registry_3.5.200.v20120522-1841.jar:na]
	at org.eclipse.core.internal.registry.ConfigurationElementHandle.createExecutableExtension(ConfigurationElementHandle.java:55) [org.eclipse.equinox.registry_3.5.200.v20120522-1841.jar:na]
	at org.eclipse.jdt.internal.ui.text.java.CompletionProposalComputerDescriptor.createComputer(CompletionProposalComputerDescriptor.java:308) [org.eclipse.jdt.ui_3.8.0.v20120524-1551.jar:na]
	at org.eclipse.jdt.internal.ui.text.java.CompletionProposalComputerDescriptor.getComputer(CompletionProposalComputerDescriptor.java:275) [org.eclipse.jdt.ui_3.8.0.v20120524-1551.jar:na]
	at org.eclipse.jdt.internal.ui.text.java.CompletionProposalComputerDescriptor.sessionStarted(CompletionProposalComputerDescriptor.java:418) [org.eclipse.jdt.ui_3.8.0.v20120524-1551.jar:na]
	at org.eclipse.jdt.internal.ui.text.java.CompletionProposalCategory.sessionStarted(CompletionProposalCategory.java:379) [org.eclipse.jdt.ui_3.8.0.v20120524-1551.jar:na]
	at org.eclipse.jdt.internal.ui.text.java.ContentAssistProcessor$CompletionListener.assistSessionStarted(ContentAssistProcessor.java:117) [org.eclipse.jdt.ui_3.8.0.v20120524-1551.jar:na]
	at org.eclipse.jface.text.contentassist.ContentAssistant.fireSessionBeginEvent(ContentAssistant.java:2221) [org.eclipse.jface.text_3.8.0.v20120531-0600.jar:na]
	at org.eclipse.jface.text.contentassist.ContentAssistant.prepareToShowCompletions(ContentAssistant.java:1696) [org.eclipse.jface.text_3.8.0.v20120531-0600.jar:na]
	at org.eclipse.jface.text.contentassist.ContentAssistant.access$6(ContentAssistant.java:1687) [org.eclipse.jface.text_3.8.0.v20120531-0600.jar:na]
	at org.eclipse.jface.text.contentassist.ContentAssistant$2.run(ContentAssistant.java:376) [org.eclipse.jface.text_3.8.0.v20120531-0600.jar:na]
	at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35) [org.eclipse.swt.win32.win32.x86_3.100.0.v4233d.jar:na]
	at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:135) [org.eclipse.swt.win32.win32.x86_3.100.0.v4233d.jar:na]
	at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:4144) [org.eclipse.swt.win32.win32.x86_3.100.0.v4233d.jar:na]
	at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3761) [org.eclipse.swt.win32.win32.x86_3.100.0.v4233d.jar:na]
	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1022) [org.eclipse.e4.ui.workbench.swt_0.10.1.v20120525-2014.jar:na]
	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) [org.eclipse.core.databinding.observable_1.4.1.v20120521-2329.jar:na]
	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:916) [org.eclipse.e4.ui.workbench.swt_0.10.1.v20120525-2014.jar:na]
	at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:86) [org.eclipse.e4.ui.workbench_0.10.2.v20120531-1742.jar:na]
	at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:585) [org.eclipse.ui.workbench_3.103.0.v20120530-1824.jar:na]
	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) [org.eclipse.core.databinding.observable_1.4.1.v20120521-2329.jar:na]
	at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:540) [org.eclipse.ui.workbench_3.103.0.v20120530-1824.jar:na]
	at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149) [org.eclipse.ui.workbench_3.103.0.v20120530-1824.jar:na]
	at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:124) [org.eclipse.ui.ide.application_1.0.400.v20120523-1955.jar:na]
	at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) [org.eclipse.equinox.app_1.3.100.v20120522-1841.jar:na]
	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110) [org.eclipse.osgi_3.8.0.v20120529-1548.jar:na]
	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79) [org.eclipse.osgi_3.8.0.v20120529-1548.jar:na]
	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:353) [org.eclipse.osgi_3.8.0.v20120529-1548.jar:na]
	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:180) [org.eclipse.osgi_3.8.0.v20120529-1548.jar:na]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.6.0_18]
	at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) ~[na:1.6.0_18]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) ~[na:1.6.0_18]
	at java.lang.reflect.Method.invoke(Unknown Source) ~[na:1.6.0_18]
	at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:629) [org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar:na]
	at org.eclipse.equinox.launcher.Main.basicRun(Main.java:584) [org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar:na]
	at org.eclipse.equinox.launcher.Main.run(Main.java:1438) [org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar:na]
2015-09-14 20:14:19,250 [Worker-19] WARN  o.e.r.i.rcp.repo.ModelRepository - 'remote-models (http://download.eclipse.org/recommenders/models/juno/, releases+snapshots)' did not send ETAG header for 'org.eclipse.recommenders:index:pom:0.0.0'.
2015-09-14 20:14:19,406 [Worker-19] ERROR o.e.r.i.r.repo.ModelRepositoryIndex - Failed to open search index.
org.apache.lucene.index.IndexNotFoundException: no segments* file found in org.apache.lucene.store.SimpleFSDirectory@E:\Orientacion a objetos\EclipsePortable\Data\workspace\.metadata\.plugins\org.eclipse.recommenders.rcp\index lockFactory=org.apache.lucene.store.NativeFSLockFactory@16cb627: files: []
	at org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(SegmentInfos.java:712) ~[org.apache.lucene.core_3.5.0.v20120319-2345.jar:3.5.0 1204988 - simon - 2011-11-22 14:46:51]
	at org.apache.lucene.index.DirectoryReader.open(DirectoryReader.java:75) ~[org.apache.lucene.core_3.5.0.v20120319-2345.jar:3.5.0 1204988 - simon - 2011-11-22 14:46:51]
	at org.apache.lucene.index.IndexReader.open(IndexReader.java:462) ~[org.apache.lucene.core_3.5.0.v20120319-2345.jar:3.5.0 1204988 - simon - 2011-11-22 14:46:51]
	at org.apache.lucene.index.IndexReader.open(IndexReader.java:308) ~[org.apache.lucene.core_3.5.0.v20120319-2345.jar:3.5.0 1204988 - simon - 2011-11-22 14:46:51]
	at org.eclipse.recommenders.internal.rcp.repo.ModelRepositoryIndex.open(ModelRepositoryIndex.java:64) ~[org.eclipse.recommenders.rcp_1.0.0.v20120612-2305-b156.jar:na]
	at org.eclipse.recommenders.internal.rcp.repo.UpdateModelIndexJob.run(UpdateModelIndexJob.java:55) [org.eclipse.recommenders.rcp_1.0.0.v20120612-2305-b156.jar:na]
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54) [org.eclipse.core.jobs_3.5.200.v20120521-2346.jar:na]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          <?xml version="1.0" encoding="ASCII"?>
<application:Application xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:advanced="http://www.eclipse.org/ui/2010/UIModel/application/ui/advanced" xmlns:application="http://www.eclipse.org/ui/2010/UIModel/application" xmlns:basic="http://www.eclipse.org/ui/2010/UIModel/application/ui/basic" xmlns:menu="http://www.eclipse.org/ui/2010/UIModel/application/ui/menu" xmi:id="_RP54wFiUEeW7M-K_m5KQEw" elementId="org.eclipse.e4.legacy.ide.application" contributorURI="platform:/plugin/org.eclipse.ui.workbench" selectedElement="_RP54wViUEeW7M-K_m5KQEw" bindingContexts="_RQJJnliUEeW7M-K_m5KQEw">
  <persistedState key="memento" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xD;&#xA;&lt;workbench>&#xD;&#xA;&lt;mruList>&#xD;&#xA;&lt;file factoryID=&quot;org.eclipse.ui.part.FileEditorInputFactory&quot; id=&quot;org.eclipse.jdt.ui.CompilationUnitEditor&quot; name=&quot;TestFunciones.java&quot; tooltip=&quot;Funciones/src/test/TestFunciones.java&quot;>&#xD;&#xA;&lt;persistable path=&quot;/Funciones/src/test/TestFunciones.java&quot;/>&#xD;&#xA;&lt;/file>&#xD;&#xA;&lt;file factoryID=&quot;org.eclipse.ui.part.FileEditorInputFactory&quot; id=&quot;org.eclipse.jdt.ui.CompilationUnitEditor&quot; name=&quot;Funciones.java&quot; tooltip=&quot;Funciones/src/modelo/Funciones.java&quot;>&#xD;&#xA;&lt;persistable path=&quot;/Funciones/src/modelo/Funciones.java&quot;/>&#xD;&#xA;&lt;/file>&#xD;&#xA;&lt;file factoryID=&quot;org.eclipse.ui.part.FileEditorInputFactory&quot; id=&quot;org.eclipse.jdt.ui.CompilationUnitEditor&quot; name=&quot;TestPediatria.java&quot; tooltip=&quot;HospitalPediatria/src/vista/TestPediatria.java&quot;>&#xD;&#xA;&lt;persistable path=&quot;/HospitalPediatria/src/vista/TestPediatria.java&quot;/>&#xD;&#xA;&lt;/file>&#xD;&#xA;&lt;file factoryID=&quot;org.eclipse.ui.part.FileEditorInputFactory&quot; id=&quot;org.eclipse.jdt.ui.CompilationUnitEditor&quot; name=&quot;Funciones.java&quot; tooltip=&quot;HospitalPediatria/src/modelo/Funciones.java&quot;>&#xD;&#xA;&lt;persistable path=&quot;/HospitalPediatria/src/modelo/Funciones.java&quot;/>&#xD;&#xA;&lt;/file>&#xD;&#xA;&lt;file factoryID=&quot;org.eclipse.ui.part.FileEditorInputFactory&quot; id=&quot;org.eclipse.jdt.ui.CompilationUnitEditor&quot; name=&quot;TestCalendario.java&quot; tooltip=&quot;Calendario/src/test/TestCalendario.java&quot;>&#xD;&#xA;&lt;persistable path=&quot;/Calendario/src/test/TestCalendario.java&quot;/>&#xD;&#xA;&lt;/file>&#xD;&#xA;&lt;file factoryID=&quot;org.eclipse.ui.part.FileEditorInputFactory&quot; id=&quot;org.eclipse.jdt.ui.CompilationUnitEditor&quot; name=&quot;Funciones.java&quot; tooltip=&quot;Calendario/src/modelo/Funciones.java&quot;>&#xD;&#xA;&lt;persistable path=&quot;/Calendario/src/modelo/Funciones.java&quot;/>&#xD;&#xA;&lt;/file>&#xD;&#xA;&lt;file factoryID=&quot;org.eclipse.ui.part.FileEditorInputFactory&quot; id=&quot;org.eclipse.jdt.ui.CompilationUnitEditor&quot; name=&quot;Auto.java&quot; tooltip=&quot;autoEjPolimorfismo/src/modelo/Auto.java&quot;>&#xD;&#xA;&lt;persistable path=&quot;/autoEjPolimorfismo/src/modelo/Auto.java&quot;/>&#xD;&#xA;&lt;/file>&#xD;&#xA;&lt;file factoryID=&quot;org.eclipse.ui.part.FileEditorInputFactory&quot; id=&quot;org.eclipse.jdt.ui.CompilationUnitEditor&quot; name=&quot;Paciente.java&quot; tooltip=&quot;HospitalPediatria/src/modelo/Paciente.java&quot;>&#xD;&#xA;&lt;persistable path=&quot;/HospitalPediatria/src/modelo/Paciente.java&quot;/>&#xD;&#xA;&lt;/file>&#xD;&#xA;&lt;file factoryID=&quot;org.eclipse.ui.part.FileEditorInputFactory&quot; id=&quot;org.eclipse.jdt.ui.CompilationUnitEditor&quot; name=&quot;TestPediatria.java&quot; tooltip=&quot;ProyectoPediatria/src/vista/TestPediatria.java&quot;>&#xD;&#xA;&lt;persistable path=&quot;/ProyectoPediatria/src/vista/TestPediatria.java&quot;/>&#xD;&#xA;&lt;/file>&#xD;&#xA;&lt;file factoryID=&quot;org.eclipse.ui.part.FileEditorInputFactory&quot; id=&quot;org.eclipse.jdt.ui.CompilationUnitEditor&quot; name=&quot;Funciones.java&quot; tooltip=&quot;ProyectoPediatria/src/modelo/Funciones.java&quot;>&#xD;&#xA;&lt;persistable path=&quot;/ProyectoPediatria/src/modelo/Funciones.java&quot;/>&#xD;&#xA;&lt;/file>&#xD;&#xA;&lt;file factoryID=&quot;org.eclipse.ui.part.FileEditorInputFactory&quot; id=&quot;org.eclipse.jdt.ui.CompilationUnitEditor&quot; name=&quot;Paciente.java&quot; tooltip=&quot;ProyectoPediatria/src/modelo/Paciente.java&quot;>&#xD;&#xA;&lt;persistable path=&quot;/ProyectoPediatria/src/modelo/Paciente.java&quot;/>&#xD;&#xA;&lt;/file>&#xD;&#xA;&lt;file factoryID=&quot;org.eclipse.ui.part.FileEditorInputFactory&quot; id=&quot;org.eclipse.jdt.ui.CompilationUnitEditor&quot; name=&quot;FUNCIONES.java&quot; tooltip=&quot;ProyectoPediatria/src/modelo/FUNCIONES.java&quot;>&#xD;&#xA;&lt;persistable path=&quot;/ProyectoPediatria/src/modelo/FUNCIONES.java&quot;/>&#xD;&#xA;&lt;/file>&#xD;&#xA;&lt;file factoryID=&quot;org.eclipse.ui.part.FileEditorInputFactory&quot; id=&quot;org.eclipse.jdt.ui.CompilationUnitEditor&quot; name=&quot;FUNCIONES.java&quot; tooltip=&quot;Calendario/src/modelo/FUNCIONES.java&quot;>&#xD;&#xA;&lt;persistable path=&quot;/Calendario/src/modelo/FUNCIONES.java&quot;/>&#xD;&#xA;&lt;/file>&#xD;&#xA;&lt;/mruList>&#xD;&#xA;&lt;/workbench>"/>
  <tags>activeSchemeId:org.eclipse.ui.defaultAcceleratorConfiguration</tags>
  <tags>ModelMigrationProcessor.001</tags>
  <children xsi:type="basic:TrimmedWindow" xmi:id="_RP54wViUEeW7M-K_m5KQEw" elementId="IDEWindow" contributorURI="platform:/plugin/org.eclipse.ui.workbench" selectedElement="_RP6f0FiUEeW7M-K_m5KQEw" x="0" y="0" width="1024" height="768">
    <persistedState key="coolBarVisible" value="true"/>
    <persistedState key="perspectiveBarVisible" value="true"/>
    <persistedState key="workingSets" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xD;&#xA;&lt;workingSets/>"/>
    <persistedState key="aggregateWorkingSetId" value="Aggregate for window 1440189320718"/>
    <tags>topLevel</tags>
    <tags>shellMaximized</tags>
    <children xsi:type="basic:PartSashContainer" xmi:id="_RP6f0FiUEeW7M-K_m5KQEw" selectedElement="_RP6f0ViUEeW7M-K_m5KQEw" horizontal="true">
      <children xsi:type="advanced:PerspectiveStack" xmi:id="_RP6f0ViUEeW7M-K_m5KQEw" elementId="PerspectiveStack" containerData="7500" selectedElement="_RP6f0liUEeW7M-K_m5KQEw">
        <children xsi:type="advanced:Perspective" xmi:id="_RP6f0liUEeW7M-K_m5KQEw" elementId="org.eclipse.jdt.ui.JavaPerspective" selectedElement="_RP6f01iUEeW7M-K_m5KQEw" label="Java" iconURI="platform:/plugin/org.eclipse.jdt.ui/icons/full/eview16/jperspective.gif">
          <persistedState key="persp.hiddenItems" value="persp.hideToolbarSC:org.eclipse.debug.ui.commands.RunToLine,persp.hideToolbarSC:org.eclipse.jdt.ui.actions.OpenProjectWizard,persp.hideToolbarSC:org.eclipse.ui.edit.text.toggleShowSelectedElementOnly,"/>
          <tags>persp.actionSet:org.eclipse.mylyn.context.ui.actionSet</tags>
          <tags>persp.actionSet:org.eclipse.mylyn.doc.actionSet</tags>
          <tags>persp.actionSet:org.eclipse.mylyn.tasks.ui.navigation</tags>
          <tags>persp.actionSet:org.eclipse.ui.cheatsheets.actionSet</tags>
          <tags>persp.actionSet:org.eclipse.search.searchActionSet</tags>
          <tags>persp.actionSet:org.eclipse.ui.edit.text.actionSet.annotationNavigation</tags>
          <tags>persp.actionSet:org.eclipse.ui.edit.text.actionSet.navigation</tags>
          <tags>persp.actionSet:org.eclipse.ui.edit.text.actionSet.convertLineDelimitersTo</tags>
          <tags>persp.actionSet:org.eclipse.ui.externaltools.ExternalToolsSet</tags>
          <tags>persp.actionSet:org.eclipse.ui.actionSet.keyBindings</tags>
          <tags>persp.actionSet:org.eclipse.ui.actionSet.openFiles</tags>
          <tags>persp.actionSet:org.eclipse.wb.core.ui.actionset</tags>
          <tags>persp.actionSet:org.eclipse.debug.ui.launchActionSet</tags>
          <tags>persp.actionSet:org.eclipse.jdt.ui.JavaActionSet</tags>
          <tags>persp.actionSet:org.eclipse.jdt.ui.JavaElementCreationActionSet</tags>
          <tags>persp.act.           uó.G.G
 ó.GPE    ..          uó.G.G
 ó.G4E    Âb 4 1 6 a  ‘d   ˇˇˇˇˇˇˇˇ  ˇˇˇˇÂ0 1 5 1 4  ‘0 7 d 8 d 6   a f Â6 0 2 1 1  ‘4 a 7 a 4 5   5 0 Â02114~1     xó.G.G  ¿ê'GQE™                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   package test;

public class TestFunciones {

	/**
	 * @param args
	 */
	public static void main(String[] args) {
		// TODO Auto-generated method stub

	}

}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      .           {ó.G.G
 ó.GRE    ..          {ó.G.G
 ó.G4E    Âd b b 5 c  gb   ˇˇˇˇˇˇˇˇ  ˇˇˇˇÂ0 1 5 1 0  gd 3 9 b c e   1 d Âc 0 8 9 5  g8 5 1 9 0 5   8 0 Â08958~1     }ó.G.G  zZ+GSE,  Âa 0 4 e 7  9   ˇˇˇˇˇˇˇˇ  ˇˇˇˇÂ0 1 5 1 9  1 1 9 6 6 0   c 2 Âe 0 f 6 9  9 6 e 9 a 5   8 0 Â0F699~1     Äó.G.G   d+GUEm                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  package modelo;
import java.util.Calendar;
import java.util.GregorianCalendar;

public class Funciones {
	//DIA
	public static String traerDia(GregorianCalendar fecha){
		String dia= String.valueOf(traerNroDia(fecha)); 
		if(traerNroDia(fecha)<10){
			dia="0"+dia;}
		return dia; 
	}
		
	public static int traerNroDia(GregorianCalendar fecha){
		return fecha.get(Calendar.DAY_OF_MONTH);
	}
	public static int traerNroDeDia(GregorianCalendar fecha){
		return fecha.get(Calendar.DAY_OF_WEEK);
	}
	public static String traerDiaEnLetras(GregorianCalendar fecha){
		String[] diaEnLetra= {"Domingo","Lunes","Martes","Miercoles","Jueves","Viernes","Sabado"};
		return diaEnLetra[traerNroDeDia(fecha)-1];
	}
	public static boolean esDiaHabil(GregorianCalendar fecha){
		if((traerDiaEnLetras(fecha).compareTo("Sabado")==1)||(traerDiaEnLetras(fecha).compareTo("Domingo")==1));
		return true;
	}
	
	//MES
	public static String traerMes(GregorianCalendar fecha){
		String mes=String.valueOf(traerNroMes(fecha));
		if(traerNroMes(fecha)<10){
			mes="0"+mes;
			}
		return mes;
	}
	
	public static int traerNroMes(GregorianCalendar fecha){
		return fecha.get(Calendar.MONTH)+1;		
	}
	
	
	public static String traerMesEnLetras(GregorianCalendar fecha){
		
		String[] mesEnLetra= {"Diciembre","Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre"};
		return mesEnLetra[traerNroMes(fecha)];
	}
	
	//A—O
	public static String traerAnio(GregorianCalendar fecha){
		return String.valueOf(traerNroAnio(fecha));
	}
	public static int traerNroAnio(GregorianCalendar fecha){
		return fecha.get(Calendar.YEAR);
	}
	
	//FORMATO FECHAS
	
	public static String traerFechaCorta(GregorianCalendar fecha){
		return traerDia(fecha)+"/"+traerMes(fecha)+"/"+traerAnio(fecha);
	}
	
	public static String traerFechaLarga(GregorianCalendar fecha){
		return traerDia(fecha)+" de "+traerMesEnLetras(fecha)+" de "+traerAnio(fecha);
		
	}
	public static GregorianCalendar traerFecha(int anio, int mes, int dia){
		return new GregorianCalendar (anio,mes-1,dia);
	}
	//HORA
	public static String traerHora(GregorianCalendar f)
	
	{
		String ap="am";
		String hora="";
		if(f.get(Calendar.AM_PM)==1){
			ap="pm";

		}
		hora=""+f.get(Calendar.HOUR_OF_DAY)+":"+f.get(Calendar.MINUTE)+":"+f.get(Calendar.SECOND)+" "+ap;
		
		return hora;
	}
	
	//Fecha en String de 12 (dd/mm/aaaa) separado por / y por -
	
	//Funciones de comparacion de fechas:dos fechas como parametros
	//Mayores
	public static boolean esDiaMayor(GregorianCalendar f, GregorianCalendar fecha){
		boolean respuesta=false;
		if(traerNroDia(f)>traerNroDia(fecha))respuesta=true;
		return respuesta;
	}
	public static boolean esMesMayor(GregorianCalendar f, GregorianCalendar fecha){
		boolean respuesta=false;
		if(traerNroMes(f)>traerNroMes(fecha))respuesta=true;
		return respuesta;
	}
	public static boolean esAnioMayor(GregorianCalendar f, GregorianCalendar fecha){
		boolean respuesta=false;
		if(traerNroAnio(f)>traerNroAnio(fecha))respuesta=true;
		return respuesta;
	}
	//Iguales
	public static boolean esDiaIgual(GregorianCalendar f, GregorianCalendar fecha){
		boolean respuesta=false;
		if(traerNroDia(f)==traerNroDia(fecha))respuesta=true;
		return respuesta;
	}
	public static boolean esMesIgual(GregorianCalendar f, GregorianCalendar fecha){
		boolean respuesta=false;
		if(traerNroMes(f)==traerNroMes(fecha))respuesta=true;
		return respuesta;
	}
	public static boolean esAnioIgual(GregorianCalendar f, GregorianCalendar fecha){
		boolean respuesta=false;
		if(traerNroAnio(f)==traerNroAnio(fecha))respuesta=true;
		return respuesta;
	}
	//Menores
	/*Para aÒos con diferencias menores que 1, ej:2015 y 2014, retorna true*/
	public static boolean diferenciaAnioDeUno(GregorianCalendar f, GregorianCalendar fecha){
		boolean respuesta=false;
		if(traerNroAnio(f)-traerNroAnio(fecha)==1)respuesta=true;
		return respuesta;
	}
	
	
	public static int cantidadDiasMes(GregorianCalendar fecha){
		Integer[] cantidad={31,28,31,30,31,30,31,31,30,31,30,31};
		return cantidad[traerNroMes(fecha)-1];	
	}
	
	public static int cantidadDiasMesAnterior(GregorianCalendar fecha){
		Integer[] cantidad={31,31,28,31,30,31,30,31,31,30,31,30};
		return cantidad[traerNroMes(fecha)-1];
	}
	
	
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    package modelo;
import java.util.Calendar;
import java.util.GregorianCalendar;

public class Funciones {
	//DIA
	public static String traerDia(GregorianCalendar fecha){
		String dia= String.valueOf(traerNroDia(fecha)); 
		if(traerNroDia(fecha)<10){
			dia="0"+dia;}
		return dia; 
	}
		
	public static int traerNroDia(GregorianCalendar fecha){
		return fecha.get(Calendar.DAY_OF_MONTH);
	}
	public static int traerNroDeDia(GregorianCalendar fecha){
		return fecha.get(Calendar.DAY_OF_WEEK);
	}
	public static String traerDiaEnLetras(GregorianCalendar fecha){
		String[] diaEnLetra= {"Domingo","Lunes","Martes","Miercoles","Jueves","Viernes","Sabado"};
		return diaEnLetra[traerNroDeDia(fecha)-1];
	}
	
	
	public static boolean esDiaHabil(GregorianCalendar fecha){
		return !(traerDiaEnLetras(fecha).compareTo("Sabado")==0)||(traerDiaEnLetras(fecha).compareTo("Domingo")==0);
	}
	
	//MES
	public static String traerMes(GregorianCalendar fecha){
		String mes=String.valueOf(traerNroMes(fecha));
		if(traerNroMes(fecha)<10){
			mes="0"+mes;
			}
		return mes;
	}
	
	public static int traerNroMes(GregorianCalendar fecha){
		return fecha.get(Calendar.MONTH)+1;		
	}
	
	
	public static String traerMesEnLetras(GregorianCalendar fecha){
		
		String[] mesEnLetra= {"Diciembre","Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre"};
		return mesEnLetra[traerNroMes(fecha)];
	}
	
	//A—O
	public static String traerAnio(GregorianCalendar fecha){
		return String.valueOf(traerNroAnio(fecha));
	}
	public static int traerNroAnio(GregorianCalendar fecha){
		return fecha.get(Calendar.YEAR);
	}
	
	//FORMATO FECHAS
	
	public static String traerFechaCorta(GregorianCalendar fecha){
		return traerDia(fecha)+"/"+traerMes(fecha)+"/"+traerAnio(fecha);
	}
	
	public static String traerFechaLarga(GregorianCalendar fecha){
		return traerDia(fecha)+" de "+traerMesEnLetras(fecha)+" de "+traerAnio(fecha);
		
	}
	public static GregorianCalendar traerFecha(int anio, int mes, int dia){
		return new GregorianCalendar (anio,mes-1,dia);
	}
	//HORA
	public static String traerHora(GregorianCalendar f)
	
	{
		String ap="am";
		String hora="";
		if(f.get(Calendar.AM_PM)==1){
			ap="pm";

		}
		hora=""+f.get(Calendar.HOUR_OF_DAY)+":"+f.get(Calendar.MINUTE)+":"+f.get(Calendar.SECOND)+" "+ap;
		
		return hora;
	}
	
	//Fecha en String de 12 (dd/mm/aaaa) separado por / y por -
	
	//Funciones de comparacion de fechas:dos fechas como parametros
	//Mayores
	public static boolean esDiaMayor(GregorianCalendar f, GregorianCalendar fecha){
		return (traerNroDia(f)>traerNroDia(fecha));
	}
	public static boolean esMesMayor(GregorianCalendar f, GregorianCalendar fecha){
		return (traerNroMes(f)>traerNroMes(fecha));
	}
	public static boolean esAnioMayor(GregorianCalendar f, GregorianCalendar fecha){
		return (traerNroAnio(f)>traerNroAnio(fecha));
	}
	//Iguales
	public static boolean esDiaIgual(GregorianCalendar f, GregorianCalendar fecha){
		return(traerNroDia(f)==traerNroDia(fecha));
	}
	public static boolean esMesIgual(GregorianCalendar f, GregorianCalendar fecha){
		return (traerNroMes(f)==traerNroMes(fecha));
	}
	public static boolean esAnioIgual(GregorianCalendar f, GregorianCalendar fecha){
		return (traerNroAnio(f)==traerNroAnio(fecha));
	}
	//Menores
	/*Para aÒos con diferencias menores que 1, ej:2015 y 2014, retorna true*/
	public static boolean diferenciaAnioDeUno(GregorianCalendar f, GregorianCalendar fecha){
		return (traerNroAnio(f)-traerNroAnio(fecha)==1);
	}
	
	
	public static int cantidadDiasMes(GregorianCalendar fecha){
		Integer[] cantidad={31,28,31,30,31,30,31,31,30,31,30,31};
		return cantidad[traerNroMes(fecha)-1];	
	}
	
	public static int cantidadDiasMes(int anio, int mes){
		Integer[] cantidad={31,28,31,30,31,30,31,31,30,31,30,31};
		if(esBisiesto(anio))
		{
			cantidad[1]=29;
		}

		return cantidad[mes-1];	
	}
	
	public static int cantidadDiasMesAnterior(GregorianCalendar fecha){
		Integer[] cantidad={31,31,28,31,30,31,30,31,31,30,31,30};
		return cantidad[traerNroMes(fecha)-1];
	}
	
	 public static boolean esBisiesto(int anio)
	 
	 {
		 boolean respuesta=false;
		 if(anio%4==0&&anio%100!=0||anio%400==0)
		 {
			 respuesta=true;
		 }
		 return respuesta;
		 
	 }
	

	 public static boolean esFechaValida(int anio, int mes, int dia)
	 {
		 boolean respuesta=false;
		 if (anio>0)
		 {
		 if(mes>0 && mes<13)
		 	{
			 	mes=cantidadDiasMes(anio,mes);
			 	if(dia>0 && dia<=mes)
			 	{
			 		respuesta=true;
			 	} 
		 	}
	     }
		 return respuesta;
	 }
	 

	 public static GregorianCalendar traerFecha(String fecha)
	 {
		 // 0 1 2 3 4 5 6 7 8 9
		 //	2 4 / 0 5 / 1 9 9 1
		 int dia=Integer.parseInt(fecha.substring(0,2));
		 int mes=Integer.parseInt(fecha.substring(3,5));
		 int anio=Integer.parseInt(fecha.substring(6,10));

		 return traerFecha(anio,mes,dia);
		 
	 }
	 
	 public static boolean sonFechasIguales(GregorianCalendar fecha, GregorianCalendar fecha1)
	 {
		 return (traerNroAnio(fecha)==traerNroAnio(fecha1)&&traerNroMes(fecha)==traerNroMes(fecha1)&&traerNroDeDia(fecha)==traerNroDeDia(fecha1));
	 }
	
	 public static double aproximar2Decimal(double valor)
	 {
		 valor=valor+0.005;
		 String v = String.valueOf(valor);
		 v=v.substring(0,v.length());
		 return Double.parseDouble(v);
		 
		 
	 }
	
	
	
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   .           Éó.G.G
 ó.GWE    ..          Éó.G.G
 ó.G4E    Âd b b 5 c  b   ˇˇˇˇˇˇˇˇ  ˇˇˇˇÂ0 1 5 1 0  d 3 9 b c e   1 d Âb 0 a 8 f  1 8 7 8 e 5   8 0 Â0A8F1~1     Üó.G.G  ÉU+GXEW                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  package vista;
import modelo.Funciones;
import java.util.GregorianCalendar;
import modelo.ObraSocial;
import modelo.Paciente;
public class TestPediatria {
	public static void main(String[] args) {

		ObraSocial obra1 = new ObraSocial("Sociedad","asd@asd.com","42220122");
		Paciente pac1 = new Paciente("Lopez","Juan",9999999,new GregorianCalendar(2015,7,2,18,32,20),obra1);

		System.out.println("Traer fecha de nacimiento "+pac1.traerFechaDeNacimiento());
		System.out.println(Funciones.traerHora(pac1.getFechaDeNacimiento()));
		
		//ESCENARIOS Metodo EDAD
		//Dias
		/*1*/Paciente pac4=new Paciente("AAA","BBB",9999999,new GregorianCalendar(2015,8,4),obra1);
		System.out.println(pac4.traerEdad());
		/*2*/Paciente pac5=new Paciente("BBB","CCC",9999999,new GregorianCalendar(2015,8,3),obra1);
		System.out.println(pac5.traerEdad());
		
		//Meses
		/*3*/Paciente pac6=new Paciente("BBB","CCC",9999999,new GregorianCalendar(2015,7,4),obra1);
		System.out.println(pac6.traerEdad());
		/*4*/Paciente pac7=new Paciente("BBB","CCC",9999999,new GregorianCalendar(2014,7,4),obra1);
		System.out.println(pac7.traerEdad());	
		
		//AÒos
		/*5*/Paciente pac2 = new Paciente("Acosta","Joaquin",1111111,new GregorianCalendar(2014,9,2),obra1);
		System.out.println(pac2.traerEdad());
		/*6*/Paciente pac3 = new Paciente("Espinosa","Nicolas",36084320,new GregorianCalendar(1991,4,24),obra1);
		System.out.println(pac3.traerEdad()); 
		
		/*6*/Paciente pac8 = new Paciente("Maximiliano","Pizarro",36771843,new GregorianCalendar(1992,4,5),obra1);
		System.out.println(pac8.traerEdad()); 

		
	}
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         .           âó.G.G
 ó.GYE    ..          âó.G.G
 ó.G4E    Âd b b 5 c  !b   ˇˇˇˇˇˇˇˇ  ˇˇˇˇÂ0 1 5 1 0  !d 3 9 b c e   1 d Â9 0 0 a 0  !2 b 8 8 e 5   8 0 Â00A02~1     ãó.G.G   Y+GZE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  package vista;
import modelo.Funciones;
import java.util.GregorianCalendar;
import modelo.ObraSocial;
import modelo.Paciente;
public class TestPediatria {
	public static void main(String[] args) {

		ObraSocial obra1 = new ObraSocial("Sociedad","asd@asd.com","42220122");
		Paciente pac1 = new Paciente("Lopez","Juan",9999999,new GregorianCalendar(2015,7,2,18,32,20),obra1);

		System.out.println("Traer fecha de nacimiento "+pac1.traerFechaDeNacimiento());
		
		//ESCENARIOS Metodo EDAD
		//Dias
		/*1*/Paciente pac4=new Paciente("AAA","BBB",9999999,new GregorianCalendar(2015,8,4),obra1);
		System.out.println(pac4.traerEdad());
		/*2*/Paciente pac5=new Paciente("BBB","CCC",9999999,new GregorianCalendar(2015,8,3),obra1);
		System.out.println(pac5.traerEdad());
		
		//Meses
		/*3*/Paciente pac6=new Paciente("BBB","CCC",9999999,new GregorianCalendar(2015,7,4),obra1);
		System.out.println(pac6.traerEdad());
		/*4*/Paciente pac7=new Paciente("BBB","CCC",9999999,new GregorianCalendar(2014,7,4),obra1);
		System.out.println(pac7.traerEdad());	
		/*5*/Paciente pac2 = new Paciente("Acosta","Joaquin",1111111,new GregorianCalendar(2014,9,2),obra1);
		System.out.println(pac2.traerEdad());
		
		//AÒos
		/*6*/Paciente pac3 = new Paciente("Espinosa","Nicolas",36084320,new GregorianCalendar(1991,4,24),obra1);
		System.out.println(pac3.traerEdad()); 
		
		/*6*/Paciente pac8 = new Paciente("Maximiliano","Pizarro",36771843,new GregorianCalendar(1992,4,5),obra1);
		System.out.println(pac8.traerEdad()); 

		
	}
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  .           éó.G.G
 ó.G[E    ..          éó.G.G
 ó.G4E    Âd b b 5 c  ob   ˇˇˇˇˇˇˇˇ  ˇˇˇˇÂ0 1 5 1 0  od 3 9 b c e   1 d Â2 0 a e 0  ob f 8 9 3 5   8 0 Â0AE0B~1     ëó.G.G  ¿\+G\EÂ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ƒ   ª   Æ   ∞8%H!ëôä|ß%!|H|
ôäpë#|äQ!ä¢ ∞%H%ä2! †0%Häëô!äôôä2	üô!ô	H!A∞%Hë2Q~H!ëüä#¢∞%!p!ä2
pQ!ø∞%!|ë	|üpäß7∞%!|ëë,ä!~ô,ë∞%!ô	∞%!ô2¶∞%!ôëH|ôH2ëô∫	∞
%H2ëô=
†%~ﬁ
†%ä2∞%ëë~29†%ü2!1†, à†,!Ú.†,Óè°,h†,D!	ü%D%3~6%˘A∞,~ü	H2
Òp†,
H|ë!r†,!Æ†,#HH|
ü±,#ë~6%>†,2
H!ä†,|
H|ë!8.∞,~H%!ô∞,ëQt†,ô2pë!äô˘†,!ëôä|ß$†,ë,!√ ∞,§22p7!∞,
H|
6="∞,#	ëy#∞,%!ôë~
!O$∞,ë2%ë!ô5Q~E%†,!!ä&†,!H~!í'†,!ää!F(†,2!pcU)∞,2ôë*∞2,||¢!ä
|Q~ä!ë!%Q!pôô2|pE+†,ë2©!ôR,†,ôô~!Ê-∞,¶~ëôä!Y.†2	H|
6ë"/†2ﬁ?0†2!ç1†
2#ëôÖv2†2#!#ë:3†
2#ä!%≤4†
2Q%!!5∞22Q~ä|~!äë!ä¢!ä
ä!!pô2Hë76†2pÕU8†2p
Hü!!∫>9†2p
Hü!ÏY :†2p
Hü!;∞2px<†2p#2¶|~äô!#Ô=†2p#|äQô2|pÕv>†2p2ô2H2©!H?†2pëôHHä2¢!äz@†
2pô…rB∞2pô!
|!VC†2pô!%äHD†
2pô2H1'E∞2p¢2ë2	H!‰F∞2~~ÁG†2ë±tH∞2ë
ë!ë!pë2ô2¢!>I†2ô% J∞2¢Hü!DK∞52

|!#
kL∞5~2~663M†6!!~2p%,N∞6QH¶ëÓO†Hñ	P∞Hô2pô	ÒQ∞H~
ä!ë·R†H!p%ô,ë±!S†H2	H!ÔT∞H2	2
|p¢ÕWU∞H2	ëÒgV†H2p!3Hp6W†H2ëô!ı@X†HH3
 p'Y†
H|
H¿Z†H|p%Ë'[†H|§!ëô\±$Hô2DH2äDë63HHã]†
Q
2|—^†Q6!!+
_†Qä6∞`∞Q¶´a†QßÜb∞Q!Q
|~ß‘c°Q!ëë%!Qÿ)d†Q#%ä!Øe†
Q2p#f∞Q|
3!¶!!xg†Q|2#ß2p%€h†Q|¢!	H!Õi±Q~|~äô
Q~H¶ãBj†Që!H˚2k∞Që¢
~Ó;l†QüHô2ä%mm†Qü~äë!ä¶!Dn†Qß!æ0o†p3	3})p†
pQ!.Pq†pQ!ë~
!ë∑r†p
!‚s†p
¶!2t∞pë%2HpJu∞
p!2!óv†p!§Hßpw∞p6!ßNx†pp _cy∞ppxz†pp ]m{†pp6|∞pp]}∞ppG~∞pp&†
ppW
Ä†pp!! ∞ZÅ∞pp∞0Ç∞ppÉ∞pp %Ñ∞pp  Ö∞ppoÜ†ppÛá∞pp0à†
ppÒA	â∞pp.ä°ppR™ã†ppÕ›å∞pp!"ç†p|!ìé†p|p!§H2p!è†p|ôÛNê∞p|ô,ä|§Jë∞pä!ô¶!H~, ;í†pôÕì†püQ	!ä|8î∞p¢#pHë1ï†p©ïñ∞$p©ô2ä!Q|¢!2!pô2ôßÉó†|	5!ò∞|
Ùô†|#b…Oú†|##ë!ô™ù†|2ôë#, û†|p
˝ü†|~~††|~!äô!=°∞|~ô2Q2©!¿¢†|äb¨£†|ä%b4§∞ |ë%!|ë%ô!¶ô3HHÓ[•∞|ë%	D
3HH!∆¶∞|ë%	D|%ä3HHÒ-ß∞&|ë%	D|ë%ë,|§3HHÓ®†|ë%!äô,!©†|ë%~Hü%2pëÏ¬	™°
|ëë2Q≤´∞|ëë2Qä!5|üô3!¶!!«¨†|ô	
H2!·≠±T|ô	
H2D
|Q~üô!~|HßH2p!#!ôüä!#ä|Q2Q%!3	ôCÆ∞R|ô	
H2DQüHô2¢ä2ô!Hô!äô2|p!ô!
ô|ä3	ôÒoØ†|ô	%ü2!é∞∞B|ô	%ü2D
|Q~üô!
|p#üë2|pQôä2¶3	ô,±∞D|ô	%ü2DHëQëëQHHä!%2|pëQ!ä%2p%3	ôÒ`≤                                   8Òﬂà.˘ËŒ∏çnO*ˇÈ›—π•õíÜ]S<(Ú
‰
Ã
æ
≠
°
î
É
s
`
L
9
&


Ò	ﬂ	œ	æ	´	ö	å	Ä	k	_	R	@	1				Ï‹Œƒ¨ñÉuYC+˙Â“∂´ùèUC1!Îﬁ…∑£åukZF3ˇ‹–≈Æûàm]=!Á‹∆≤ûî]M=+Ò⁄Ã∫ÉvdVH6Òﬁ…ª£ã~kU?+Ôÿ∂≠•ùïâtf\M2!Ì – µ î ^ I  w  i  õ   ∞|ô	|ëë2Q~Hü%2pëg †|üô	ü#†~Ò∞~#¶s†~~|ë|üû∞~ä%
†~äô2
üHäHß†~	Q~Hüë†
~!!#7∞
~#2H!	†~2pëôp
!≈
†                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           .           îó.G.G
 ó.G^E    ..          îó.G.G
 ó.G4E    Âd 3 2 1 8  3   ˇˇˇˇˇˇˇˇ  ˇˇˇˇÂ0 1 5 1 d  e b c 7 9 e   0 8 Â7 0 0 d a  e 5 9 1 3 5   8 0 Â00DAE~1     ñó.G.G  Ü¢*G_EÏ  Â7 d c f 6  e   ˇˇˇˇˇˇˇˇ  ˇˇˇˇÂ0 1 5 1 e  8 9 8 b 8 c   b b Âa 0 1 c f  c e d 8 7 5   8 0 Â01CFC~1     óó.G.G  àR+G`E                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  package test;
import modelo.Funciones;
import java.util.GregorianCalendar;

public class TestFunciones {

	/**
	 * @param args
	 */
	public static void main(String[] args) {
		// TODO Auto-generated method stub
		
		GregorianCalendar fecha= new GregorianCalendar();
		
		//1) + traerAnio ( GregorianCalendar fecha) : int
		System.out.println("1) "+Funciones.traerAnio(fecha));
		
		//2) + traerMes ( GregorianCalendar fecha) : int //devuelve int entre 1 y 12
		System.out.println("2) "+Funciones.traerMes(fecha));
		
		//3) + traerDia (GregorianCalendar fecha) : int
		System.out.println("2) "+Funciones.traerDia(fecha));
		
		//4) + esBisiesto (int anio) : boolean
		//Ser·n bisiestos los aÒos divisibles por 4, exceptuando los que son divisibles por 100 y no divisibles
		//por 400.
		//ejemplos: son bisiestos 1996, 2004, 2000, 1600; No son bisiestos 1700, 1800, 1900, 2100
		//5) + esFechaValida (par·metros int anio, int mes de 1 a 12, int dia)
		//6) + traerFecha (int anio, int mes, int dia) : GregorianCalendar // mes de 1 a 12
		//7) + traerFecha (String fecha) : GregorianCalendar //par·metro de la forma ìdd/mm/aaaaî		
		//8) + traerFechaCorta (GregorianCalendar fecha) : String //retorna ìdd/mm/aaaaî
		System.out.println("8) "+Funciones.traerFechaCorta(fecha));
		
		//9) + esDiaHabil (GregorianCalendar fecha) : boolean //Consideramos h·bil de lunes a viernes.
		//10) + traerDiaDeLaSemana (GregorianCalendar fecha) : String
		System.out.println("10) "+Funciones.traerDiaEnLetras(fecha));
		
		//11) + traerMesEnLetras (GregorianCalendar fecha) : String
		System.out.println("11) "+Funciones.traerMesEnLetras(fecha));
		
		//12) + traerFechaLarga (GregorianCalendar fecha) : String // ìDomingo 30 de Agosto del 2015î
		System.out.println("12) "+Funciones.traerFechaLarga(fecha));
		
		//13) + sonFechasIguales(GregorianCalendar fecha , GregorianCalendar fecha1) : boolean
		//14) + traerCantDiasDeUnMes (int anio, int mes) : int
		//15) + aproximar2Decimal

	}

}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    package modelo;

import java.util.GregorianCalendar;

public class Paciente {

	private String apellido;
	private String nombre;
	private long dni;
	private GregorianCalendar fechaDeNacimiento;
	private ObraSocial obraSocial;
	
	
	public Paciente(String apellido, String nombre, long dni, GregorianCalendar fechaDeNacimiento,
			ObraSocial obraSocial) {
		super();
		this.apellido = apellido;
		this.nombre = nombre;
		this.dni = dni;
		this.fechaDeNacimiento = fechaDeNacimiento;
		this.obraSocial = obraSocial;
	}
	
	public String getApellido() {
		return apellido;
	}
	public void setApellido(String apellido) {
		this.apellido = apellido;
	}
	public String getNombre() {
		return nombre;
	}
	public void setNombre(String nombre) {
		this.nombre = nombre;
	}
	public long getDni() {
		return dni;
	}
	public void setDni(long dni) {
		this.dni = dni;
	}
	public GregorianCalendar getFechaDeNacimiento() {
		return fechaDeNacimiento;
	}
	public void setFechaDeNacimiento(GregorianCalendar fechaDeNacimiento) {
		this.fechaDeNacimiento = fechaDeNacimiento;
	}
	public ObraSocial getObraSocial() {
		return obraSocial;
	}
	public void setObraSocial(ObraSocial obraSocial) {
		this.obraSocial = obraSocial;
	}
	
	public String toString(){
		
		return("Apellido: "+apellido+" Nombre:"+nombre+" DNI:"+dni+"Obra Social: "+obraSocial);
	
	}
	
	public boolean equals(Paciente p)
	{
	return(dni==p.getDni());	
	}
	
	public String traerFechaDeNacimiento()
	{
		return Funciones.traerFechaCorta(fechaDeNacimiento);
	}
	
	
	public String traerEdad(){
		int anio=0,mes=0,dia=0;
		GregorianCalendar f= new GregorianCalendar();
		
		/*Dias*/
		if(/*1*/(Funciones.esDiaMayor(fechaDeNacimiento,f)==true)&&(Funciones.esMesIgual(fechaDeNacimiento,f)==true)&&(Funciones.esAnioIgual(fechaDeNacimiento,f)==true)){
		anio=0;
		mes=0;
		dia=0;
		}
		
		if(/*2*/(Funciones.esDiaMayor(fechaDeNacimiento,f)==false)&&(Funciones.esMesIgual(fechaDeNacimiento,f)==true)&&(Funciones.esAnioIgual(fechaDeNacimiento,f)==true)){
			anio=0;
			mes=0;
			dia=Funciones.traerNroDia(f)-Funciones.traerNroDia(fechaDeNacimiento);
			}
		/*Meses*/
		if(/*3*/(Funciones.esDiaIgual(fechaDeNacimiento,f)==true)&&(Funciones.esMesMayor(fechaDeNacimiento,f)==false)&&(Funciones.esAnioIgual(fechaDeNacimiento,f)==true)){
			anio=0;
			mes=Funciones.traerNroMes(f)-Funciones.traerNroMes(fechaDeNacimiento);
			dia=0;
			}else
				{
				if(/*4*/(Funciones.esDiaIgual(fechaDeNacimiento,f)==true)&&(Funciones.esMesMayor(fechaDeNacimiento,f)==false)&&(Funciones.esAnioIgual(fechaDeNacimiento,f)==false)&&(Funciones.esAnioMayor(fechaDeNacimiento,f)==false))
				{	anio=Funciones.traerNroAnio(f)-Funciones.traerNroAnio(fechaDeNacimiento);
					mes=Funciones.traerNroMes(f)-Funciones.traerNroMes(fechaDeNacimiento);	
					dia=0;}else
					if(/*3*/(Funciones.esDiaIgual(fechaDeNacimiento,f)==false)&&(Funciones.esMesMayor(fechaDeNacimiento,f)==false)&&(Funciones.esAnioIgual(fechaDeNacimiento,f)==true)){
						anio=0;
						mes=Funciones.traerNroMes(f)-Funciones.traerNroMes(fechaDeNacimiento);
						if(Funciones.esDiaMayor(fechaDeNacimiento, f)==true){
							dia=Funciones.traerNroDia(fechaDeNacimiento)-Funciones.traerNroDia(f);
							}else{dia=Funciones.traerNroDia(f)-Funciones.traerNroDia(fechaDeNacimiento);
							}
					}
				}
		
		if(/*5*/(Funciones.esMesMayor(fechaDeNacimiento,f)==true)&&(Funciones.diferenciaAnioDeUno(fechaDeNacimiento,f)==false)){
			anio=0;
			mes=12-Funciones.traerNroMes(fechaDeNacimiento)+Funciones.traerNroMes(f);
			if(Funciones.esDiaMayor(fechaDeNacimiento,f)==true){
			dia=10+Funciones.cantidadDiasMesAnterior(fechaDeNacimiento)-Funciones.traerNroDia(fechaDeNacimiento)+Funciones.traerNroDia(f);
			}else{
				dia=Funciones.traerNroDia(f)-Funciones.traerNroDia(fechaDeNacimiento);	
			}
		}
	
		if(/*6*/(Funciones.esDiaIgual(fechaDeNacimiento,f)==false)&&(Funciones.esMesMayor(fechaDeNacimiento,f)==false)&&(Funciones.esAnioIgual(fechaDeNacimiento,f)==false)&&(Funciones.esAnioMayor(fechaDeNacimiento,f)==false))
		{anio=Funciones.traerNroAnio(f)-Funciones.traerNroAnio(fechaDeNacimiento);
		mes=Funciones.traerNroMes(f)-Funciones.traerNroMes(fechaDeNacimiento)-1;	
		dia=Funciones.cantidadDiasMesAnterior(f)-Funciones.traerNroDia(fechaDeNacimiento);}

		if(/*6*/(Funciones.esDiaMayor(fechaDeNacimiento,f)==false)&&(Funciones.esMesMayor(fechaDeNacimiento,f)==false)&&(Funciones.esAnioIgual(fechaDeNacimiento,f)==false)&&(Funciones.esAnioMayor(fechaDeNacimiento,f)==false))
		{anio=Funciones.traerNroAnio(f)-Funciones.traerNroAnio(fechaDeNacimiento);
		mes=Funciones.traerNroMes(f)-Funciones.traerNroMes(fechaDeNacimiento);	
		dia=Funciones.traerNroDia(f)-Funciones.traerNroDia(fechaDeNacimiento);}

		
		return(anio+" aÒo "+mes+" meses "+dia+" dias");
	}
		
}
			


                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        .           öó.G.G
 ó.GbE    ..          öó.G.G
 ó.G4E    Âa 0 4 e 7  É9   ˇˇˇˇˇˇˇˇ  ˇˇˇˇÂ0 1 5 1 9  É1 1 9 6 6 0   c 2 Âa 0 7 6 d  Éf a 1 9 b 5   8 0 Â076DF~1     ùó.G.G  &e+GcEl                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  package modelo;
import java.util.Calendar;
import java.util.GregorianCalendar;

public class Funciones {
	//DIA
	public static String traerDia(GregorianCalendar fecha){
		String dia= String.valueOf(traerNroDia(fecha)); 
		if(traerNroDia(fecha)<10){
			dia="0"+dia;}
		return dia; 
	}
		
	public static int traerNroDia(GregorianCalendar fecha){
		return fecha.get(Calendar.DAY_OF_MONTH);
	}
	public static int traerNroDeDia(GregorianCalendar fecha){
		return fecha.get(Calendar.DAY_OF_WEEK);
	}
	public static String traerDiaEnLetras(GregorianCalendar fecha){
		String[] diaEnLetra= {"Domingo","Lunes","Martes","Miercoles","Jueves","Viernes","Sabado"};
		return diaEnLetra[traerNroDeDia(fecha)-1];
	}
	
	
	public static boolean esDiaHabil(GregorianCalendar fecha){
		return !(traerDiaEnLetras(fecha).compareTo("Sabado")==0)||(traerDiaEnLetras(fecha).compareTo("Domingo")==0);
	}
	
	//MES
	public static String traerMes(GregorianCalendar fecha){
		String mes=String.valueOf(traerNroMes(fecha));
		if(traerNroMes(fecha)<10){
			mes="0"+mes;
			}
		return mes;
	}
	
	public static int traerNroMes(GregorianCalendar fecha){
		return fecha.get(Calendar.MONTH)+1;		
	}
	
	
	public static String traerMesEnLetras(GregorianCalendar fecha){
		
		String[] mesEnLetra= {"Diciembre","Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre"};
		return mesEnLetra[traerNroMes(fecha)];
	}
	
	//A—O
	public static String traerAnio(GregorianCalendar fecha){
		return String.valueOf(traerNroAnio(fecha));
	}
	public static int traerNroAnio(GregorianCalendar fecha){
		return fecha.get(Calendar.YEAR);
	}
	
	//FORMATO FECHAS
	
	public static String traerFechaCorta(GregorianCalendar fecha){
		return traerDia(fecha)+"/"+traerMes(fecha)+"/"+traerAnio(fecha);
	}
	
	public static String traerFechaLarga(GregorianCalendar fecha){
		return traerDia(fecha)+" de "+traerMesEnLetras(fecha)+" de "+traerAnio(fecha);
		
	}
	public static GregorianCalendar traerFecha(int anio, int mes, int dia){
		return new GregorianCalendar (anio,mes-1,dia);
	}
	//HORA
	public static String traerHora(GregorianCalendar f)
	
	{
		String ap="am";
		String hora="";
		if(f.get(Calendar.AM_PM)==1){
			ap="pm";

		}
		hora=""+f.get(Calendar.HOUR_OF_DAY)+":"+f.get(Calendar.MINUTE)+":"+f.get(Calendar.SECOND)+" "+ap;
		
		return hora;
	}
	
	//Fecha en String de 12 (dd/mm/aaaa) separado por / y por -
	
	//Funciones de comparacion de fechas:dos fechas como parametros
	//Mayores
	public static boolean esDiaMayor(GregorianCalendar f, GregorianCalendar fecha){
		return (traerNroDia(f)>traerNroDia(fecha));
	}
	public static boolean esMesMayor(GregorianCalendar f, GregorianCalendar fecha){
		return (traerNroMes(f)>traerNroMes(fecha));
	}
	public static boolean esAnioMayor(GregorianCalendar f, GregorianCalendar fecha){
		return (traerNroAnio(f)>traerNroAnio(fecha));
	}
	//Iguales
	public static boolean esDiaIgual(GregorianCalendar f, GregorianCalendar fecha){
		return(traerNroDia(f)==traerNroDia(fecha));
	}
	public static boolean esMesIgual(GregorianCalendar f, GregorianCalendar fecha){
		return (traerNroMes(f)==traerNroMes(fecha));
	}
	public static boolean esAnioIgual(GregorianCalendar f, GregorianCalendar fecha){
		return (traerNroAnio(f)==traerNroAnio(fecha));
	}
	//Menores
	/*Para aÒos con diferencias menores que 1, ej:2015 y 2014, retorna true*/
	public static boolean diferenciaAnioDeUno(GregorianCalendar f, GregorianCalendar fecha){
		return (traerNroAnio(f)-traerNroAnio(fecha)==1);
	}
	
	
	public static int cantidadDiasMes(GregorianCalendar fecha){
		Integer[] cantidad={31,28,31,30,31,30,31,31,30,31,30,31};
		return cantidad[traerNroMes(fecha)-1];	
	}
	
	public static int cantidadDiasMes(int anio, int mes){
		Integer[] cantidad={31,28,31,30,31,30,31,31,30,31,30,31};
		if(esBisiesto(anio))
		{
			cantidad[1]=29;
		}

		return cantidad[mes-1];	
	}
	
	public static int cantidadDiasMesAnterior(GregorianCalendar fecha){
		Integer[] cantidad={31,31,28,31,30,31,30,31,31,30,31,30};
		return cantidad[traerNroMes(fecha)-1];
	}
	
	 public static boolean esBisiesto(int anio)
	 
	 {
		 boolean respuesta=false;
		 if(anio%4==0&&anio%100!=0||anio%400==0)
		 {
			 respuesta=true;
		 }
		 return respuesta;
		 
	 }
	

	 public static boolean esFechaValida(int anio, int mes, int dia)
	 {
		 boolean respuesta=false;
		 if (anio>0)
		 {
		 if(mes>0 && mes<13)
		 	{
			 	mes=cantidadDiasMes(anio,mes);
			 	if(dia>0 && dia<=mes)
			 	{
			 		respuesta=true;
			 	} 
		 	}
	     }
		 return respuesta;
	 }
	 

	 public static GregorianCalendar traerFecha(String fecha)
	 {
		 // 0 1 2 3 4 5 6 7 8 9
		 //	2 4 / 0 5 / 1 9 9 1
		 int dia=Integer.parseInt(fecha.substring(0,2));
		 int mes=Integer.parseInt(fecha.substring(3,5));
		 int anio=Integer.parseInt(fecha.substring(6,10));

		 return traerFecha(anio,mes,dia);
		 
	 }
	 
	 public static boolean sonFechasIguales(GregorianCalendar fecha, GregorianCalendar fecha1)
	 {
		 return (traerNroAnio(fecha)==traerNroAnio(fecha1)&&traerNroMes(fecha)==traerNroMes(fecha1)&&traerNroDeDia(fecha)==traerNroDeDia(fecha1));
	 }
	
	 public static double aproximar2Decimal(double valor)
	 {
		 valor=valor+0.005;
		 String v = String.valueOf(valor);
		 v=v.substring(0,(v.length()-1));
		 return Double.parseDouble(v);
		 
	 }
	
	
	
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    .           †ó.G.G
 ó.GeE    ..          †ó.G.G
 ó.G4E    Âb 4 1 6 a  ôd   ˇˇˇˇˇˇˇˇ  ˇˇˇˇÂ0 1 5 1 4  ô0 7 d 8 d 6   a f Âd 0 3 f 0  ô9 c 0 a 3 5   5 0 Â03F09~1     ¢ó.G.G  Lê'GfEl                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  eclipse.preferences.version=1
org.eclipse.jdt.core.compiler.codegen.inlineJsrBytecode=enabled
org.eclipse.jdt.core.compiler.codegen.targetPlatform=1.6
org.eclipse.jdt.core.compiler.compliance=1.6
org.eclipse.jdt.core.compiler.problem.assertIdentifier=error
org.eclipse.jdt.core.compiler.problem.enumIdentifier=error
org.eclipse.jdt.core.compiler.source=1.6
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    .           •ó.G.G
 ó.GgE    ..          •ó.G.G
 ó.G4E    Âd 3 2 1 8  Ì3   ˇˇˇˇˇˇˇˇ  ˇˇˇˇÂ0 1 5 1 d  Ìe b c 7 9 e   0 8 Âe 0 c 8 8  Ì5 1 9 0 f 5   8 0 Â0C885~1     ®ó.G.G  ∆û*GhE¡                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  package test;
import modelo.Funciones;
import java.util.GregorianCalendar;

public class TestFunciones {

	/**
	 * @param args
	 */
	public static void main(String[] args) {
		// TODO Auto-generated method stub
		
		
		//1) + traerAnio ( GregorianCalendar fecha) : int
		GregorianCalendar fecha1= new GregorianCalendar();
		System.out.println("1) "+Funciones.traerAnio(fecha1));
		
		//2) + traerMes ( GregorianCalendar fecha) : int //devuelve int entre 1 y 12
		GregorianCalendar fecha2= new GregorianCalendar();
		System.out.println("2) "+Funciones.traerMes(fecha2));
		
		//3) + traerDia (GregorianCalendar fecha) : int
		GregorianCalendar fecha3= new GregorianCalendar();
		System.out.println("2) "+Funciones.traerDia(fecha3));
		
		//4) + esBisiesto (int anio) : boolean
		//Ser·n bisiestos los aÒos divisibles por 4, exceptuando los que son divisibles por 100 y no divisibles
		//por 400.
		//ejemplos: son bisiestos 1996, 2004, 2000, 1600; No son bisiestos 1700, 1800, 1900, 2100
		//5) + esFechaValida (par·metros int anio, int mes de 1 a 12, int dia)
		//6) + traerFecha (int anio, int mes, int dia) : GregorianCalendar // mes de 1 a 12
		//7) + traerFecha (String fecha) : GregorianCalendar //par·metro de la forma ìdd/mm/aaaaî		
		//8) + traerFechaCorta (GregorianCalendar fecha) : String //retorna ìdd/mm/aaaaî
		GregorianCalendar fecha8= new GregorianCalendar();
		System.out.println("8) "+Funciones.traerFechaCorta(fecha8));
		//9) + esDiaHabil (GregorianCalendar fecha) : boolean //Consideramos h·bil de lunes a viernes.
		//10) + traerDiaDeLaSemana (GregorianCalendar fecha) : String
		//11) + traerMesEnLetras (GregorianCalendar fecha) : String
		//12) + traerFechaLarga (GregorianCalendar fecha) : String // ìDomingo 30 de Agosto del 2015î
		//13) + sonFechasIguales(GregorianCalendar fecha , GregorianCalendar fecha1) : boolean
		//14) + traerCantDiasDeUnMes (int anio, int mes) : int
		//15) + aproximar2Decimal

	}

}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               .           ´ó.G.G
 ó.GiE    ..          ´ó.G.G
 ó.G4E    Âd 3 2 1 8   3   ˇˇˇˇˇˇˇˇ  ˇˇˇˇÂ0 1 5 1 d   e b c 7 9 e   0 8 Âe 0 8 8 6   0 f 6 1 4 5   8 0 Â08860~1     ≠ó.G.G  ]£*GjEK                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä     ÄÄ Ä  Ä                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        .           ∞ó.G.G
 ó.GkE    ..          ∞ó.G.G
 ó.G4E    Âd b b 5 c  	b   ˇˇˇˇˇˇˇˇ  ˇˇˇˇÂ0 1 5 1 0  	d 3 9 b c e   1 d Â2 0 b 7 3  	4 4 9 8 e 5   8 0 Â0B734~1     ≥ó.G.G  »X+GlE7	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  package test;
import modelo.Funciones;
import java.util.GregorianCalendar;

public class TestFunciones {

	/**
	 * @param args
	 */
	public static void main(String[] args) {
		// TODO Auto-generated method stub
		
		GregorianCalendar fecha= new GregorianCalendar();
		
		//1) + traerAnio ( GregorianCalendar fecha) : int
		System.out.println("1) "+Funciones.traerAnio(fecha));
		
		//2) + traerMes ( GregorianCalendar fecha) : int //devuelve int entre 1 y 12
		System.out.println("2) "+Funciones.traerMes(fecha));
		
		//3) + traerDia (GregorianCalendar fecha) : int
		System.out.println("2) "+Funciones.traerDia(fecha));
		
		//4) + esBisiesto (int anio) : boolean
		//Ser·n bisiestos los aÒos divisibles por 4, exceptuando los que son divisibles por 100 y no divisibles
		//por 400.
		//ejemplos: son bisiestos 1996, 2004, 2000, 1600; No son bisiestos 1700, 1800, 1900, 2100
		//5) + esFechaValida (par·metros int anio, int mes de 1 a 12, int dia)
		//6) + traerFecha (int anio, int mes, int dia) : GregorianCalendar // mes de 1 a 12
		System.out.println("6) "+Funciones.traerFechaCorta(Funciones.traerFecha(2015, 05, 05)));
		
		//7) + traerFecha (String fecha) : GregorianCalendar //par·metro de la forma ìdd/mm/aaaaî		
		//8) + traerFechaCorta (GregorianCalendar fecha) : String //retorna ìdd/mm/aaaaî
		System.out.println("8) "+Funciones.traerFechaCorta(fecha));
		
		//9) + esDiaHabil (GregorianCalendar fecha) : boolean //Consideramos h·bil de lunes a viernes.
		System.out.println("9) "+Funciones.esDiaHabil(fecha)+ "y una fecha que no sea habil "+Funciones.esDiaHabil(new GregorianCalendar(2015,8,12)));
		//10) + traerDiaDeLaSemana (GregorianCalendar fecha) : String
		System.out.println("10) "+Funciones.traerDiaEnLetras(fecha));
		
		//11) + traerMesEnLetras (GregorianCalendar fecha) : String
		System.out.println("11) "+Funciones.traerMesEnLetras(fecha));
		
		//12) + traerFechaLarga (GregorianCalendar fecha) : String // ìDomingo 30 de Agosto del 2015î
		System.out.println("12) "+Funciones.traerFechaLarga(fecha));
		
		//13) + sonFechasIguales(GregorianCalendar fecha , GregorianCalendar fecha1) : boolean
		//14) + traerCantDiasDeUnMes (int anio, int mes) : int
		
		//15) + aproximar2Decimal(double valor) : double //si el 3∞ decimal es mayor o igual 5, suma 1 al 2∞ decimal )

	}

}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         .           ∂ó.G.G
 ó.GmE    ..          ∂ó.G.G
 ó.G4E    Â7 d c f 6  Ce   ˇˇˇˇˇˇˇˇ  ˇˇˇˇÂ0 1 5 1 e  C8 9 8 b 8 c   b b Â6 0 6 f 7  C9 d 6 8 7 5   8 0 Â06F79~1     πó.G.G  ER+GnE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  package modelo;

import java.util.GregorianCalendar;

public class Paciente {

	private String apellido;
	private String nombre;
	private long dni;
	private GregorianCalendar fechaDeNacimiento;
	private ObraSocial obraSocial;
	
	
	public Paciente(String apellido, String nombre, long dni, GregorianCalendar fechaDeNacimiento,
			ObraSocial obraSocial) {
		super();
		this.apellido = apellido;
		this.nombre = nombre;
		this.dni = dni;
		this.fechaDeNacimiento = fechaDeNacimiento;
		this.obraSocial = obraSocial;
	}
	
	public String getApellido() {
		return apellido;
	}
	public void setApellido(String apellido) {
		this.apellido = apellido;
	}
	public String getNombre() {
		return nombre;
	}
	public void setNombre(String nombre) {
		this.nombre = nombre;
	}
	public long getDni() {
		return dni;
	}
	public void setDni(long dni) {
		this.dni = dni;
	}
	public GregorianCalendar getFechaDeNacimiento() {
		return fechaDeNacimiento;
	}
	public void setFechaDeNacimiento(GregorianCalendar fechaDeNacimiento) {
		this.fechaDeNacimiento = fechaDeNacimiento;
	}
	public ObraSocial getObraSocial() {
		return obraSocial;
	}
	public void setObraSocial(ObraSocial obraSocial) {
		this.obraSocial = obraSocial;
	}
	
	public String toString(){
		
		return("Apellido: "+apellido+" Nombre:"+nombre+" DNI:"+dni+"Obra Social: "+obraSocial);
	
	}
	
	public boolean equals(Paciente p)
	{
	return(dni==p.getDni());	
	}
	
	public String traerFechaDeNacimiento()
	{
		return Funciones.traerFechaCorta(fechaDeNacimiento);
	}
	
	
	public String traerEdad(){
		int anio=0,mes=0,dia=0;
		GregorianCalendar f= new GregorianCalendar();
		
		/*Dias*/
		if(/*1*/(Funciones.esDiaMayor(fechaDeNacimiento,f)==true)&&(Funciones.esMesIgual(fechaDeNacimiento,f)==true)&&(Funciones.esAnioIgual(fechaDeNacimiento,f)==true)){
		anio=0;
		mes=0;
		dia=0;
		}
		
		if(/*2*/(Funciones.esDiaMayor(fechaDeNacimiento,f)==false)&&(Funciones.esMesIgual(fechaDeNacimiento,f)==true)&&(Funciones.esAnioIgual(fechaDeNacimiento,f)==true)){
			anio=0;
			mes=0;
			dia=Funciones.traerNroDia(f)-Funciones.traerNroDia(fechaDeNacimiento);
			}
		/*Meses*/
		if(/*3*/(Funciones.esDiaIgual(fechaDeNacimiento,f)==true)&&(Funciones.esMesMayor(fechaDeNacimiento,f)==false)&&(Funciones.esAnioIgual(fechaDeNacimiento,f)==true)){
			anio=0;
			mes=Funciones.traerNroMes(f)-Funciones.traerNroMes(fechaDeNacimiento);
			dia=0;
			}else
				{
				if(/*4*/(Funciones.esDiaIgual(fechaDeNacimiento,f)==true)&&(Funciones.esMesMayor(fechaDeNacimiento,f)==false)&&(Funciones.esAnioIgual(fechaDeNacimiento,f)==false)&&(Funciones.esAnioMayor(fechaDeNacimiento,f)==false))
				{	anio=Funciones.traerNroAnio(f)-Funciones.traerNroAnio(fechaDeNacimiento);
					mes=Funciones.traerNroMes(f)-Funciones.traerNroMes(fechaDeNacimiento);	
					dia=0;}else
					if(/*3*/(Funciones.esDiaIgual(fechaDeNacimiento,f)==false)&&(Funciones.esMesMayor(fechaDeNacimiento,f)==false)&&(Funciones.esAnioIgual(fechaDeNacimiento,f)==true)){
						anio=0;
						mes=Funciones.traerNroMes(f)-Funciones.traerNroMes(fechaDeNacimiento);
						if(Funciones.esDiaMayor(fechaDeNacimiento, f)==true){
							dia=Funciones.traerNroDia(fechaDeNacimiento)-Funciones.traerNroDia(f);
							}else{dia=Funciones.traerNroDia(f)-Funciones.traerNroDia(fechaDeNacimiento);
							}
					}
				}
		
		if(/*5*/(Funciones.esMesMayor(fechaDeNacimiento,f)==true)&&(Funciones.diferenciaAnioDeUno(fechaDeNacimiento,f)==false)){
			anio=0;
			mes=12-Funciones.traerNroMes(fechaDeNacimiento)+Funciones.traerNroMes(f);
			if(Funciones.esDiaMayor(fechaDeNacimiento,f)==true){
			dia=Funciones.cantidadDiasMesAnterior(fechaDeNacimiento)-Funciones.traerNroDia(fechaDeNacimiento)+Funciones.traerNroDia(f);
			}else{
				dia=Funciones.traerNroDia(f)-Funciones.traerNroDia(fechaDeNacimiento);	
			}
		}
	
		if(/*6*/(Funciones.esDiaIgual(fechaDeNacimiento,f)==false)&&(Funciones.esMesMayor(fechaDeNacimiento,f)==false)&&(Funciones.esAnioIgual(fechaDeNacimiento,f)==false)&&(Funciones.esAnioMayor(fechaDeNacimiento,f)==false))
		{anio=Funciones.traerNroAnio(f)-Funciones.traerNroAnio(fechaDeNacimiento);
		mes=Funciones.traerNroMes(f)-Funciones.traerNroMes(fechaDeNacimiento)-1;	
		dia=Funciones.cantidadDiasMesAnterior(f)-Funciones.traerNroDia(fechaDeNacimiento);}

		if(/*6*/(Funciones.esDiaMayor(fechaDeNacimiento,f)==false)&&(Funciones.esMesMayor(fechaDeNacimiento,f)==false)&&(Funciones.esAnioIgual(fechaDeNacimiento,f)==false)&&(Funciones.esAnioMayor(fechaDeNacimiento,f)==false))
		{anio=Funciones.traerNroAnio(f)-Funciones.traerNroAnio(fechaDeNacimiento);
		mes=Funciones.traerNroMes(f)-Funciones.traerNroMes(fechaDeNacimiento);	
		dia=Funciones.traerNroDia(f)-Funciones.traerNroDia(fechaDeNacimiento);}

		
		return(anio+" aÒo "+mes+" meses "+dia+" dias");
	}
		
}
			


                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           .           Ωó.G.G
 ó.GpE    ..          Ωó.G.G
 ó.G4E    Â7 d c f 6  Çe   ˇˇˇˇˇˇˇˇ  ˇˇˇˇÂ0 1 5 1 e  Ç8 9 8 b 8 c   b b Â4 0 6 c 6  Ç2 d 9 8 c 5   8 0 Â06C62~1     æó.G.G  VQ+GqE•                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  package test;
import modelo.Funciones;
import java.util.GregorianCalendar;

public class TestFunciones {

	/**
	 * @param args
	 */
	public static void main(String[] args) {
		// TODO Auto-generated method stub
		
		GregorianCalendar fecha= new GregorianCalendar();
		
		//1) + traerAnio ( GregorianCalendar fecha) : int
		System.out.println("1) "+Funciones.traerAnio(fecha));
		
		//2) + traerMes ( GregorianCalendar fecha) : int //devuelve int entre 1 y 12
		System.out.println("2) "+Funciones.traerMes(fecha));
		
		//3) + traerDia (GregorianCalendar fecha) : int
		System.out.println("2) "+Funciones.traerDia(fecha));
		
		//4) + esBisiesto (int anio) : boolean
		//Ser·n bisiestos los aÒos divisibles por 4, exceptuando los que son divisibles por 100 y no divisibles
		//por 400.
		//ejemplos: son bisiestos 1996, 2004, 2000, 1600; No son bisiestos 1700, 1800, 1900, 2100
		//5) + esFechaValida (par·metros int anio, int mes de 1 a 12, int dia)
		//6) + traerFecha (int anio, int mes, int dia) : GregorianCalendar // mes de 1 a 12
		System.out.println("6) "+Funciones.traerFechaCorta(Funciones.traerFecha(2015, 05, 05)));
		
		//7) + traerFecha (String fecha) : GregorianCalendar //par·metro de la forma ìdd/mm/aaaaî		
		//8) + traerFechaCorta (GregorianCalendar fecha) : String //retorna ìdd/mm/aaaaî
		System.out.println("8) "+Funciones.traerFechaCorta(fecha));
		
		//9) + esDiaHabil (GregorianCalendar fecha) : boolean //Consideramos h·bil de lunes a viernes.
		//10) + traerDiaDeLaSemana (GregorianCalendar fecha) : String
		System.out.println("10) "+Funciones.traerDiaEnLetras(fecha));
		
		//11) + traerMesEnLetras (GregorianCalendar fecha) : String
		System.out.println("11) "+Funciones.traerMesEnLetras(fecha));
		
		//12) + traerFechaLarga (GregorianCalendar fecha) : String // ìDomingo 30 de Agosto del 2015î
		System.out.println("12) "+Funciones.traerFechaLarga(fecha));
		
		//13) + sonFechasIguales(GregorianCalendar fecha , GregorianCalendar fecha1) : boolean
		//14) + traerCantDiasDeUnMes (int anio, int mes) : int
		
		//15) + aproximar2Decimal(double valor) : double //si el 3∞ decimal es mayor o igual 5, suma 1 al 2∞ decimal )

	}

}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           .           ¡ó.G.G
 ó.GrE    ..          ¡ó.G.G
 ó.G4E    Âd b b 5 c  sb   ˇˇˇˇˇˇˇˇ  ˇˇˇˇÂ0 1 5 1 0  sd 3 9 b c e   1 d Â2 0 3 f d  sa 6 c 9 2 5   8 0 Â03FDA~1     √ó.G.G  .\+GsE)  Âa 0 4 e 7  ∫9   ˇˇˇˇˇˇˇˇ  ˇˇˇˇÂ0 1 5 1 9  ∫1 1 9 6 6 0   c 2 Â2 0 b c c  ∫c d f 9 b 5   8 0 Â0BCCC~1     ∆ó.G.G  je+GuE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  package modelo;
import java.util.Calendar;
import java.util.GregorianCalendar;

public class Funciones {
	//DIA
	public static String traerDia(GregorianCalendar fecha){
		String dia= String.valueOf(traerNroDia(fecha)); 
		if(traerNroDia(fecha)<10){
			dia="0"+dia;}
		return dia; 
	}
		
	public static int traerNroDia(GregorianCalendar fecha){
		return fecha.get(Calendar.DAY_OF_MONTH);
	}
	public static int traerNroDeDia(GregorianCalendar fecha){
		return fecha.get(Calendar.DAY_OF_WEEK);
	}
	public static String traerDiaEnLetras(GregorianCalendar fecha){
		String[] diaEnLetra= {"Domingo","Lunes","Martes","Miercoles","Jueves","Viernes","Sabado"};
		return diaEnLetra[traerNroDeDia(fecha)-1];
	}
	
	
	public static boolean esDiaHabil(GregorianCalendar fecha){
	
		return !(traerDiaEnLetras(fecha).compareTo("Sabado")==0)||(traerDiaEnLetras(fecha).compareTo("Domingo")==0);
	}
	
	//MES
	public static String traerMes(GregorianCalendar fecha){
		String mes=String.valueOf(traerNroMes(fecha));
		if(traerNroMes(fecha)<10){
			mes="0"+mes;
			}
		return mes;
	}
	
	public static int traerNroMes(GregorianCalendar fecha){
		return fecha.get(Calendar.MONTH)+1;		
	}
	
	
	public static String traerMesEnLetras(GregorianCalendar fecha){
		
		String[] mesEnLetra= {"Diciembre","Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre"};
		return mesEnLetra[traerNroMes(fecha)];
	}
	
	//A—O
	public static String traerAnio(GregorianCalendar fecha){
		return String.valueOf(traerNroAnio(fecha));
	}
	public static int traerNroAnio(GregorianCalendar fecha){
		return fecha.get(Calendar.YEAR);
	}
	
	//FORMATO FECHAS
	
	public static String traerFechaCorta(GregorianCalendar fecha){
		return traerDia(fecha)+"/"+traerMes(fecha)+"/"+traerAnio(fecha);
	}
	
	public static String traerFechaLarga(GregorianCalendar fecha){
		return traerDia(fecha)+" de "+traerMesEnLetras(fecha)+" de "+traerAnio(fecha);
		
	}
	public static GregorianCalendar traerFecha(int anio, int mes, int dia){
		return new GregorianCalendar (anio,mes-1,dia);
	}
	//HORA
	public static String traerHora(GregorianCalendar f)
	
	{
		String ap="am";
		String hora="";
		if(f.get(Calendar.AM_PM)==1){
			ap="pm";

		}
		hora=""+f.get(Calendar.HOUR_OF_DAY)+":"+f.get(Calendar.MINUTE)+":"+f.get(Calendar.SECOND)+" "+ap;
		
		return hora;
	}
	
	//Fecha en String de 12 (dd/mm/aaaa) separado por / y por -
	
	//Funciones de comparacion de fechas:dos fechas como parametros
	//Mayores
	public static boolean esDiaMayor(GregorianCalendar f, GregorianCalendar fecha){
		boolean respuesta=false;
		if(traerNroDia(f)>traerNroDia(fecha))respuesta=true;
		return respuesta;
	}
	public static boolean esMesMayor(GregorianCalendar f, GregorianCalendar fecha){
		boolean respuesta=false;
		if(traerNroMes(f)>traerNroMes(fecha))respuesta=true;
		return respuesta;
	}
	public static boolean esAnioMayor(GregorianCalendar f, GregorianCalendar fecha){
		boolean respuesta=false;
		if(traerNroAnio(f)>traerNroAnio(fecha))respuesta=true;
		return respuesta;
	}
	//Iguales
	public static boolean esDiaIgual(GregorianCalendar f, GregorianCalendar fecha){
		boolean respuesta=false;
		if(traerNroDia(f)==traerNroDia(fecha))respuesta=true;
		return respuesta;
	}
	public static boolean esMesIgual(GregorianCalendar f, GregorianCalendar fecha){
		boolean respuesta=false;
		if(traerNroMes(f)==traerNroMes(fecha))respuesta=true;
		return respuesta;
	}
	public static boolean esAnioIgual(GregorianCalendar f, GregorianCalendar fecha){
		boolean respuesta=false;
		if(traerNroAnio(f)==traerNroAnio(fecha))respuesta=true;
		return respuesta;
	}
	//Menores
	/*Para aÒos con diferencias menores que 1, ej:2015 y 2014, retorna true*/
	public static boolean diferenciaAnioDeUno(GregorianCalendar f, GregorianCalendar fecha){
		boolean respuesta=false;
		if(traerNroAnio(f)-traerNroAnio(fecha)==1)respuesta=true;
		return respuesta;
	}
	
	
	public static int cantidadDiasMes(GregorianCalendar fecha){
		Integer[] cantidad={31,28,31,30,31,30,31,31,30,31,30,31};
		return cantidad[traerNroMes(fecha)-1];	
	}
	
	public static int cantidadDiasMesAnterior(GregorianCalendar fecha){
		Integer[] cantidad={31,31,28,31,30,31,30,31,31,30,31,30};
		return cantidad[traerNroMes(fecha)-1];
	}
	
	
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       package test;
import modelo.Funciones;
import java.util.GregorianCalendar;

public class TestFunciones {

	/**
	 * @param args
	 */
	public static void main(String[] args) {
		// TODO Auto-generated method stub
		
		GregorianCalendar fecha= new GregorianCalendar();
		GregorianCalendar fecha1 = new GregorianCalendar(2015,8,11);
		GregorianCalendar fechaBis1 = new GregorianCalendar(1996,5,4);
		GregorianCalendar fechaBis2 = new GregorianCalendar(2004,6,7);
		GregorianCalendar fechaBis3 = new GregorianCalendar(2000,7,6);
		GregorianCalendar fechaNoBis1 = new GregorianCalendar(1700,7,8);
		GregorianCalendar fechaNoBis2 = new GregorianCalendar(1800,6,7);
		GregorianCalendar fechaNoBis3 = new GregorianCalendar(1900,5,6);
		GregorianCalendar fechaNoBis4 = new GregorianCalendar(2100,4,5);
		
		//1) + traerAnio ( GregorianCalendar fecha) : int
		System.out.println("1) "+Funciones.traerAnio(fecha));
		
		//2) + traerMes ( GregorianCalendar fecha) : int //devuelve int entre 1 y 12
		System.out.println("2) "+Funciones.traerMes(fecha));
		
		//3) + traerDia (GregorianCalendar fecha) : int
		System.out.println("2) "+Funciones.traerDia(fecha));
		
		//4) + esBisiesto (int anio) : boolean
		//Ser·n bisiestos los aÒos divisibles por 4, exceptuando los que son divisibles por 100 y no divisibles
		//por 400.
		//ejemplos: son bisiestos 1996, 2004, 2000, 1600; No son bisiestos 1700, 1800, 1900, 2100
		System.out.println("************************esBisiesto***********************************");
		
		System.out.println(Funciones.esBisiesto(Funciones.traerNroAnio(fecha1)));
		System.out.println(Funciones.esBisiesto(Funciones.traerNroAnio(fechaBis1)));
		System.out.println(Funciones.esBisiesto(Funciones.traerNroAnio(fechaBis2)));
		System.out.println(Funciones.esBisiesto(Funciones.traerNroAnio(fechaBis3)));
		System.out.println(Funciones.esBisiesto(Funciones.traerNroAnio(fechaNoBis1)));
		System.out.println(Funciones.esBisiesto(Funciones.traerNroAnio(fechaNoBis2)));
		System.out.println(Funciones.esBisiesto(Funciones.traerNroAnio(fechaNoBis3)));
		System.out.println(Funciones.esBisiesto(Funciones.traerNroAnio(fechaNoBis4)));
		
		//5) + esFechaValida (par·metros int anio, int mes de 1 a 12, int dia)
		System.out.println("************************esFechaValida**********************************");
		System.out.println(Funciones.esFechaValida(2015, 6, 5));
		System.out.println(Funciones.esFechaValida(2000, 2, 29));
		System.out.println(Funciones.esFechaValida(2015,2,29));
		System.out.println(Funciones.esFechaValida(-2000, 1, 29));
		System.out.println(Funciones.esFechaValida(200000,13,30));
		System.out.println(Funciones.esFechaValida(50,11,32));
		System.out.println(Funciones.esFechaValida(2015, 2, 29));
		
		
		//6) + traerFecha (int anio, int mes, int dia) : GregorianCalendar // mes de 1 a 12
		System.out.println("6) "+Funciones.traerFechaCorta(Funciones.traerFecha(2015, 05, 05)));
		
		//7) + traerFecha (String fecha) : GregorianCalendar //par·metro de la forma ìdd/mm/aaaaî	
		System.out.println("**********************traerFecha String********************************");
		System.out.println(Funciones.traerFechaCorta(Funciones.traerFecha("11/09/2015")));
		System.out.println(Funciones.traerNroDia(Funciones.traerFecha("24/05/1991")));
		System.out.println(Funciones.traerNroMes(Funciones.traerFecha("24/05/1991")));
		System.out.println(Funciones.traerNroAnio(Funciones.traerFecha("24/05/1991")));

		//8) + traerFechaCorta (GregorianCalendar fecha) : String //retorna ìdd/mm/aaaaî
		System.out.println("8) "+Funciones.traerFechaCorta(fecha));
		
		//9) + esDiaHabil (GregorianCalendar fecha) : boolean //Consideramos h·bil de lunes a viernes.
		System.out.println("9) "+Funciones.esDiaHabil(fecha)+ " ,y una fecha que no sea habil :"+Funciones.esDiaHabil(new GregorianCalendar(2015,8,12)));
		//10) + traerDiaDeLaSemana (GregorianCalendar fecha) : String
		System.out.println("10) "+Funciones.traerDiaEnLetras(fecha));
		
		//11) + traerMesEnLetras (GregorianCalendar fecha) : String
		System.out.println("11) "+Funciones.traerMesEnLetras(fecha));
		
		//12) + traerFechaLarga (GregorianCalendar fecha) : String // ìDomingo 30 de Agosto del 2015î
		System.out.println("12) "+Funciones.traerFechaLarga(fecha));
		
		//13) + sonFechasIguales(GregorianCalendar fecha , GregorianCalendar fecha1) : boolean

		System.out.println("**********************sonFechasIguales********************************");
		System.out.println(Funciones.sonFechasIguales(fecha, fecha1));
		System.out.println(Funciones.sonFechasIguales(fecha,fechaBis1));
		
		//14) + traerCantDiasDeUnMes (int anio, int mes) : int
		
		System.out.println(Funciones.cantidadDiasMes(2015,9));
		
		//15) + aproximar2Decimal(double valor) : double //si el 3∞ decimal es mayor o igual 5, suma 1 al 2∞ decimal )

		System.out.println(Funciones.aproximar2Decimal(1.115));
		System.out.println(Funciones.aproximar2Decimal(0.115));
		System.out.println(Funciones.aproximar2Decimal(100.555));
		System.out.println(Funciones.aproximar2Decimal(1.114));
	}

}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         .           ó.G.G
 ó.GwE    ..          ó.G.G
 ó.G4E    Âa 0 4 e 7  ˘9   ˇˇˇˇˇˇˇˇ  ˇˇˇˇÂ0 1 5 1 9  ˘1 1 9 6 6 0   c 2 Â1 0 0 4 e  ˘8 6 8 9 7 5   8 0 Â004E8~1     ó.G.G  a+GxE¸                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  package test;
import modelo.Funciones;
import java.util.GregorianCalendar;

public class TestFunciones {

	/**
	 * @param args
	 */
	public static void main(String[] args) {
		// TODO Auto-generated method stub
		
		GregorianCalendar fecha= new GregorianCalendar();
		
		//1) + traerAnio ( GregorianCalendar fecha) : int
		System.out.println("1) "+Funciones.traerAnio(fecha));
		
		//2) + traerMes ( GregorianCalendar fecha) : int //devuelve int entre 1 y 12
		System.out.println("2) "+Funciones.traerMes(fecha));
		
		//3) + traerDia (GregorianCalendar fecha) : int
		System.out.println("2) "+Funciones.traerDia(fecha));
		
		//4) + esBisiesto (int anio) : boolean
		//Ser·n bisiestos los aÒos divisibles por 4, exceptuando los que son divisibles por 100 y no divisibles
		//por 400.
		//ejemplos: son bisiestos 1996, 2004, 2000, 1600; No son bisiestos 1700, 1800, 1900, 2100
		//5) + esFechaValida (par·metros int anio, int mes de 1 a 12, int dia)
		//6) + traerFecha (int anio, int mes, int dia) : GregorianCalendar // mes de 1 a 12
		System.out.println("6) "+Funciones.traerFechaCorta(Funciones.traerFecha(2015, 05, 05)));
		
		//7) + traerFecha (String fecha) : GregorianCalendar //par·metro de la forma ìdd/mm/aaaaî		
		//8) + traerFechaCorta (GregorianCalendar fecha) : String //retorna ìdd/mm/aaaaî
		System.out.println("8) "+Funciones.traerFechaCorta(fecha));
		
		//9) + esDiaHabil (GregorianCalendar fecha) : boolean //Consideramos h·bil de lunes a viernes.
		System.out.println("9) "+Funciones.esDiaHabil(fecha)+ " ,y una fecha que no sea habil :"+Funciones.esDiaHabil(new GregorianCalendar(2015,8,12)));
		//10) + traerDiaDeLaSemana (GregorianCalendar fecha) : String
		System.out.println("10) "+Funciones.traerDiaEnLetras(fecha));
		
		//11) + traerMesEnLetras (GregorianCalendar fecha) : String
		System.out.println("11) "+Funciones.traerMesEnLetras(fecha));
		
		//12) + traerFechaLarga (GregorianCalendar fecha) : String // ìDomingo 30 de Agosto del 2015î
		System.out.println("12) "+Funciones.traerFechaLarga(fecha));
		
		//13) + sonFechasIguales(GregorianCalendar fecha , GregorianCalendar fecha1) : boolean
		//14) + traerCantDiasDeUnMes (int anio, int mes) : int
		
		//15) + aproximar2Decimal(double valor) : double //si el 3∞ decimal es mayor o igual 5, suma 1 al 2∞ decimal )

		
		GregorianCalendar fecha1 = new GregorianCalendar(2015,8,11);
		GregorianCalendar fechaBis1 = new GregorianCalendar(1996,5,4);
		GregorianCalendar fechaBis2 = new GregorianCalendar(2004,6,7);
		GregorianCalendar fechaBis3 = new GregorianCalendar(2000,7,6);
		GregorianCalendar fechaNoBis1 = new GregorianCalendar(1700,7,8);
		GregorianCalendar fechaNoBis2 = new GregorianCalendar(1800,6,7);
		GregorianCalendar fechaNoBis3 = new GregorianCalendar(1900,5,6);
		GregorianCalendar fechaNoBis4 = new GregorianCalendar(2100,4,5);
		
		System.out.println("************************esBisiesto***********************************");
		
		System.out.println(Funciones.esBisiesto(Funciones.traerNroAnio(fecha1)));
		System.out.println(Funciones.esBisiesto(Funciones.traerNroAnio(fechaBis1)));
		System.out.println(Funciones.esBisiesto(Funciones.traerNroAnio(fechaBis2)));
		System.out.println(Funciones.esBisiesto(Funciones.traerNroAnio(fechaBis3)));
		System.out.println(Funciones.esBisiesto(Funciones.traerNroAnio(fechaNoBis1)));
		System.out.println(Funciones.esBisiesto(Funciones.traerNroAnio(fechaNoBis2)));
		System.out.println(Funciones.esBisiesto(Funciones.traerNroAnio(fechaNoBis3)));
		System.out.println(Funciones.esBisiesto(Funciones.traerNroAnio(fechaNoBis4)));
		
		
		System.out.println("************************esFechaValida**********************************");
		System.out.println(Funciones.esFechaValida(2015, 6, 5));
		System.out.println(Funciones.esFechaValida(2000, 2, 29));
		System.out.println(Funciones.esFechaValida(2015,2,29));
		System.out.println(Funciones.esFechaValida(-2000, 1, 29));
		System.out.println(Funciones.esFechaValida(200000,13,30));
		System.out.println(Funciones.esFechaValida(50,11,32));
		System.out.println(Funciones.esFechaValida(2015, 2, 29));
		
		System.out.println("**********************sonFechasIguales********************************");
		System.out.println(Funciones.sonFechasIguales(fecha, fecha1));
		System.out.println(Funciones.sonFechasIguales(fecha,fechaBis1));
		
		System.out.println("**********************traerFecha String********************************");
		System.out.println(Funciones.traerFechaCorta(Funciones.traerFecha("11/09/2015")));
		System.out.println(Funciones.traerNroDia(Funciones.traerFecha("24/05/1991")));
		System.out.println(Funciones.traerNroMes(Funciones.traerFecha("24/05/1991")));
		System.out.println(Funciones.traerNroAnio(Funciones.traerFecha("24/05/1991")));
		
		
		
	}

}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    .           ó.G.G
 ó.GzE    ..          ó.G.G
 ó.G4E    Âa 0 4 e 7  b9   ˇˇˇˇˇˇˇˇ  ˇˇˇˇÂ0 1 5 1 9  b1 1 9 6 6 0   c 2 Â5 0 a a 6  be e 8 9 b 5   8 0 Â0AA6E~1     	ó.G.G  ue+G{ES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  package test;
import modelo.Funciones;
import java.util.GregorianCalendar;

public class TestFunciones {

	/**
	 * @param args
	 */
	public static void main(String[] args) {
		// TODO Auto-generated method stub
		
		GregorianCalendar fecha= new GregorianCalendar();
		GregorianCalendar fecha1 = new GregorianCalendar(2015,8,11);
		GregorianCalendar fechaBis1 = new GregorianCalendar(1996,5,4);
		GregorianCalendar fechaBis2 = new GregorianCalendar(2004,6,7);
		GregorianCalendar fechaBis3 = new GregorianCalendar(2000,7,6);
		GregorianCalendar fechaNoBis1 = new GregorianCalendar(1700,7,8);
		GregorianCalendar fechaNoBis2 = new GregorianCalendar(1800,6,7);
		GregorianCalendar fechaNoBis3 = new GregorianCalendar(1900,5,6);
		GregorianCalendar fechaNoBis4 = new GregorianCalendar(2100,4,5);
		
		//1) + traerAnio ( GregorianCalendar fecha) : int
		System.out.println("1) "+Funciones.traerAnio(fecha));
		
		//2) + traerMes ( GregorianCalendar fecha) : int //devuelve int entre 1 y 12
		System.out.println("2) "+Funciones.traerMes(fecha));
		
		//3) + traerDia (GregorianCalendar fecha) : int
		System.out.println("2) "+Funciones.traerDia(fecha));
		
		//4) + esBisiesto (int anio) : boolean
		//Ser·n bisiestos los aÒos divisibles por 4, exceptuando los que son divisibles por 100 y no divisibles
		//por 400.
		//ejemplos: son bisiestos 1996, 2004, 2000, 1600; No son bisiestos 1700, 1800, 1900, 2100
		System.out.println("************************esBisiesto***********************************");
		
		System.out.println(Funciones.esBisiesto(Funciones.traerNroAnio(fecha1)));
		System.out.println(Funciones.esBisiesto(Funciones.traerNroAnio(fechaBis1)));
		System.out.println(Funciones.esBisiesto(Funciones.traerNroAnio(fechaBis2)));
		System.out.println(Funciones.esBisiesto(Funciones.traerNroAnio(fechaBis3)));
		System.out.println(Funciones.esBisiesto(Funciones.traerNroAnio(fechaNoBis1)));
		System.out.println(Funciones.esBisiesto(Funciones.traerNroAnio(fechaNoBis2)));
		System.out.println(Funciones.esBisiesto(Funciones.traerNroAnio(fechaNoBis3)));
		System.out.println(Funciones.esBisiesto(Funciones.traerNroAnio(fechaNoBis4)));
		
		//5) + esFechaValida (par·metros int anio, int mes de 1 a 12, int dia)
		System.out.println("************************esFechaValida**********************************");
		System.out.println(Funciones.esFechaValida(2015, 6, 5));
		System.out.println(Funciones.esFechaValida(2000, 2, 29));
		System.out.println(Funciones.esFechaValida(2015,2,29));
		System.out.println(Funciones.esFechaValida(-2000, 1, 29));
		System.out.println(Funciones.esFechaValida(200000,13,30));
		System.out.println(Funciones.esFechaValida(50,11,32));
		System.out.println(Funciones.esFechaValida(2015, 2, 29));
		
		
		//6) + traerFecha (int anio, int mes, int dia) : GregorianCalendar // mes de 1 a 12
		System.out.println("6) "+Funciones.traerFechaCorta(Funciones.traerFecha(2015, 05, 05)));
		
		//7) + traerFecha (String fecha) : GregorianCalendar //par·metro de la forma ìdd/mm/aaaaî	
		System.out.println("**********************traerFecha String********************************");
		System.out.println(Funciones.traerFechaCorta(Funciones.traerFecha("11/09/2015")));
		System.out.println(Funciones.traerNroDia(Funciones.traerFecha("24/05/1991")));
		System.out.println(Funciones.traerNroMes(Funciones.traerFecha("24/05/1991")));
		System.out.println(Funciones.traerNroAnio(Funciones.traerFecha("24/05/1991")));

		//8) + traerFechaCorta (GregorianCalendar fecha) : String //retorna ìdd/mm/aaaaî
		System.out.println("8) "+Funciones.traerFechaCorta(fecha));
		
		//9) + esDiaHabil (GregorianCalendar fecha) : boolean //Consideramos h·bil de lunes a viernes.
		System.out.println("9) "+Funciones.esDiaHabil(fecha)+ " ,y una fecha que no sea habil :"+Funciones.esDiaHabil(new GregorianCalendar(2015,8,12)));
		//10) + traerDiaDeLaSemana (GregorianCalendar fecha) : String
		System.out.println("10) "+Funciones.traerDiaEnLetras(fecha));
		
		//11) + traerMesEnLetras (GregorianCalendar fecha) : String
		System.out.println("11) "+Funciones.traerMesEnLetras(fecha));
		
		//12) + traerFechaLarga (GregorianCalendar fecha) : String // ìDomingo 30 de Agosto del 2015î
		System.out.println("12) "+Funciones.traerFechaLarga(fecha));
		
		//13) + sonFechasIguales(GregorianCalendar fecha , GregorianCalendar fecha1) : boolean

		System.out.println("**********************sonFechasIguales********************************");
		System.out.println(Funciones.sonFechasIguales(fecha, fecha1));
		System.out.println(Funciones.sonFechasIguales(fecha,fechaBis1));
		
		//14) + traerCantDiasDeUnMes (int anio, int mes) : int
		
		System.out.println(Funciones.cantidadDiasMes(2015,9));
		
		//15) + aproximar2Decimal(double valor) : double //si el 3∞ decimal es mayor o igual 5, suma 1 al 2∞ decimal )

		System.out.println(Funciones.aproximar2Decimal(1.115));
		System.out.println(Funciones.aproximar2Decimal(0.115));
		System.out.println(Funciones.aproximar2Decimal(10.115));
		System.out.println(Funciones.aproximar2Decimal(100.555));
		System.out.println(Funciones.aproximar2Decimal(1.114));
	}

}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             .           ó.G.G
 ó.G}E    ..          ó.G.G
 ó.G4E    Âd b b 5 c  ˜b   ˇˇˇˇˇˇˇˇ  ˇˇˇˇÂ0 1 5 1 0  ˜d 3 9 b c e   1 d Â2 0 f 8 8  ˜7 a 5 8 e 5   8 0 Â0F887~1     ó.G.G  Y+G~E  Âa 0 4 e 7  49   ˇˇˇˇˇˇˇˇ  ˇˇˇˇÂ0 1 5 1 9  41 1 9 6 6 0   c 2 Â8 0 3 7 8  43 7 f 9 7 5   8 0 Â03783~1     ó.G.G  a+GE•                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  package vista;
import modelo.Funciones;
import java.util.GregorianCalendar;
import modelo.ObraSocial;
import modelo.Paciente;
public class TestPediatria {
	public static void main(String[] args) {

		ObraSocial obra1 = new ObraSocial("Sociedad","asd@asd.com","42220122");
		Paciente pac1 = new Paciente("Lopez","Juan",9999999,new GregorianCalendar(2015,7,2,18,32,20),obra1);

		System.out.println("Traer fecha de nacimiento "+pac1.traerFechaDeNacimiento());
		
		//ESCENARIOS Metodo EDAD
		//Dias
		/*1*/Paciente pac4=new Paciente("AAA","BBB",9999999,new GregorianCalendar(2015,8,4),obra1);
		System.out.println(pac4.traerEdad());
		/*2*/Paciente pac5=new Paciente("BBB","CCC",9999999,new GregorianCalendar(2015,8,3),obra1);
		System.out.println(pac5.traerEdad());
		
		//Meses
		/*3*/Paciente pac6=new Paciente("BBB","CCC",9999999,new GregorianCalendar(2015,7,4),obra1);
		System.out.println(pac6.traerEdad());
		/*4*/Paciente pac7=new Paciente("BBB","CCC",9999999,new GregorianCalendar(2014,7,4),obra1);
		System.out.println(pac7.traerEdad());	
		
		//AÒos
		/*5*/Paciente pac2 = new Paciente("Acosta","Joaquin",1111111,new GregorianCalendar(2014,9,2),obra1);
		System.out.println(pac2.traerEdad());
		/*6*/Paciente pac3 = new Paciente("Espinosa","Nicolas",36084320,new GregorianCalendar(1991,4,24),obra1);
		System.out.println(pac3.traerEdad()); 
		
		/*6*/Paciente pac8 = new Paciente("Maximiliano","Pizarro",36771843,new GregorianCalendar(1992,4,5),obra1);
		System.out.println(pac8.traerEdad()); 

		
	}
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  package modelo;
import java.util.Calendar;
import java.util.GregorianCalendar;

public class Funciones {
	//DIA
	public static String traerDia(GregorianCalendar fecha){
		String dia= String.valueOf(traerNroDia(fecha)); 
		if(traerNroDia(fecha)<10){
			dia="0"+dia;}
		return dia; 
	}
		
	public static int traerNroDia(GregorianCalendar fecha){
		return fecha.get(Calendar.DAY_OF_MONTH);
	}
	public static int traerNroDeDia(GregorianCalendar fecha){
		return fecha.get(Calendar.DAY_OF_WEEK);
	}
	public static String traerDiaEnLetras(GregorianCalendar fecha){
		String[] diaEnLetra= {"Domingo","Lunes","Martes","Miercoles","Jueves","Viernes","Sabado"};
		return diaEnLetra[traerNroDeDia(fecha)-1];
	}
	
	
	public static boolean esDiaHabil(GregorianCalendar fecha){
		return !(traerDiaEnLetras(fecha).compareTo("Sabado")==0)||(traerDiaEnLetras(fecha).compareTo("Domingo")==0);
	}
	
	//MES
	public static String traerMes(GregorianCalendar fecha){
		String mes=String.valueOf(traerNroMes(fecha));
		if(traerNroMes(fecha)<10){
			mes="0"+mes;
			}
		return mes;
	}
	
	public static int traerNroMes(GregorianCalendar fecha){
		return fecha.get(Calendar.MONTH)+1;		
	}
	
	
	public static String traerMesEnLetras(GregorianCalendar fecha){
		
		String[] mesEnLetra= {"Diciembre","Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre"};
		return mesEnLetra[traerNroMes(fecha)];
	}
	
	//A—O
	public static String traerAnio(GregorianCalendar fecha){
		return String.valueOf(traerNroAnio(fecha));
	}
	public static int traerNroAnio(GregorianCalendar fecha){
		return fecha.get(Calendar.YEAR);
	}
	
	//FORMATO FECHAS
	
	public static String traerFechaCorta(GregorianCalendar fecha){
		return traerDia(fecha)+"/"+traerMes(fecha)+"/"+traerAnio(fecha);
	}
	
	public static String traerFechaLarga(GregorianCalendar fecha){
		return traerDia(fecha)+" de "+traerMesEnLetras(fecha)+" de "+traerAnio(fecha);
		
	}
	public static GregorianCalendar traerFecha(int anio, int mes, int dia){
		return new GregorianCalendar (anio,mes-1,dia);
	}
	//HORA
	public static String traerHora(GregorianCalendar f)
	
	{
		String ap="am";
		String hora="";
		if(f.get(Calendar.AM_PM)==1){
			ap="pm";

		}
		hora=""+f.get(Calendar.HOUR_OF_DAY)+":"+f.get(Calendar.MINUTE)+":"+f.get(Calendar.SECOND)+" "+ap;
		
		return hora;
	}
	
	//Fecha en String de 12 (dd/mm/aaaa) separado por / y por -
	
	//Funciones de comparacion de fechas:dos fechas como parametros
	//Mayores
	public static boolean esDiaMayor(GregorianCalendar f, GregorianCalendar fecha){
		return (traerNroDia(f)>traerNroDia(fecha));
	}
	public static boolean esMesMayor(GregorianCalendar f, GregorianCalendar fecha){
		return (traerNroMes(f)>traerNroMes(fecha));
	}
	public static boolean esAnioMayor(GregorianCalendar f, GregorianCalendar fecha){
		return (traerNroAnio(f)>traerNroAnio(fecha));
	}
	//Iguales
	public static boolean esDiaIgual(GregorianCalendar f, GregorianCalendar fecha){
		return(traerNroDia(f)==traerNroDia(fecha));
	}
	public static boolean esMesIgual(GregorianCalendar f, GregorianCalendar fecha){
		return (traerNroMes(f)==traerNroMes(fecha));
	}
	public static boolean esAnioIgual(GregorianCalendar f, GregorianCalendar fecha){
		return (traerNroAnio(f)==traerNroAnio(fecha));
	}
	//Menores
	/*Para aÒos con diferencias menores que 1, ej:2015 y 2014, retorna true*/
	public static boolean diferenciaAnioDeUno(GregorianCalendar f, GregorianCalendar fecha){
		return (traerNroAnio(f)-traerNroAnio(fecha)==1);
	}
	
	
	public static int cantidadDiasMes(GregorianCalendar fecha){
		Integer[] cantidad={31,28,31,30,31,30,31,31,30,31,30,31};
		return cantidad[traerNroMes(fecha)-1];	
	}
	
	public static int cantidadDiasMes(int mes, int anio){
		Integer[] cantidad={31,28,31,30,31,30,31,31,30,31,30,31};
		if(esBisiesto(anio))
		{
			cantidad[1]=29;
		}

		return cantidad[mes-1];	
	}
	
	public static int cantidadDiasMesAnterior(GregorianCalendar fecha){
		Integer[] cantidad={31,31,28,31,30,31,30,31,31,30,31,30};
		return cantidad[traerNroMes(fecha)-1];
	}
	
	 public static boolean esBisiesto(int anio)
	 
	 {
		 boolean respuesta=false;
		 if(anio%4==0&&anio%100!=0||anio%400==0)
		 {
			 respuesta=true;
		 }
		 return respuesta;
		 
	 }
	

	 public static boolean esFechaValida(int anio, int mes, int dia)
	 {
		 boolean respuesta=false;
		 if (anio>0)
		 {
		 if(mes>0 && mes<13)
		 	{
			 	mes=cantidadDiasMes(mes,anio);
			 	if(dia>0 && dia<=mes)
			 	{
			 		respuesta=true;
			 	} 
		 	}
	     }
		 return respuesta;
	 }
	 

	 public static GregorianCalendar traerFecha(String fecha)
	 {
		 // 0 1 2 3 4 5 6 7 8 9
		 //	2 4 / 0 5 / 1 9 9 1
		 int dia=Integer.parseInt(fecha.substring(0,2));
		 int mes=Integer.parseInt(fecha.substring(3,5));
		 int anio=Integer.parseInt(fecha.substring(6,10));

		 return traerFecha(anio,mes,dia);
		 
	 }
	 
	 public static boolean sonFechasIguales(GregorianCalendar fecha, GregorianCalendar fecha1)
	 {
		 return (traerNroAnio(fecha)==traerNroAnio(fecha1)&&traerNroMes(fecha)==traerNroMes(fecha1)&&traerNroDeDia(fecha)==traerNroDeDia(fecha1));
	 }
	
	 
	
	
	
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           .           ó.G.G
 ó.GÅE    ..          ó.G.G
 ó.G4E    Âd 3 2 1 8  ÷3   ˇˇˇˇˇˇˇˇ  ˇˇˇˇÂ0 1 5 1 d  ÷e b c 7 9 e   0 8 Â4 0 6 3 3  ÷a f 6 1 4 5   8 0 Â0633A~1     ó.G.G  K£*GÇEñ  Âa 0 4 e 7  Ë9   ˇˇˇˇˇˇˇˇ  ˇˇˇˇÂ0 1 5 1 9  Ë1 1 9 6 6 0   c 2 Â6 0 f 1 1  Ë2 3 4 9 b 5   8 0 Â0F112~1     ó.G.G  êd+GÑEh                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  package modelo;
import java.util.Calendar;
import java.util.GregorianCalendar;

public class Funciones {
	//DIA
	public static String traerDia(GregorianCalendar fecha){
		String dia= String.valueOf(traerNroDia(fecha)); 
		if(traerNroDia(fecha)<10){
			dia="0"+dia;}
		return dia; 
	}
		
	public static int traerNroDia(GregorianCalendar fecha){
		return fecha.get(Calendar.DAY_OF_MONTH);
	}
	public static int traerNroDeDia(GregorianCalendar fecha){
		return fecha.get(Calendar.DAY_OF_WEEK);
	}
	public static String traerDiaEnLetras(GregorianCalendar fecha){
		String[] diaEnLetra= {"Domingo","Lunes","Martes","Miercoles","Jueves","Viernes","Sabado"};
		return diaEnLetra[traerNroDeDia(fecha)-1];
	}
	
	//MES
	public static String traerMes(GregorianCalendar fecha){
		String mes=String.valueOf(traerNroMes(fecha));
		if(traerNroMes(fecha)<10){
			mes="0"+mes;
			}
		return mes;
	}
	
	public static int traerNroMes(GregorianCalendar fecha){
		return fecha.get(Calendar.MONTH)+1;		
	}
	
	
	public static String traerMesEnLetras(GregorianCalendar fecha){
		
		String[] mesEnLetra= {"Diciembre","Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre"};
		return mesEnLetra[traerNroMes(fecha)];
	}
	
	//A—O
	public static String traerAnio(GregorianCalendar fecha){
		return String.valueOf(traerNroAnio(fecha));
	}
	public static int traerNroAnio(GregorianCalendar fecha){
		return fecha.get(Calendar.YEAR);
	}
	
	//FORMATO FECHAS
	
	public static String traerFechaCorta(GregorianCalendar fecha){
		return traerDia(fecha)+"/"+traerMes(fecha)+"/"+traerAnio(fecha);
	}
	
	public static String traerFechaLarga(GregorianCalendar fecha){
		return traerDiaEnLetras(fecha)+" "+traerDia(fecha)+" de "+traerMesEnLetras(fecha)+" de "+traerAnio(fecha);
	}
	
	//6) + traerFecha (int anio, int mes, int dia) : GregorianCalendar // mes de 1 a 12
	public static GregorianCalendar traerFecha(int anio, int mes, int dia){
		return new GregorianCalendar(anio,mes-1,dia);
	}
	
	//HORA
	public static String traerHora(GregorianCalendar f)
	
	{
		String ap="am";
		String hora="";
		if(f.get(Calendar.AM_PM)==1){
			ap="pm";

		}
		hora=""+f.get(Calendar.HOUR_OF_DAY)+":"+f.get(Calendar.MINUTE)+":"+f.get(Calendar.SECOND)+" "+ap;
		
		return hora;
	}
	
	//Fecha en String de 12 (dd/mm/aaaa) separado por / y por -
	
	//Funciones de comparacion de fechas:dos fechas como parametros
	//Mayores
	public static boolean esDiaMayor(GregorianCalendar f, GregorianCalendar fecha){
		boolean respuesta=false;
		if(traerNroDia(f)>traerNroDia(fecha))respuesta=true;
		return respuesta;
	}
	public static boolean esMesMayor(GregorianCalendar f, GregorianCalendar fecha){
		boolean respuesta=false;
		if(traerNroMes(f)>traerNroMes(fecha))respuesta=true;
		return respuesta;
	}
	public static boolean esAnioMayor(GregorianCalendar f, GregorianCalendar fecha){
		boolean respuesta=false;
		if(traerNroAnio(f)>traerNroAnio(fecha))respuesta=true;
		return respuesta;
	}
	//Iguales
	public static boolean esDiaIgual(GregorianCalendar f, GregorianCalendar fecha){
		boolean respuesta=false;
		if(traerNroDia(f)==traerNroDia(fecha))respuesta=true;
		return respuesta;
	}
	public static boolean esMesIgual(GregorianCalendar f, GregorianCalendar fecha){
		boolean respuesta=false;
		if(traerNroMes(f)==traerNroMes(fecha))respuesta=true;
		return respuesta;
	}
	public static boolean esAnioIgual(GregorianCalendar f, GregorianCalendar fecha){
		boolean respuesta=false;
		if(traerNroAnio(f)==traerNroAnio(fecha))respuesta=true;
		return respuesta;
	}
	//Menores
	/*Para aÒos con diferencias menores que 1, ej:2015 y 2014, retorna true*/
	public static boolean diferenciaAnioDeUno(GregorianCalendar f, GregorianCalendar fecha){
		boolean respuesta=false;
		if(traerNroAnio(f)-traerNroAnio(fecha)==1)respuesta=true;
		return respuesta;
	}
	
	
	public static int cantidadDiasMes(GregorianCalendar fecha){
		Integer[] cantidad={31,28,31,30,31,30,31,31,30,31,30,31};
		return cantidad[traerNroMes(fecha)-1];	
	}
	
	public static int cantidadDiasMesAnterior(GregorianCalendar fecha){
		Integer[] cantidad={31,31,28,31,30,31,30,31,31,30,31,30};
		return cantidad[traerNroMes(fecha)-1];
	}
	
	//4) + esBisiesto (int anio) : boolean
		//Ser·n bisiestos los aÒos divisibles por 4, exceptuando los que son divisibles por 100 y no divisibles
		//por 400.
		//ejemplos: son bisiestos 1996, 2004, 2000, 1600; No son bisiestos 1700, 1800, 1900, 2100
	//5) + esFechaValida (par·metros int anio, int mes de 1 a 12, int dia)
	
	//7) + traerFecha (String fecha) : GregorianCalendar //par·metro de la forma ìdd/mm/aaaaî	
	//9) + esDiaHabil (GregorianCalendar fecha) : boolean //Consideramos h·bil de lunes a viernes.
	//13) + sonFechasIguales(GregorianCalendar fecha , GregorianCalendar fecha1) : boolean
	//14) + traerCantDiasDeUnMes (int anio, int mes) : int
	//15) + aproximar2Decimal
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          package modelo;
import java.util.Calendar;
import java.util.GregorianCalendar;

public class Funciones {
	//DIA
	public static String traerDia(GregorianCalendar fecha){
		String dia= String.valueOf(traerNroDia(fecha)); 
		if(traerNroDia(fecha)<10){
			dia="0"+dia;}
		return dia; 
	}
		
	public static int traerNroDia(GregorianCalendar fecha){
		return fecha.get(Calendar.DAY_OF_MONTH);
	}
	public static int traerNroDeDia(GregorianCalendar fecha){
		return fecha.get(Calendar.DAY_OF_WEEK);
	}
	public static String traerDiaEnLetras(GregorianCalendar fecha){
		String[] diaEnLetra= {"Domingo","Lunes","Martes","Miercoles","Jueves","Viernes","Sabado"};
		return diaEnLetra[traerNroDeDia(fecha)-1];
	}
	
	
	public static boolean esDiaHabil(GregorianCalendar fecha){
		return !(traerDiaEnLetras(fecha).compareTo("Sabado")==0)||(traerDiaEnLetras(fecha).compareTo("Domingo")==0);
	}
	
	//MES
	public static String traerMes(GregorianCalendar fecha){
		String mes=String.valueOf(traerNroMes(fecha));
		if(traerNroMes(fecha)<10){
			mes="0"+mes;
			}
		return mes;
	}
	
	public static int traerNroMes(GregorianCalendar fecha){
		return fecha.get(Calendar.MONTH)+1;		
	}
	
	
	public static String traerMesEnLetras(GregorianCalendar fecha){
		
		String[] mesEnLetra= {"Diciembre","Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre"};
		return mesEnLetra[traerNroMes(fecha)];
	}
	
	//A—O
	public static String traerAnio(GregorianCalendar fecha){
		return String.valueOf(traerNroAnio(fecha));
	}
	public static int traerNroAnio(GregorianCalendar fecha){
		return fecha.get(Calendar.YEAR);
	}
	
	//FORMATO FECHAS
	
	public static String traerFechaCorta(GregorianCalendar fecha){
		return traerDia(fecha)+"/"+traerMes(fecha)+"/"+traerAnio(fecha);
	}
	
	public static String traerFechaLarga(GregorianCalendar fecha){
		return traerDia(fecha)+" de "+traerMesEnLetras(fecha)+" de "+traerAnio(fecha);
		
	}
	public static GregorianCalendar traerFecha(int anio, int mes, int dia){
		return new GregorianCalendar (anio,mes-1,dia);
	}
	//HORA
	public static String traerHora(GregorianCalendar f)
	
	{
		String ap="am";
		String hora="";
		if(f.get(Calendar.AM_PM)==1){
			ap="pm";

		}
		hora=""+f.get(Calendar.HOUR_OF_DAY)+":"+f.get(Calendar.MINUTE)+":"+f.get(Calendar.SECOND)+" "+ap;
		
		return hora;
	}
	
	//Fecha en String de 12 (dd/mm/aaaa) separado por / y por -
	
	//Funciones de comparacion de fechas:dos fechas como parametros
	//Mayores
	public static boolean esDiaMayor(GregorianCalendar f, GregorianCalendar fecha){
		return (traerNroDia(f)>traerNroDia(fecha));
	}
	public static boolean esMesMayor(GregorianCalendar f, GregorianCalendar fecha){
		return (traerNroMes(f)>traerNroMes(fecha));
	}
	public static boolean esAnioMayor(GregorianCalendar f, GregorianCalendar fecha){
		return (traerNroAnio(f)>traerNroAnio(fecha));
	}
	//Iguales
	public static boolean esDiaIgual(GregorianCalendar f, GregorianCalendar fecha){
		return(traerNroDia(f)==traerNroDia(fecha));
	}
	public static boolean esMesIgual(GregorianCalendar f, GregorianCalendar fecha){
		return (traerNroMes(f)==traerNroMes(fecha));
	}
	public static boolean esAnioIgual(GregorianCalendar f, GregorianCalendar fecha){
		return (traerNroAnio(f)==traerNroAnio(fecha));
	}
	//Menores
	/*Para aÒos con diferencias menores que 1, ej:2015 y 2014, retorna true*/
	public static boolean diferenciaAnioDeUno(GregorianCalendar f, GregorianCalendar fecha){
		return (traerNroAnio(f)-traerNroAnio(fecha)==1);
	}
	
	
	public static int cantidadDiasMes(GregorianCalendar fecha){
		Integer[] cantidad={31,28,31,30,31,30,31,31,30,31,30,31};
		return cantidad[traerNroMes(fecha)-1];	
	}
	
	public static int cantidadDiasMes(int anio, int mes){
		Integer[] cantidad={31,28,31,30,31,30,31,31,30,31,30,31};
		if(esBisiesto(anio))
		{
			cantidad[1]=29;
		}

		return cantidad[mes-1];	
	}
	
	public static int cantidadDiasMesAnterior(GregorianCalendar fecha){
		Integer[] cantidad={31,31,28,31,30,31,30,31,31,30,31,30};
		return cantidad[traerNroMes(fecha)-1];
	}
	
	 public static boolean esBisiesto(int anio)
	 
	 {
		 boolean respuesta=false;
		 if(anio%4==0&&anio%100!=0||anio%400==0)
		 {
			 respuesta=true;
		 }
		 return respuesta;
		 
	 }
	

	 public static boolean esFechaValida(int anio, int mes, int dia)
	 {
		 boolean respuesta=false;
		 if (anio>0)
		 {
		 if(mes>0 && mes<13)
		 	{
			 	mes=cantidadDiasMes(anio,mes);
			 	if(dia>0 && dia<=mes)
			 	{
			 		respuesta=true;
			 	} 
		 	}
	     }
		 return respuesta;
	 }
	 

	 public static GregorianCalendar traerFecha(String fecha)
	 {
		 // 0 1 2 3 4 5 6 7 8 9
		 //	2 4 / 0 5 / 1 9 9 1
		 int dia=Integer.parseInt(fecha.substring(0,2));
		 int mes=Integer.parseInt(fecha.substring(3,5));
		 int anio=Integer.parseInt(fecha.substring(6,10));

		 return traerFecha(anio,mes,dia);
		 
	 }
	 
	 public static boolean sonFechasIguales(GregorianCalendar fecha, GregorianCalendar fecha1)
	 {
		 return (traerNroAnio(fecha)==traerNroAnio(fecha1)&&traerNroMes(fecha)==traerNroMes(fecha1)&&traerNroDeDia(fecha)==traerNroDeDia(fecha1));
	 }
	
	 public static double aproximar2Decimal(double valor)
	 {
		 valor=valor+0.005;
		 String v = String.valueOf(valor);
		 v=v.substring(0,v.length());
		 return Double.parseDouble(v);
		 
	 }
	
	
	
}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        .           ó.G.G
 ó.GÜE    ..          ó.G.G
 ó.G4E    Âa 0 4 e 7  π9   ˇˇˇˇˇˇˇˇ  ˇˇˇˇÂ0 1 5 1 9  π1 1 9 6 6 0   c 2 Â0 0 f a e  π2 1 5 9 b 5   8 0 Â0FAE2~1     ó.G.G  Sd+GáE‹  Âd b b 5 c  Ib   ˇˇˇˇˇˇˇˇ  ˇˇˇˇÂ0 1 5 1 0  Id 3 9 b c e   1 d Â4 0 d 5 d  Id 4 3 8 e 5   8 0 Â0D5DD~1     "ó.G.G  ΩX+GâE6	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  package test;
import modelo.Funciones;
import java.util.GregorianCalendar;

public class TestFunciones {

	/**
	 * @param args
	 */
	public static void main(String[] args) {
		// TODO Auto-generated method stub
		
		GregorianCalendar fecha= new GregorianCalendar();
		GregorianCalendar fecha1 = new GregorianCalendar(2015,8,11);
		GregorianCalendar fechaBis1 = new GregorianCalendar(1996,5,4);
		GregorianCalendar fechaBis2 = new GregorianCalendar(2004,6,7);
		GregorianCalendar fechaBis3 = new GregorianCalendar(2000,7,6);
		GregorianCalendar fechaNoBis1 = new GregorianCalendar(1700,7,8);
		GregorianCalendar fechaNoBis2 = new GregorianCalendar(1800,6,7);
		GregorianCalendar fechaNoBis3 = new GregorianCalendar(1900,5,6);
		GregorianCalendar fechaNoBis4 = new GregorianCalendar(2100,4,5);
		
		//1) + traerAnio ( GregorianCalendar fecha) : int
		System.out.println("1) "+Funciones.traerAnio(fecha));
		
		//2) + traerMes ( GregorianCalendar fecha) : int //devuelve int entre 1 y 12
		System.out.println("2) "+Funciones.traerMes(fecha));
		
		//3) + traerDia (GregorianCalendar fecha) : int
		System.out.println("2) "+Funciones.traerDia(fecha));
		
		//4) + esBisiesto (int anio) : boolean
		//Ser·n bisiestos los aÒos divisibles por 4, exceptuando los que son divisibles por 100 y no divisibles
		//por 400.
		//ejemplos: son bisiestos 1996, 2004, 2000, 1600; No son bisiestos 1700, 1800, 1900, 2100
		System.out.println("************************esBisiesto***********************************");
		
		System.out.println(Funciones.esBisiesto(Funciones.traerNroAnio(fecha1)));
		System.out.println(Funciones.esBisiesto(Funciones.traerNroAnio(fechaBis1)));
		System.out.println(Funciones.esBisiesto(Funciones.traerNroAnio(fechaBis2)));
		System.out.println(Funciones.esBisiesto(Funciones.traerNroAnio(fechaBis3)));
		System.out.println(Funciones.esBisiesto(Funciones.traerNroAnio(fechaNoBis1)));
		System.out.println(Funciones.esBisiesto(Funciones.traerNroAnio(fechaNoBis2)));
		System.out.println(Funciones.esBisiesto(Funciones.traerNroAnio(fechaNoBis3)));
		System.out.println(Funciones.esBisiesto(Funciones.traerNroAnio(fechaNoBis4)));
		
		//5) + esFechaValida (par·metros int anio, int mes de 1 a 12, int dia)
		System.out.println("************************esFechaValida**********************************");
		System.out.println(Funciones.esFechaValida(2015, 6, 5));
		System.out.println(Funciones.esFechaValida(2000, 2, 29));
		System.out.println(Funciones.esFechaValida(2015,2,29));
		System.out.println(Funciones.esFechaValida(-2000, 1, 29));
		System.out.println(Funciones.esFechaValida(200000,13,30));
		System.out.println(Funciones.esFechaValida(50,11,32));
		System.out.println(Funciones.esFechaValida(2015, 2, 29));
		
		
		//6) + traerFecha (int anio, int mes, int dia) : GregorianCalendar // mes de 1 a 12
		System.out.println("6) "+Funciones.traerFechaCorta(Funciones.traerFecha(2015, 05, 05)));
		
		//7) + traerFecha (String fecha) : GregorianCalendar //par·metro de la forma ìdd/mm/aaaaî	
		System.out.println("**********************traerFecha String********************************");
		System.out.println(Funciones.traerFechaCorta(Funciones.traerFecha("11/09/2015")));
		System.out.println(Funciones.traerNroDia(Funciones.traerFecha("24/05/1991")));
		System.out.println(Funciones.traerNroMes(Funciones.traerFecha("24/05/1991")));
		System.out.println(Funciones.traerNroAnio(Funciones.traerFecha("24/05/1991")));

		//8) + traerFechaCorta (GregorianCalendar fecha) : String //retorna ìdd/mm/aaaaî
		System.out.println("8) "+Funciones.traerFechaCorta(fecha));
		
		//9) + esDiaHabil (GregorianCalendar fecha) : boolean //Consideramos h·bil de lunes a viernes.
		System.out.println("9) "+Funciones.esDiaHabil(fecha)+ " ,y una fecha que no sea habil :"+Funciones.esDiaHabil(new GregorianCalendar(2015,8,12)));
		//10) + traerDiaDeLaSemana (GregorianCalendar fecha) : String
		System.out.println("10) "+Funciones.traerDiaEnLetras(fecha));
		
		//11) + traerMesEnLetras (GregorianCalendar fecha) : String
		System.out.println("11) "+Funciones.traerMesEnLetras(fecha));
		
		//12) + traerFechaLarga (GregorianCalendar fecha) : String // ìDomingo 30 de Agosto del 2015î
		System.out.println("12) "+Funciones.traerFechaLarga(fecha));
		
		//13) + sonFechasIguales(GregorianCalendar fecha , GregorianCalendar fecha1) : boolean

		System.out.println("**********************sonFechasIguales********************************");
		System.out.println(Funciones.sonFechasIguales(fecha, fecha1));
		System.out.println(Funciones.sonFechasIguales(fecha,fechaBis1));
		
		//14) + traerCantDiasDeUnMes (int anio, int mes) : int
		
		System.out.println(Funciones.cantidadDiasMes(2015,9));
		
		//15) + aproximar2Decimal(double valor) : double //si el 3∞ decimal es mayor o igual 5, suma 1 al 2∞ decimal )

		System.out.println(Funciones.aproximar2Decimal(1.115));
		System.out.println(Funciones.aproximar2Decimal(100.555));
		System.out.println(Funciones.aproximar2Decimal(1.114));
	}

}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       @""@"@"@@""@"@"@@""@"@"@@""@"@"@@""@"@"@@""@"@"@@""@"@"@@""@"@"@@""@"@"@@""@"@"@@""@"@"@@""@"@"@@""@"@"@@""@"@"@@""@"@"@@""@"@"@@""@"@"@@""@"@"@@""@"@"@@""@"@"@@""@"@"@@""@"@"@@""@"@"@@": @"	@^ 	  6H §^êH ê êH ±%ÄDÄD‡ÄDD¿F&ÄÄDDÄDÄDÄÄDm∞ïÄ$–ÄDÄDÄDÄDD∞nÄDÄÄDD‡ñ¿çÄ ¨≈  $ë t& ë   ¸°   ëâ Ó œ  ââ â¿K ¿Kâ â â  ââ â`M   â$ ?≠H$ H n"  H$C∞¸@"–@"f@"p‚h@""@"»[@@"F@"@"P@""ÿ'ÿ'@@""@"p@ |+ 	 		  	 	 		  	  ”Äó¿ó 	@6		 @ö 	 		@öÄó 	 	  ó¿
 		 ∂ 	  	j .⁄êH ∂ êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êHêH ê êH H êH∑ êÄDêÄDDÄDÄDÄÄd$Äd∞çÄ‘$Ä$Ä$Ä ˘G $	$ $ $ Q $   $ˇ ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ¸ˇˇˇ  ÄH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        .           %ó.G.G
 ó.GäE    ..          %ó.G.G
 ó.G4E    Âd 3 2 1 8  A3   ˇˇˇˇˇˇˇˇ  ˇˇˇˇÂ0 1 5 1 d  Ae b c 7 9 e   0 8 Â7 0 1 9 4  A6 8 8 0 e 5   8 0 Â01946~1     'ó.G.G  eû*GãEc  Â7 d c f 6  e   ˇˇˇˇˇˇˇˇ  ˇˇˇˇÂ0 1 5 1 e  8 9 8 b 8 c   b b Â9 0 8 b e  5 4 0 8 8 5   8 0 Â08BE5~1     *ó.G.G  úR+GåE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  2015-09-17 20:14:50,609 [main] INFO  c.n.h.c.p.n.NettyAsyncHttpProvider - Number of application's worked threads is 2
2015-09-17 20:14:56,687 [pool-5-thread-1] INFO  c.n.h.c.p.n.NettyAsyncHttpProvider - Number of application's worked threads is 2
2015-09-17 20:14:58,156 [main] ERROR o.e.r.i.r.repo.ModelRepositoryIndex - Failed to open search index.
org.apache.lucene.index.IndexNotFoundException: no segments* file found in org.apache.lucene.store.SimpleFSDirectory@E:\Orientacion a objetos\EclipsePortable\Data\workspace\.metadata\.plugins\org.eclipse.recommenders.rcp\index lockFactory=org.apache.lucene.store.NativeFSLockFactory@60af0b: files: []
	at org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(SegmentInfos.java:712) ~[org.apache.lucene.core_3.5.0.v20120319-2345.jar:3.5.0 1204988 - simon - 2011-11-22 14:46:51]
	at org.apache.lucene.index.DirectoryReader.open(DirectoryReader.java:75) ~[org.apache.lucene.core_3.5.0.v20120319-2345.jar:3.5.0 1204988 - simon - 2011-11-22 14:46:51]
	at org.apache.lucene.index.IndexReader.open(IndexReader.java:462) ~[org.apache.lucene.core_3.5.0.v20120319-2345.jar:3.5.0 1204988 - simon - 2011-11-22 14:46:51]
	at org.apache.lucene.index.IndexReader.open(IndexReader.java:308) ~[org.apache.lucene.core_3.5.0.v20120319-2345.jar:3.5.0 1204988 - simon - 2011-11-22 14:46:51]
	at org.eclipse.recommenders.internal.rcp.repo.ModelRepositoryIndex.open(ModelRepositoryIndex.java:64) ~[org.eclipse.recommenders.rcp_1.0.0.v20120612-2305-b156.jar:na]
	at org.eclipse.recommenders.internal.rcp.wiring.RecommendersModule$ServicesInitializer.<init>(RecommendersModule.java:353) [org.eclipse.recommenders.rcp_1.0.0.v20120612-2305-b156.jar:na]
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) [na:1.6.0_18]
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source) [na:1.6.0_18]
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source) [na:1.6.0_18]
	at java.lang.reflect.Constructor.newInstance(Unknown Source) [na:1.6.0_18]
	at com.google.inject.internal.DefaultConstructionProxyFactory$1.newInstance(DefaultConstructionProxyFactory.java:85) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.ConstructorInjector.construct(ConstructorInjector.java:85) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.ConstructorBindingImpl$Factory.get(ConstructorBindingImpl.java:254) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1031) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.Scopes$1$1.get(Scopes.java:65) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.InternalInjectorCreator$1.call(InternalInjectorCreator.java:204) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.InternalInjectorCreator$1.call(InternalInjectorCreator.java:198) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1024) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.InternalInjectorCreator.loadEagerSingletons(InternalInjectorCreator.java:198) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.InternalInjectorCreator.injectDynamically(InternalInjectorCreator.java:179) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.InternalInjectorCreator.build(InternalInjectorCreator.java:109) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.Guice.createInjector(Guice.java:95) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.Guice.createInjector(Guice.java:72) [com.google.inject_3.0.0.v201203062045.jar:na]
	at org.eclipse.recommenders.injection.InjectionService.getInjector(InjectionService.java:47) [org.eclipse.recommenders.injection_1.0.0.v20120612-2305-b156.jar:na]
	at org.eclipse.recommenders.injection.ExtensionFactory.<init>(ExtensionFactory.java:28) [org.eclipse.recommenders.injection_1.0.0.v20120612-2305-b156.jar:na]
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) [na:1.6.0_18]
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source) [na:1.6.0_18]
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source) [na:1.6.0_18]
	at java.lang.reflect.Constructor.newInstance(Unknown Source) [na:1.6.0_18]
	at java.lang.Class.newInstance0(Unknown Source) [na:1.6.0_18]
	at java.lang.Class.newInstance(Unknown Source) [na:1.6.0_18]
	at org.eclipse.core.internal.registry.osgi.RegistryStrategyOSGI.createExecutableExtension(RegistryStrategyOSGI.java:184) [org.eclipse.equinox.registry_3.5.200.v20120522-1841.jar:na]
	at org.eclipse.core.internal.registry.ExtensionRegistry.createExecutableExtension(ExtensionRegistry.java:905) [org.eclipse.equinox.registry_3.5.200.v20120522-1841.jar:na]
	at org.eclipse.core.internal.registry.ConfigurationElement.createExecutableExtension(ConfigurationElement.java:243) [org.eclipse.equinox.registry_3.5.200.v20120522-1841.jar:na]
	at org.eclipse.core.internal.registry.ConfigurationElementHandle.createExecutableExtension(ConfigurationElementHandle.java:55) [org.eclipse.equinox.registry_3.5.200.v20120522-1841.jar:na]
	at org.eclipse.jdt.internal.ui.text.java.CompletionProposalComputerDescriptor.createComputer(CompletionProposalComputerDescriptor.java:308) [org.eclipse.jdt.ui_3.8.0.v20120524-1551.jar:na]
	at org.eclipse.jdt.internal.ui.text.java.CompletionProposalComputerDescriptor.getComputer(CompletionProposalComputerDescriptor.java:275) [org.eclipse.jdt.ui_3.8.0.v20120524-1551.jar:na]
	at org.eclipse.jdt.internal.ui.text.java.CompletionProposalComputerDescriptor.sessionStarted(CompletionProposalComputerDescriptor.java:418) [org.eclipse.jdt.ui_3.8.0.v20120524-1551.jar:na]
	at org.eclipse.jdt.internal.ui.text.java.CompletionProposalCategory.sessionStarted(CompletionProposalCategory.java:379) [org.eclipse.jdt.ui_3.8.0.v20120524-1551.jar:na]
	at org.eclipse.jdt.internal.ui.text.java.ContentAssistProcessor$CompletionListener.assistSessionStarted(ContentAssistProcessor.java:117) [org.eclipse.jdt.ui_3.8.0.v20120524-1551.jar:na]
	at org.eclipse.jface.text.contentassist.ContentAssistant.fireSessionBeginEvent(ContentAssistant.java:2221) [org.eclipse.jface.text_3.8.0.v20120531-0600.jar:na]
	at org.eclipse.jface.text.contentassist.ContentAssistant.prepareToShowCompletions(ContentAssistant.java:1696) [org.eclipse.jface.text_3.8.0.v20120531-0600.jar:na]
	at org.eclipse.jface.text.contentassist.ContentAssistant.access$6(ContentAssistant.java:1687) [org.eclipse.jface.text_3.8.0.v20120531-0600.jar:na]
	at org.eclipse.jface.text.contentassist.ContentAssistant$2.run(ContentAssistant.java:376) [org.eclipse.jface.text_3.8.0.v20120531-0600.jar:na]
	at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35) [org.eclipse.swt.win32.win32.x86_3.100.0.v4233d.jar:na]
	at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:135) [org.eclipse.swt.win32.win32.x86_3.100.0.v4233d.jar:na]
	at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:4144) [org.eclipse.swt.win32.win32.x86_3.100.0.v4233d.jar:na]
	at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3761) [org.eclipse.swt.win32.win32.x86_3.100.0.v4233d.jar:na]
	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1022) [org.eclipse.e4.ui.workbench.swt_0.10.1.v20120525-2014.jar:na]
	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) [org.eclipse.core.databinding.observable_1.4.1.v20120521-2329.jar:na]
	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:916) [org.eclipse.e4.ui.workbench.swt_0.10.1.v20120525-2014.jar:na]
	at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:86) [org.eclipse.e4.ui.workbench_0.10.2.v20120531-1742.jar:na]
	at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:585) [org.eclipse.ui.workbench_3.103.0.v20120530-1824.jar:na]
	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) [org.eclipse.core.databinding.observable_1.4.1.v20120521-2329.jar:na]
	at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:540) [org.eclipse.ui.workbench_3.103.0.v20120530-1824.jar:na]
	at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149) [org.eclipse.ui.workbench_3.103.0.v20120530-1824.jar:na]
	at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:124) [org.eclipse.ui.ide.application_1.0.400.v20120523-1955.jar:na]
	at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) [org.eclipse.equinox.app_1.3.100.v20120522-1841.jar:na]
	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110) [org.eclipse.osgi_3.8.0.v20120529-1548.jar:na]
	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79) [org.eclipse.osgi_3.8.0.v20120529-1548.jar:na]
	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:353) [org.eclipse.osgi_3.8.0.v20120529-1548.jar:na]
	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:180) [org.eclipse.osgi_3.8.0.v20120529-1548.jar:na]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.6.0_18]
	at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) ~[na:1.6.0_18]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) ~[na:1.6.0_18]
	at java.lang.reflect.Method.invoke(Unknown Source) ~[na:1.6.0_18]
	at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:629) [org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar:na]
	at org.eclipse.equinox.launcher.Main.basicRun(Main.java:584) [org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar:na]
	at org.eclipse.equinox.launcher.Main.run(Main.java:1438) [org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar:na]
2015-09-17 20:15:02,281 [Worker-22] WARN  o.e.r.i.rcp.repo.ModelRepository - 'remote-models (http://download.eclipse.org/recommenders/models/juno/, releases+snapshots)' did not send ETAG header for 'org.eclipse.recommenders:index:pom:0.0.0'.
2015-09-17 20:15:02,390 [Worker-22] ERROR o.e.r.i.r.repo.ModelRepositoryIndex - Failed to open search index.
org.apache.lucene.index.IndexNotFoundException: no segments* file found in org.apache.lucene.store.SimpleFSDirectory@E:\Orientacion a objetos\EclipsePortable\Data\workspace\.metadata\.plugins\org.eclipse.recommenders.rcp\index lockFactory=org.apache.lucene.store.NativeFSLockFactory@13690b5: files: []
	at org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(SegmentInfos.java:712) ~[org.apache.lucene.core_3.5.0.v20120319-2345.jar:3.5.0 1204988 - simon - 2011-11-22 14:46:51]
	at org.apache.lucene.index.DirectoryReader.open(DirectoryReader.java:75) ~[org.apache.lucene.core_3.5.0.v20120319-2345.jar:3.5.0 1204988 - simon - 2011-11-22 14:46:51]
	at org.apache.lucene.index.IndexReader.open(IndexReader.java:462) ~[org.apache.lucene.core_3.5.0.v20120319-2345.jar:3.5.0 1204988 - simon - 2011-11-22 14:46:51]
	at org.apache.lucene.index.IndexReader.open(IndexReader.java:308) ~[org.apache.lucene.core_3.5.0.v20120319-2345.jar:3.5.0 1204988 - simon - 2011-11-22 14:46:51]
	at org.eclipse.recommenders.internal.rcp.repo.ModelRepositoryIndex.open(ModelRepositoryIndex.java:64) ~[org.eclipse.recommenders.rcp_1.0.0.v20120612-2305-b156.jar:na]
	at org.eclipse.recommenders.internal.rcp.repo.UpdateModelIndexJob.run(UpdateModelIndexJob.java:55) [org.eclipse.recommenders.rcp_1.0.0.v20120612-2305-b156.jar:na]
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54) [org.eclipse.core.jobs_3.5.200.v20120521-2346.jar:na]
2015-09-18 18:13:25,437 [main] INFO  c.n.h.c.p.n.NettyAsyncHttpProvider - Number of application's worked threads is 2
2015-09-18 18:13:28,312 [pool-5-thread-1] INFO  c.n.h.c.p.n.NettyAsyncHttpProvider - Number of application's worked threads is 2
2015-09-18 18:13:28,593 [main] ERROR o.e.r.i.r.repo.ModelRepositoryIndex - Failed to open search index.
org.apache.lucene.index.IndexNotFoundException: no segments* file found in org.apache.lucene.store.SimpleFSDirectory@E:\Orientacion a objetos\EclipsePortable\Data\workspace\.metadata\.plugins\org.eclipse.recommenders.rcp\index lockFactory=org.apache.lucene.store.NativeFSLockFactory@1fcde1f: files: []
	at org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(SegmentInfos.java:712) ~[org.apache.lucene.core_3.5.0.v20120319-2345.jar:3.5.0 1204988 - simon - 2011-11-22 14:46:51]
	at org.apache.lucene.index.DirectoryReader.open(DirectoryReader.java:75) ~[org.apache.lucene.core_3.5.0.v20120319-2345.jar:3.5.0 1204988 - simon - 2011-11-22 14:46:51]
	at org.apache.lucene.index.IndexReader.open(IndexReader.java:462) ~[org.apache.lucene.core_3.5.0.v20120319-2345.jar:3.5.0 1204988 - simon - 2011-11-22 14:46:51]
	at org.apache.lucene.index.IndexReader.open(IndexReader.java:308) ~[org.apache.lucene.core_3.5.0.v20120319-2345.jar:3.5.0 1204988 - simon - 2011-11-22 14:46:51]
	at org.eclipse.recommenders.internal.rcp.repo.ModelRepositoryIndex.open(ModelRepositoryIndex.java:64) ~[org.eclipse.recommenders.rcp_1.0.0.v20120612-2305-b156.jar:na]
	at org.eclipse.recommenders.internal.rcp.wiring.RecommendersModule$ServicesInitializer.<init>(RecommendersModule.java:353) [org.eclipse.recommenders.rcp_1.0.0.v20120612-2305-b156.jar:na]
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) [na:1.6.0_18]
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source) [na:1.6.0_18]
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source) [na:1.6.0_18]
	at java.lang.reflect.Constructor.newInstance(Unknown Source) [na:1.6.0_18]
	at com.google.inject.internal.DefaultConstructionProxyFactory$1.newInstance(DefaultConstructionProxyFactory.java:85) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.ConstructorInjector.construct(ConstructorInjector.java:85) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.ConstructorBindingImpl$Factory.get(ConstructorBindingImpl.java:254) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1031) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.Scopes$1$1.get(Scopes.java:65) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.InternalInjectorCreator$1.call(InternalInjectorCreator.java:204) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.InternalInjectorCreator$1.call(InternalInjectorCreator.java:198) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1024) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.InternalInjectorCreator.loadEagerSingletons(InternalInjectorCreator.java:198) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.InternalInjectorCreator.injectDynamically(InternalInjectorCreator.java:179) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.InternalInjectorCreator.build(InternalInjectorCreator.java:109) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.Guice.createInjector(Guice.java:95) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.Guice.createInjector(Guice.java:72) [com.google.inject_3.0.0.v201203062045.jar:na]
	at org.eclipse.recommenders.injection.InjectionService.getInjector(InjectionService.java:47) [org.eclipse.recommenders.injection_1.0.0.v20120612-2305-b156.jar:na]
	at org.eclipse.recommenders.injection.ExtensionFactory.<init>(ExtensionFactory.java:28) [org.eclipse.recommenders.injection_1.0.0.v20120612-2305-b156.jar:na]
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) [na:1.6.0_18]
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source) [na:1.6.0_18]
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source) [na:1.6.0_18]
	at java.lang.reflect.Constructor.newInstance(Unknown Source) [na:1.6.0_18]
	at java.lang.Class.newInstance0(Unknown Source) [na:1.6.0_18]
	at java.lang.Class.newInstance(Unknown Source) [na:1.6.0_18]
	at org.eclipse.core.internal.registry.osgi.RegistryStrategyOSGI.createExecutableExtension(RegistryStrategyOSGI.java:184) [org.eclipse.equinox.registry_3.5.200.v20120522-1841.jar:na]
	at org.eclipse.core.internal.registry.ExtensionRegistry.createExecutableExtension(ExtensionRegistry.java:905) [org.eclipse.equinox.registry_3.5.200.v20120522-1841.jar:na]
	at org.eclipse.core.internal.registry.ConfigurationElement.createExecutableExtension(ConfigurationElement.java:243) [org.eclipse.equinox.registry_3.5.200.v20120522-1841.jar:na]
	at org.eclipse.core.internal.registry.ConfigurationElementHandle.createExecutableExtension(ConfigurationElementHandle.java:55) [org.eclipse.equinox.registry_3.5.200.v20120522-1841.jar:na]
	at org.eclipse.jdt.internal.ui.text.java.CompletionProposalComputerDescriptor.createComputer(CompletionProposalComputerDescriptor.java:308) [org.eclipse.jdt.ui_3.8.0.v20120524-1551.jar:na]
	at org.eclipse.jdt.internal.ui.text.java.CompletionProposalComputerDescriptor.getComputer(CompletionProposalComputerDescriptor.java:275) [org.eclipse.jdt.ui_3.8.0.v20120524-1551.jar:na]
	at org.eclipse.jdt.internal.ui.text.java.CompletionProposalComputerDescriptor.sessionStarted(CompletionProposalComputerDescriptor.java:418) [org.eclipse.jdt.ui_3.8.0.v20120524-1551.jar:na]
	at org.eclipse.jdt.internal.ui.text.java.CompletionProposalCategory.sessionStarted(CompletionProposalCategory.java:379) [org.eclipse.jdt.ui_3.8.0.v20120524-1551.jar:na]
	at org.eclipse.jdt.internal.ui.text.java.ContentAssistProcessor$CompletionListener.assistSessionStarted(ContentAssistProcessor.java:117) [org.eclipse.jdt.ui_3.8.0.v20120524-1551.jar:na]
	at org.eclipse.jface.text.contentassist.ContentAssistant.fireSessionBeginEvent(ContentAssistant.java:2221) [org.eclipse.jface.text_3.8.0.v20120531-0600.jar:na]
	at org.eclipse.jface.text.contentassist.ContentAssistant.prepareToShowCompletions(ContentAssistant.java:1696) [org.eclipse.jface.text_3.8.0.v20120531-0600.jar:na]
	at org.eclipse.jface.text.contentassist.ContentAssistant.access$6(ContentAssistant.java:1687) [org.eclipse.jface.text_3.8.0.v20120531-0600.jar:na]
	at org.eclipse.jface.text.contentassist.ContentAssistant$2.run(ContentAssistant.java:376) [org.eclipse.jface.text_3.8.0.v20120531-0600.jar:na]
	at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35) [org.eclipse.swt.win32.win32.x86_3.100.0.v4233d.jar:na]
	at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:135) [org.eclipse.swt.win32.win32.x86_3.100.0.v4233d.jar:na]
	at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:4144) [org.eclipse.swt.win32.win32.x86_3.100.0.v4233d.jar:na]
	at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3761) [org.eclipse.swt.win32.win32.x86_3.100.0.v4233d.jar:na]
	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1022) [org.eclipse.e4.ui.workbench.swt_0.10.1.v20120525-2014.jar:na]
	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) [org.eclipse.core.databinding.observable_1.4.1.v20120521-2329.jar:na]
	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:916) [org.eclipse.e4.ui.workbench.swt_0.10.1.v20120525-2014.jar:na]
	at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:86) [org.eclipse.e4.ui.workbench_0.10.2.v20120531-1742.jar:na]
	at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:585) [org.eclipse.ui.workbench_3.103.0.v20120530-1824.jar:na]
	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) [org.eclipse.core.databinding.observable_1.4.1.v20120521-2329.jar:na]
	at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:540) [org.eclipse.ui.workbench_3.103.0.v20120530-1824.jar:na]
	at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149) [org.eclipse.ui.workbench_3.103.0.v20120530-1824.jar:na]
	at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:124) [org.eclipse.ui.ide.application_1.0.400.v20120523-1955.jar:na]
	at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) [org.eclipse.equinox.app_1.3.100.v20120522-1841.jar:na]
	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110) [org.eclipse.osgi_3.8.0.v20120529-1548.jar:na]
	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79) [org.eclipse.osgi_3.8.0.v20120529-1548.jar:na]
	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:353) [org.eclipse.osgi_3.8.0.v20120529-1548.jar:na]
	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:180) [org.eclipse.osgi_3.8.0.v20120529-1548.jar:na]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.6.0_18]
	at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) ~[na:1.6.0_18]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) ~[na:1.6.0_18]
	at java.lang.reflect.Method.invoke(Unknown Source) ~[na:1.6.0_18]
	at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:629) [org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar:na]
	at org.eclipse.equinox.launcher.Main.basicRun(Main.java:584) [org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar:na]
	at org.eclipse.equinox.launcher.Main.run(Main.java:1438) [org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar:na]
2015-09-18 18:13:33,796 [Worker-4] WARN  o.e.r.i.rcp.repo.ModelRepository - 'remote-models (http://download.eclipse.org/recommenders/models/juno/, releases+snapshots)' did not send ETAG header for 'org.eclipse.recommenders:index:pom:0.0.0'.
2015-09-18 18:13:33,875 [Worker-4] ERROR o.e.r.i.r.repo.ModelRepositoryIndex - Failed to open search index.
org.apache.lucene.index.IndexNotFoundException: no segments* file found in org.apache.lucene.store.SimpleFSDirectory@E:\Orientacion a objetos\EclipsePortable\Data\workspace\.metadata\.plugins\org.eclipse.recommenders.rcp\index lockFactory=org.apache.lucene.store.NativeFSLockFactory@11218ad: files: []
	at org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(SegmentInfos.java:712) ~[org.apache.lucene.core_3.5.0.v20120319-2345.jar:3.5.0 1204988 - simon - 2011-11-22 14:46:51]
	at org.apache.lucene.index.DirectoryReader.open(DirectoryReader.java:75) ~[org.apache.lucene.core_3.5.0.v20120319-2345.jar:3.5.0 1204988 - simon - 2011-11-22 14:46:51]
	at org.apache.lucene.index.IndexReader.open(IndexReader.java:462) ~[org.apache.lucene.core_3.5.0.v20120319-2345.jar:3.5.0 1204988 - simon - 2011-11-22 14:46:51]
	at org.apache.lucene.index.IndexReader.open(IndexReader.java:308) ~[org.apache.lucene.core_3.5.0.v20120319-2345.jar:3.5.0 1204988 - simon - 2011-11-22 14:46:51]
	at org.eclipse.recommenders.internal.rcp.repo.ModelRepositoryIndex.open(ModelRepositoryIndex.java:64) ~[org.eclipse.recommenders.rcp_1.0.0.v20120612-2305-b156.jar:na]
	at org.eclipse.recommenders.internal.rcp.repo.UpdateModelIndexJob.run(UpdateModelIndexJob.java:55) [org.eclipse.recommenders.rcp_1.0.0.v20120612-2305-b156.jar:na]
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54) [org.eclipse.core.jobs_3.5.200.v20120521-2346.jar:na]
                                                                                                                                                                                                                                                                                                                                                     bers;
    if (!intact.length && (!webkit || !cm.display.currentWheelTarget))
      removeChildren(display.lineDiv);
    var container = display.lineDiv, cur = container.firstChild;

    function rm(node) {
      var next = node.nextSibling;
      if (webkit && mac && cm.display.currentWheelTarget == node) {
        node.style.display = "none";
        node.lineObj = null;
      } else {
        node.parentNode.removeChild(node);
      }
      return next;
    }

    var nextIntact = intact.shift(), lineN = from;
    cm.doc.iter(from, to, function(line) {
      if (nextIntact && nextIntact.to == lineN) nextIntact = intact.shift();
      if (lineIsHidden(cm.doc, line)) {
        if (line.height != 0) updateLineHeight(line, 0);
        if (line.widgets && cur.previousSibling) for (var i = 0; i < line.widgets.length; ++i) {
          var w = line.widgets[i];
          if (w.showIfHidden) {
            var prev = cur.previousSibling;
            if (/pre/i.test(prev.nodeName)) {
              var wrap = elt("div", null, null, "position: relative");
              prev.parentNode.replaceChild(wrap, prev);
              wrap.appendChild(prev);
              prev = wrap;
            }
            var wnode = prev.appendChild(elt("div", [w.node], "CodeMirror-linewidget"));
            if (!w.handleMouseEvents) wnode.ignoreEvents = true;
            positionLineWidget(w, wnode, prev, dims);
          }
        }
      } else if (nextIntact && nextIntact.from <= lineN && nextIntact.to > lineN) {
        // This line is intact. Skip to the actual node. Update its
        // line number if needed.
        while (cur.lineObj != line) cur = rm(cur);
        if (lineNumbers && updateNumbersFrom <= lineN && cur.lineNumber)
          setTextContent(cur.lineNumber, lineNumberFor(cm.options, lineN));
        cur = cur.nextSibling;
      } else {
        // For lines with widgets, make an attempt to find and reuse
        // the existing element, so that widgets aren't needlessly
        // removed and re-inserted into the dom
        if (line.widgets) for (var j = 0, search = cur, reuse; search && j < 20; ++j, search = search.nextSibling)
          if (search.lineObj == line && /div/i.test(search.nodeName)) { reuse = search; break; }
        // This line needs to be generated.
        var lineNode = buildLineElement(cm, line, lineN, dims, reuse);
        if (lineNode != reuse) {
          container.insertBefore(lineNode, cur);
        } else {
          while (cur != reuse) cur = rm(cur);
          cur = cur.nextSibling;
        }

        lineNode.lineObj = line;
      }
      ++lineN;
    });
    while (cur) cur = rm(cur);
  }

  function buildLineElement(cm, line, lineNo, dims, reuse) {
    var lineElement = lineContent(cm, line);
    var markers = line.gutterMarkers, display = cm.display, wrap;

    if (!cm.options.lineNumbers && !markers && !line.bgClass && !line.wrapClass && !line.widgets)
      return lineElement;

    // Lines with gutter elements, widgets or a background class need
    // to be wrapped again, and have the extra elements added to the
    // wrapper div

    if (reuse) {
      reuse.alignable = null;
      var isOk = true, widgetsSeen = 0, insertBefore = null;
      for (var n = reuse.firstChild, next; n; n = next) {
        next = n.nextSibling;
        if (!/\bCodeMirror-linewidget\b/.test(n.className)) {
          reuse.removeChild(n);
        } else {
          for (var i = 0; i < line.widgets.length; ++i) {
            var widget = line.widgets[i];
            if (widget.node == n.firstChild) {
              if (!widget.above && !insertBefore) insertBefore = n;
              positionLineWidget(widget, n, reuse, dims);
              ++widgetsSeen;
              break;
            }
          }
          if (i == line.widgets.length) { isOk = false; break; }
        }
      }
      reuse.insertBefore(lineElement, insertBefore);
      if (isOk && widgetsSeen == line.widgets.length) {
        wrap = reuse;
        reuse.className = line.wrapClass || "";
      }
    }
    if (!wrap) {
      wrap = elt("div", null, line.wrapClass, "position: relative");
      wrap.appendChild(lineElement);
    }
    // Kludge to make sure the styled element lies behind the selection (by z-index)
    if (line.bgClass)
      wrap.insertBefore(elt("div", null, line.bgClass + " CodeMirror-linebackground"), wrap.firstChild);
    if (cm.options.lineNumbers || markers) {
      var gutterWrap = wrap.insertBefore(elt("div", null, null, "position: absolute; left: " +
                                             (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + "px"),
                                         wrap.firstChild);
      if (cm.options.fixedGutter) (wrap.alignable || (wrap.alignable = [])).push(gutterWrap);
      if (cm.options.lineNumbers && (!markers || !markers["CodeMirror-linenumbers"]))
        wrap.lineNumber = gutterWrap.appendChild(
          elt("div", lineNumberFor(cm.options, lineNo),
              "CodeMirror-linenumber CodeMirror-gutter-elt",
              "left: " + dims.gutterLeft["CodeMirror-linenumbers"] + "px; width: "
              + display.lineNumInnerWidth + "px"));
      if (markers)
        for (var k = 0; k < cm.options.gutters.length; ++k) {
          var id = cm.options.gutters[k], found = markers.hasOwnProperty(id) && markers[id];
          if (found)
            gutterWrap.appendChild(elt("div", [found], "CodeMirror-gutter-elt", "left: " +
                                       dims.gutterLeft[id] + "px; width: " + dims.gutterWidth[id] + "px"));
        }
    }
    if (ie_lt8) wrap.style.zIndex = 2;
    if (line.widgets && wrap != reuse) for (var i = 0, ws = line.widgets; i < ws.length; ++i) {
      var widget = ws[i], node = elt("div", [widget.node], "CodeMirror-linewidget");
      if (!widget.handleMouseEvents) node.ignoreEvents = true;
      positionLineWidget(widget, node, wrap, dims);
      if (widget.above)
        wrap.insertBefore(node, cm.options.lineNumbers && line.height != 0 ? gutterWrap : lineElement);
      else
        wrap.appendChild(node);
      signalLater(widget, "redraw");
    }
    return wrap;
  }

  function positionLineWidget(widget, node, wrap, dims) {
    if (widget.noHScroll) {
      (wrap.alignable || (wrap.alignable = [])).push(node);
      var width = dims.wrapperWidth;
      node.style.left = dims.fixedPos + "px";
      if (!widget.coverGutter) {
        width -= dims.gutterTotalWidth;
        node.style.paddingLeft = dims.gutterTotalWidth + "px";
      }
      node.style.width = width + "px";
    }
    if (widget.coverGutter) {
      node.style.zIndex = 5;
      node.style.position = "relative";
      if (!widget.noHScroll) node.style.marginLeft = -dims.gutterTotalWidth + "px";
    }
  }

  // SELECTION / CURSOR

  function updateSelection(cm) {
    var display = cm.display;
    var collapsed = posEq(cm.doc.sel.from, cm.doc.sel.to);
    if (collapsed || cm.options.showCursorWhenSelecting)
      updateSelectionCursor(cm);
    else
      display.cursor.style.display = display.otherCursor.style.display = "none";
    if (!collapsed)
      updateSelectionRange(cm);
    else
      display.selectionDiv.style.display = "none";

    // Move the hidden textarea near the cursor to prevent scrolling artifacts
    if (cm.options.moveInputWithCursor) {
      var headPos = cursorCoords(cm, cm.doc.sel.head, "div");
      var wrapOff = getRect(display.wrapper), lineOff = getRect(display.lineDiv);
      display.inputDiv.style.top = Math.max(0, Math.min(display.wrapper.clientHeight - 10,
                                                        headPos.top + lineOff.top - wrapOff.top)) + "px";
      display.inputDiv.style.left = Math.max(0, Math.min(display.wrapper.clientWidth - 10,
                                                         headPos.left + lineOff.left - wrapOff.left)) + "px";
    }
  }

  // No selection, plain cursor
  function updateSelectionCursor(cm) {
    var display = cm.display, pos = cursorCoords(cm, cm.doc.sel.head, "div");
    display.cursor.style.left = pos.left + "px";
    display.cursor.style.top = pos.top + "px";
    display.cursor.style.height = Math.max(0, pos.bottom - pos.top) * cm.options.cursorHeight + "px";
    display.cursor.style.display = "";

    if (pos.other) {
      display.otherCursor.style.display = "";
      display.otherCursor.style.left = pos.other.left + "px";
      display.otherCursor.style.top = pos.other.top + "px";
      display.otherCursor.style.height = (pos.other.bottom - pos.other.top) * .85 + "px";
    } else { display.otherCursor.style.display = "none"; }
  }

  // Highlight selection
  function updateSelectionRange(cm) {
    var display = cm.display, doc = cm.doc, sel = cm.doc.sel;
    var fragment = document.createDocumentFragment();
    var clientWidth = display.lineSpace.offsetWidth, pl = paddingLeft(cm.display);

    function add(left, top, width, bottom) {
      if (top < 0) top = 0;
      fragment.appendChild(elt("div", null, "CodeMirror-selected", "position: absolute; left: " + left +
                               "px; top: " + top + "px; width: " + (width == null ? clientWidth - left : width) +
                               "px; height: " + (bottom - top) + "px"));
    }

    function drawForLine(line, fromArg, toArg) {
      var lineObj = getLine(doc, line);
      var lineLen = lineObj.text.length;
      var start, end;
      function coords(ch, bias) {
        return charCoords(cm, Pos(line, ch), "div", lineObj, bias);
      }

      iterateBidiSections(getOrder(lineObj), fromArg || 0, toArg == null ? lineLen : toArg, function(from, to, dir) {
        var leftPos = coords(from, "left"), rightPos, left, right;
        if (from == to) {
          rightPos = leftPos;
          left = right = leftPos.left;
        } else {
          rightPos = coords(to - 1, "right");
          if (dir == "rtl") { var tmp = leftPos; leftPos = rightPos; rightPos = tmp; }
          left = leftPos.left;
          right = rightPos.right;
        }
        if (fromArg == null && from == 0) left = pl;
        if (rightPos.top - leftPos.top > 3) { // Different lines, draw top part
          add(left, leftPos.top, null, leftPos.bottom);
          left = pl;
          if (leftPos.bottom < rightPos.top) add(left, leftPos.bottom, null, rightPos.top);
        }
        if (toArg == null && to == lineLen) right = clientWidth;
        if (!start || leftPos.top < start.top || leftPos.top == start.top && leftPos.left < start.left)
          start = leftPos;
        if (!end || rightPos.bottom > end.bottom || rightPos.bottom == end.bottom && rightPos.right > end.right)
          end = rightPos;
        if (left < pl + 1) left = pl;
        add(left, rightPos.top, right - left, rightPos.bottom);
      });
      return {start: start, end: end};
    }

    if (sel.from.line == sel.to.line) {
      drawForLine(sel.from.line, sel.from.ch, sel.to.ch);
    } else {
      var fromLine = getLine(doc, sel.from.line), toLine = getLine(doc, sel.to.line);
      var singleVLine = visualLine(doc, fromLine) == visualLine(doc, toLine);
      var leftEnd = drawForLine(sel.from.line, sel.from.ch, singleVLine ? fromLine.text.length : null).end;
      var rightStart = drawForLine(sel.to.line, singleVLine ? 0 : null, sel.to.ch).start;
      if (singleVLine) {
        if (leftEnd.top < rightStart.top - 2) {
          add(leftEnd.right, leftEnd.top, null, leftEnd.bottom);
          add(pl, rightStart.top, rightStart.left, rightStart.bottom);
        } else {
          add(leftEnd.right, leftEnd.top, rightStart.left - leftEnd.right, leftEnd.bottom);
        }
      }
      if (leftEnd.bottom < rightStart.top)
        add(pl, leftEnd.bottom, null, rightStart.top);
    }

    removeChildrenAndAdd(display.selectionDiv, fragment);
    display.selectionDiv.style.display = "";
  }

  // Cursor-blinking
  function restartBlink(cm) {
    if (!cm.state.focused) return;
    var display = cm.display;
    clearInterval(display.blinker);
    var on = true;
    display.cursor.style.visibility = display.otherCursor.style.visibility = "";
    display.blinker = setInterval(function() {
      display.cursor.style.visibility = display.otherCursor.style.visibility = (on = !on) ? "" : "hidden";
    }, cm.options.cursorBlinkRate);
  }

  // HIGHLIGHT WORKER

  function startWorker(cm, time) {
    if (cm.doc.mode.startState && cm.doc.frontier < cm.display.showingTo)
      cm.state.highlight.set(time, bind(highlightWorker, cm));
  }

  function highlightWorker(cm) {
    var doc = cm.doc;
    if (doc.frontier < doc.first) doc.frontier = doc.first;
    if (doc.frontier >= cm.display.showingTo) return;
    var end = +new Date + cm.options.workTime;
    var state = copyState(doc.mode, getStateBefore(cm, doc.frontier));
    var changed = [], prevChange;
    doc.iter(doc.frontier, Math.min(doc.first + doc.size, cm.display.showingTo + 500), function(line) {
      if (doc.frontier >= cm.display.showingFrom) { // Visible
        var oldStyles = line.styles;
        line.styles = highlightLine(cm, line, state);
        var ischange = !oldStyles || oldStyles.length != line.styles.length;
        for (var i = 0; !ischange && i < oldStyles.length; ++i) ischange = oldStyles[i] != line.styles[i];
        if (ischange) {
          if (prevChange && prevChange.end == doc.frontier) prevChange.end++;
          else changed.push(prevChange = {start: doc.frontier, end: doc.frontier + 1});
        }
        line.stateAfter = copyState(doc.mode, state);
      } else {
        processLine(cm, line, state);
        line.stateAfter = doc.frontier % 5 == 0 ? copyState(doc.mode, state) : null;
      }
      ++doc.frontier;
      if (+new Date > end) {
        startWorker(cm, cm.options.workDelay);
        return true;
      }
    });
    if (changed.length)
      operation(cm, function() {
        for (var i = 0; i < changed.length; ++i)
          regChange(this, changed[i].start, changed[i].end);
      })();
  }

  // Finds the line to start with when starting a parse. Tries to
  // find a line with a stateAfter, so that it can start with a
  // valid state. If that fails, it returns the line with the
  // smallest indentation, which tends to need the least context to
  // parse correctly.
  function findStartLine(cm, n, precise) {
    var minindent, minline, doc = cm.doc;
    for (var search = n, lim = n - 100; search > lim; --search) {
      if (search <= doc.first) return doc.first;
      var line = getLine(doc, search - 1);
      if (line.stateAfter && (!precise || search <= doc.frontier)) return search;
      var indented = countColumn(line.text, null, cm.options.tabSize);
      if (minline == null || minindent > indented) {
        minline = search - 1;
        minindent = indented;
      }
    }
    return minline;
  }

  function getStateBefore(cm, n, precise) {
    var doc = cm.doc, display = cm.display;
      if (!doc.mode.startState) return true;
    var pos = findStartLine(cm, n, precise), state = pos > doc.first && getLine(doc, pos-1).stateAfter;
    if (!state) state = startState(doc.mode);
    else state = copyState(doc.mode, state);
    doc.iter(pos, n, function(line) {
      processLine(cm, line, state);
      var save = pos == n - 1 || pos % 5 == 0 || pos >= display.showingFrom && pos < display.showingTo;
      line.stateAfter = save ? copyState(doc.mode, state) : null;
      ++pos;
    });
    return state;
  }

  // POSITION MEASUREMENT

  function paddingTop(display) {return display.lineSpace.offsetTop;}
  function paddingVert(display) {return display.mover.offsetHeight - display.lineSpace.offsetHeight;}
  function paddingLeft(display) {
    var e = removeChildrenAndAdd(display.measure, elt("pre", null, null, "text-align: left")).appendChild(elt("span", "x"));
    return e.offsetLeft;
  }

  function measureChar(cm, line, ch, data, bias) {
    var dir = -1;
    data = data || measureLine(cm, line);

    for (var pos = ch;; pos += dir) {
      var r = data[pos];
      if (r) break;
      if (dir < 0 && pos == 0) dir = 1;
    }
    bias = pos > ch ? "left" : pos < ch ? "right" : bias;
    if (bias == "left" && r.leftSide) r = r.leftSide;
    else if (bias == "right" && r.rightSide) r = r.rightSide;
    return {left: pos < ch ? r.right : r.left,
            right: pos > ch ? r.left : r.right,
            top: r.top,
            bottom: r.bottom};
  }

  function findCachedMeasurement(cm, line) {
    var cache = cm.display.measureLineCache;
    for (var i = 0; i < cache.length; ++i) {
      var memo = cache[i];
      if (memo.text == line.text && memo.markedSpans == line.markedSpans &&
          cm.display.scroller.clientWidth == memo.width &&
          memo.classes == line.textClass + "|" + line.bgClass + "|" + line.wrapClass)
        return memo;
    }
  }

  function clearCachedMeasurement(cm, line) {
    var exists = findCachedMeasurement(cm, line);
    if (exists) exists.text = exists.measure = exists.markedSpans = null;
  }

  function measureLine(cm, line) {
    // First look in the cache
    var cached = findCachedMeasurement(cm, line);
    if (cached) return cached.measure;

    // Failing that, recompute and store result in cache
    var measure = measureLineInner(cm, line);
    var cache = cm.display.measureLineCache;
    var memo = {text: line.text, width: cm.display.scroller.clientWidth,
                markedSpans: line.markedSpans, measure: measure,
                classes: line.textClass + "|" + line.bgClass + "|" + line.wrapClass};
    if (cache.length == 16) cache[++cm.display.measureLineCachePos % 16] = memo;
    else cache.push(memo);
    return measure;
  }

  function measureLineInner(cm, line) {
    var display = cm.display, measure = emptyArray(line.text.length);
    var pre = lineContent(cm, line, measure, true);

    // IE does not cache element positions of inline elements between
    // calls to getBoundingClientRect. This makes the loop below,
    // which gathers the positions of all the characters on the line,
    // do an amount of layout work quadratic to the number of
    // characters. When line wrapping is off, we try to improve things
    // by first subdividing the line into a bunch of inline blocks, so
    // that IE can reuse most of the layout information from caches
    // for those blocks. This does interfere with line wrapping, so it
    // doesn't work when wrapping is on, but in that case the
    // situation is slightly better, since IE does cache line-wrapping
    // information and only recomputes per-line.
    if (ie && !ie_lt8 && !cm.options.lineWrapping && pre.childNodes.length > 100) {
      var fragment = document.createDocumentFragment();
      var chunk = 10, n = pre.childNodes.length;
      for (var i = 0, chunks = Math.ceil(n / chunk); i < chunks; ++i) {
        var wrap = elt("div", null, null, "display: inline-block");
        for (var j = 0; j < chunk && n; ++j) {
          wrap.appendChild(pre.firstChild);
          --n;
        }
        fragment.appendChild(wrap);
      }
      pre.appendChild(fragment);
    }

    removeChildrenAndAdd(display.measure, pre);

    var outer = getRect(display.lineDiv);
    var vranges = [], data = emptyArray(line.text.length), maxBot = pre.offsetHeight;
    // Work around an IE7/8 bug where it will sometimes have randomly
    // replaced our pre with a clone at this point.
    if (ie_lt9 && display.measure.first != pre)
      removeChildrenAndAdd(display.measure, pre);

    function measureRect(rect) {
      var top = rect.top - outer.top, bot = rect.bottom - outer.top;
      if (bot > maxBot) bot = maxBot;
      if (top < 0) top = 0;
      for (var i = vranges.length - 2; i >= 0; i -= 2) {
        var rtop = vranges[i], rbot = vranges[i+1];
        if (rtop > bot || rbot < top) continue;
        if (rtop <= top && rbot >= bot ||
            top <= rtop && bot >= rbot ||
            Math.min(bot, rbot) - Math.max(top, rtop) >= (bot - top) >> 1) {
          vranges[i] = Math.min(top, rtop);
          vranges[i+1] = Math.max(bot, rbot);
          break;
        }
      }
      if (i < 0) { i = vranges.length; vranges.push(top, bot); }
      return {left: rect.left - outer.left,
              right: rect.right - outer.left,
              top: i, bottom: null};
    }
    function finishRect(rect) {
      rect.bottom = vranges[rect.top+1];
      rect.top = vranges[rect.top];
    }

    for (var i = 0, cur; i < measure.length; ++i) if (cur = measure[i]) {
      var node = cur, rect = null;
      // A widget might wrap, needs special care
      if (/\bCodeMirror-widget\b/.test(cur.className) && cur.getClientRects) {
        if (cur.firstChild.nodeType == 1) node = cur.firstChild;
        var rects = node.getClientRects();
        if (rects.length > 1) {
          rect = data[i] = measureRect(rects[0]);
          rect.rightSide = measureRect(rects[rects.length - 1]);
        }
      }
      if (!rect) rect = data[i] = measureRect(getRect(node));
      if (cur.measureRight) rect.right = getRect(cur.measureRight).left;
      if (cur.leftSide) rect.leftSide = measureRect(getRect(cur.leftSide));
    }
    for (var i = 0, cur; i < data.length; ++i) if (cur = data[i]) {
      finishRect(cur);
      if (cur.leftSide) finishRect(cur.leftSide);
      if (cur.rightSide) finishRect(cur.rightSide);
    }
    return data;
  }

  function measureLineWidth(cm, line) {
    var hasBadSpan = false;
    if (line.markedSpans) for (var i = 0; i < line.markedSpans; ++i) {
      var sp = line.markedSpans[i];
      if (sp.collapsed && (sp.to == null || sp.to == line.text.length)) hasBadSpan = true;
    }
    var cached = !hasBadSpan && findCachedMeasurement(cm, line);
    if (cached) return measureChar(cm, line, line.text.length, cached.measure, "right").right;

    var pre = lineContent(cm, line, null, true);
    var end = pre.appendChild(zeroWidthElement(cm.display.measure));
    removeChildrenAndAdd(cm.display.measure, pre);
    return getRect(end).right - getRect(cm.display.lineDiv).left;
  }

  function clearCaches(cm) {
    cm.display.measureLineCache.length = cm.display.measureLineCachePos = 0;
    cm.display.cachedCharWidth = cm.display.cachedTextHeight = null;
    if (!cm.options.lineWrapping) cm.display.maxLineChanged = true;
    cm.display.lineNumChars = null;
  }

  function pageScrollX() { return window.pageXOffset || (document.documentElement || document.body).scrollLeft; }
  function pageScrollY() { return window.pageYOffset || (document.documentElement || document.body).scrollTop; }

  // Context is one of "line", "div" (display.lineDiv), "local"/null (editor), or "page"
  function intoCoordSystem(cm, lineObj, rect, context) {
    if (lineObj.widgets) for (var i = 0; i < lineObj.widgets.length; ++i) if (lineObj.widgets[i].above) {
      var size = widgetHeight(lineObj.widgets[i]);
      rect.top += size; rect.bottom += size;
    }
    if (context == "line") return rect;
    if (!context) context = "local";
    var yOff = heightAtLine(cm, lineObj);
    if (context == "local") yOff += paddingTop(cm.display);
    else yOff -= cm.display.viewOffset;
    if (context == "page" || context == "window") {
      var lOff = getRect(cm.display.lineSpace);
      yOff += lOff.top + (context == "window" ? 0 : pageScrollY());
      var xOff = lOff.left + (context == "window" ? 0 : pageScrollX());
      rect.left += xOff; rect.right += xOff;
    }
    rect.top += yOff; rect.bottom += yOff;
    return rect;
  }

  // Context may be "window", "page", "div", or "local"/null
  // Result is in "div" coords
  function fromCoordSystem(cm, coords, context) {
    if (context == "div") return coords;
    var left = coords.left, top = coords.top;
    // First move into "page" coordinate system
    if (context == "page") {
      left -= pageScrollX();
      top -= pageScrollY();
    } else if (context == "local" || !context) {
      var localBox = getRect(cm.display.sizer);
      left += localBox.left;
      top += localBox.top;
    }

    var lineSpaceBox = getRect(cm.display.lineSpace);
    return {left: left - lineSpaceBox.left, top: top - lineSpaceBox.top};
  }

  function charCoords(cm, pos, context, lineObj, bias) {
    if (!lineObj) lineObj = getLine(cm.doc, pos.line);
    return intoCoordSystem(cm, lineObj, measureChar(cm, lineObj, pos.ch, null, bias), context);
  }

  function cursorCoords(cm, pos, context, lineObj, measurement) {
    lineObj = lineObj || getLine(cm.doc, pos.line);
    if (!measurement) measurement = measureLine(cm, lineObj);
    function get(ch, right) {
      var m = measureChar(cm, lineObj, ch, measurement, right ? "right" : "left");
      if (right) m.left = m.right; else m.right = m.left;
      return intoCoordSystem(cm, lineObj, m, context);
    }
    function getBidi(ch, partPos) {
      var part = order[partPos], right = part.level % 2;
      if (ch == bidiLeft(part) && partPos && part.level < order[partPos - 1].level) {
        part = order[--partPos];
        ch = bidiRight(part) - (part.level % 2 ? 0 : 1);
        right = true;
      } else if (ch == bidiRight(part) && partPos < order.length - 1 && part.level < order[partPos + 1].level) {
        part = order[++partPos];
        ch = bidiLeft(part) - part.level % 2;
        right = false;
      }
      if (right && ch == part.to && ch > part.from) return get(ch - 1);
      return get(ch, right);
    }
    var order = getOrder(lineObj), ch = pos.ch;
    if (!order) return get(ch);
    var partPos = getBidiPartAt(order, ch);
    var val = getBidi(ch, partPos);
    if (bidiOther != null) val.other = getBidi(ch, bidiOther);
    return val;
  }

  function PosWithInfo(line, ch, outside, xRel) {
    var pos = new Pos(line, ch);
    pos.xRel = xRel;
    if (outside) pos.outside = true;
    return pos;
  }

  // Coords must be lineSpace-local
  function coordsChar(cm, x, y) {
    var doc = cm.doc;
    y += cm.display.viewOffset;
    if (y < 0) return PosWithInfo(doc.first, 0, true, -1);
    var lineNo = lineAtHeight(doc, y), last = doc.first + doc.size - 1;
    if (lineNo > last)
      return PosWithInfo(doc.first + doc.size - 1, getLine(doc, last).text.length, true, 1);
    if (x < 0) x = 0;

    for (;;) {
      var lineObj = getLine(doc, lineNo);
      var found = coordsCharInner(cm, lineObj, lineNo, x, y);
      var merged = collapsedSpanAtEnd(lineObj);
      var mergedPos = merged && merged.find();
      if (merged && (found.ch > mergedPos.from.ch || found.ch == mergedPos.from.ch && found.xRel > 0))
        lineNo = mergedPos.to.line;
      else
        return found;
    }
  }

  function coordsCharInner(cm, lineObj, lineNo, x, y) {
    var innerOff = y - heightAtLine(cm, lineObj);
    var wrongLine = false, adjust = 2 * cm.display.wrapper.clientWidth;
    var measurement = measureLine(cm, lineObj);

    function getX(ch) {
      var sp = cursorCoords(cm, Pos(lineNo, ch), "line",
                            lineObj, measurement);
      wrongLine = true;
      if (innerOff > sp.bottom) return sp.left - adjust;
      else if (innerOff < sp.top) return sp.left + adjust;
      else wrongLine = false;
      return sp.left;
    }

    var bidi = getOrder(lineObj), dist = lineObj.text.length;
    var from = lineLeft(lineObj), to = lineRight(lineObj);
    var fromX = getX(from), fromOutside = wrongLine, toX = getX(to), toOutside = wrongLine;

    if (x > toX) return PosWithInfo(lineNo, to, toOutside, 1);
    // Do a binary search between these bounds.
    for (;;) {
      if (bidi ? to == from || to == moveVisually(lineObj, from, 1) : to - from <= 1) {
        var ch = x < fromX || x - fromX <= toX - x ? from : to;
        var xDiff = x - (ch == from ? fromX : toX);
        while (isExtendingChar.test(lineObj.text.charAt(ch))) ++ch;
        var pos = PosWithInfo(lineNo, ch, ch == from ? fromOutside : toOutside,
                              xDiff < 0 ? -1 : xDiff ? 1 : 0);
        return pos;
      }
      var step = Math.ceil(dist / 2), middle = from + step;
      if (bidi) {
        middle = from;
        for (var i = 0; i < step; ++i) middle = moveVisually(lineObj, middle, 1);
      }
      var middleX = getX(middle);
      if (middleX > x) {to = middle; toX = middleX; if (toOutside = wrongLine) toX += 1000; dist = step;}
      else {from = middle; fromX = middleX; fromOutside = wrongLine; dist -= step;}
    }
  }

  var measureText;
  function textHeight(display) {
    if (display.cachedTextHeight != null) return display.cachedTextHeight;
    if (measureText == null) {
      measureText = elt("pre");
      // Measure a bunch of lines, for browsers that compute
      // fractional heights.
      for (var i = 0; i < 49; ++i) {
        measureText.appendChild(document.createTextNode("x"));
        measureText.appendChild(elt("br"));
      }
      measureText.appendChild(document.createTextNode("x"));
    }
    removeChildrenAndAdd(display.measure, measureText);
    var height = measureText.offsetHeight / 50;
    if (height > 3) display.cachedTextHeight = height;
    removeChildren(display.measure);
    return height || 1;
  }

  function charWidth(display) {
    if (display.cachedCharWidth != null) return display.cachedCharWidth;
    var anchor = elt("span", "x");
    var pre = elt("pre", [anchor]);
    removeChildrenAndAdd(display.measure, pre);
    var width = anchor.offsetWidth;
    if (width > 2) display.cachedCharWidth = width;
    return width || 10;
  }

  // OPERATIONS

  // Operations are used to wrap changes in such a way that each
  // change won't have to update the cursor and display (which would
  // be awkward, slow, and error-prone), but instead updates are
  // batched and then all combined and executed at once.

  var nextOpId = 0;
  function startOperation(cm) {
    cm.curOp = {
      // An array of ranges of lines that have to be updated. See
      // updateDisplay.
      changes: [],
      forceUpdate: false,
      updateInput: null,
      userSelChange: null,
      textChanged: null,
      selectionChanged: false,
      cursorActivity: false,
      updateMaxLine: false,
      updateScrollPos: false,
      id: ++nextOpId
    };
    if (!delayedCallbackDepth++) delayedCallbacks = [];
  }

  function endOperation(cm) {
    var op = cm.curOp, doc = cm.doc, display = cm.display;
    cm.curOp = null;

    if (op.updateMaxLine) computeMaxLength(cm);
    if (display.maxLineChanged && !cm.options.lineWrapping && display.maxLine) {
      var width = measureLineWidth(cm, display.maxLine);
      display.sizer.style.minWidth = Math.max(0, width + 3 + scrollerCutOff) + "px";
      display.maxLineChanged = false;
      var maxScrollLeft = Math.max(0, display.sizer.offsetLeft + display.sizer.offsetWidth - display.scroller.clientWidth);
      if (maxScrollLeft < doc.scrollLeft && !op.updateScrollPos)
        setScrollLeft(cm, Math.min(display.scroller.scrollLeft, maxScrollLeft), true);
    }
    var newScrollPos, updated;
    if (op.updateScrollPos) {
      newScrollPos = op.updateScrollPos;
    } else if (op.selectionChanged && display.scroller.clientHeight) { // don't rescroll if not visible
      var coords = cursorCoords(cm, doc.sel.head);
      newScrollPos = calculateScrollPos(cm, coords.left, coords.top, coords.left, coords.bottom);
    }
    if (op.changes.length || op.forceUpdate || newScrollPos && newScrollPos.scrollTop != null) {
      updated = updateDisplay(cm, op.changes, newScrollPos && newScrollPos.scrollTop, op.forceUpdate);
      if (cm.display.scroller.offsetHeight) cm.doc.scrollTop = cm.display.scroller.scrollTop;
    }
    if (!updated && op.selectionChanged) updateSelection(cm);
    if (op.updateScrollPos) {
      display.scroller.scrollTop = display.scrollbarV.scrollTop = doc.scrollTop = newScrollPos.scrollTop;
      display.scroller.scrollLeft = display.scrollbarH.scrollLeft = doc.scrollLeft = newScrollPos.scrollLeft;
      alignHorizontally(cm);
      if (op.scrollToPos)
        scrollPosIntoView(cm, clipPos(cm.doc, op.scrollToPos), op.scrollToPosMargin);
    } else if (newScrollPos) {
      scrollCursorIntoView(cm);
    }
    if (op.selectionChanged) restartBlink(cm);

    if (cm.state.focused && op.updateInput)
      resetInput(cm, op.userSelChange);

    var hidden = op.maybeHiddenMarkers, unhidden = op.maybeUnhiddenMarkers;
    if (hidden) for (var i = 0; i < hidden.length; ++i)
      if (!hidden[i].lines.length) signal(hidden[i], "hide");
    if (unhidden) for (var i = 0; i < unhidden.length; ++i)
      if (unhidden[i].lines.length) signal(unhidden[i], "unhide");

    var delayed;
    if (!--delayedCallbackDepth) {
      delayed = delayedCallbacks;
      delayedCallbacks = null;
    }
    if (op.textChanged)
      signal(cm, "change", cm, op.textChanged);
    if (op.cursorActivity) signal(cm, "cursorActivity", cm);
    if (delayed) for (var i = 0; i < delayed.length; ++i) delayed[i]();
  }

  // Wraps a function in an operation. Returns the wrapped function.
  function operation(cm1, f) {
    return function() {
      var cm = cm1 || this, withOp = !cm.curOp;
      if (withOp) startOperation(cm);
      try { var result = f.apply(cm, arguments); }
      finally { if (withOp) endOperation(cm); }
      return result;
    };
  }
  function docOperation(f) {
    return function() {
      var withOp = this.cm && !this.cm.curOp, result;
      if (withOp) startOperation(this.cm);
      try { result = f.apply(this, arguments); }
      finally { if (withOp) endOperation(this.cm); }
      return result;
    };
  }
  function runInOp(cm, f) {
    var withOp = !cm.curOp, result;
    if (withOp) startOperation(cm);
    try { result = f(); }
    finally { if (withOp) endOperation(cm); }
    return result;
  }

  function regChange(cm, from, to, lendiff) {
    if (from == null) from = cm.doc.first;
    if (to == null) to = cm.doc.first + cm.doc.size;
    cm.curOp.changes.push({from: from, to: to, diff: lendiff});
  }

  // INPUT HANDLING

  function slowPoll(cm) {
    if (cm.display.pollingFast) return;
    cm.display.poll.set(cm.options.pollInterval, function() {
      readInput(cm);
      if (cm.state.focused) slowPoll(cm);
    });
  }

  function fastPoll(cm) {
    var missed = false;
    cm.display.pollingFast = true;
    function p() {
      var changed = readInput(cm);
      if (!changed && !missed) {missed = true; cm.display.poll.set(60, p);}
      else {cm.display.pollingFast = false; slowPoll(cm);}
    }
    cm.display.poll.set(20, p);
  }

  // prevInput is a hack to work with IME. If we reset the textarea
  // on every change, that breaks IME. So we look for changes
  // compared to the previous content instead. (Modern browsers have
  // events that indicate IME taking place, but these are not widely
  // supported or compatible enough yet to rely on.)
  function readInput(cm) {
    var input = cm.display.input, prevInput = cm.display.prevInput, doc = cm.doc, sel = doc.sel;
    if (!cm.state.focused || hasSelection(input) || isReadOnly(cm) || cm.state.disableInput) return false;
    var text = input.value;
    if (text == prevInput && posEq(sel.from, sel.to)) return false;
    if (ie && !ie_lt9 && cm.display.inputHasSelection === text) {
      resetInput(cm, true);
      return false;
    }

    var withOp = !cm.curOp;
    if (withOp) startOperation(cm);
    sel.shift = false;
    var same = 0, l = Math.min(prevInput.length, text.length);
    while (same < l && prevInput.charCodeAt(same) == text.charCodeAt(same)) ++same;
    var from = sel.from, to = sel.to;
    if (same < prevInput.length)
      from = Pos(from.line, from.ch - (prevInput.length - same));
    else if (cm.state.overwrite && posEq(from, to) && !cm.state.pasteIncoming)
      to = Pos(to.line, Math.min(getLine(doc, to.line).text.length, to.ch + (text.length - same)));

    var updateInput = cm.curOp.updateInput;
    var changeEvent = {from: from, to: to, text: splitLines(text.slice(same)),
                       origin: cm.state.pasteIncoming ? "paste" : "+input"};
    makeChange(cm.doc, changeEvent, "end");
    cm.curOp.updateInput = updateInput;
    signalLater(cm, "inputRead", cm, changeEvent);

    if (text.length > 1000 || text.indexOf("\n") > -1) input.value = cm.display.prevInput = "";
    else cm.display.prevInput = text;
    if (withOp) endOperation(cm);
    cm.state.pasteIncoming = false;
    return true;
  }

  function resetInput(cm, user) {
    var minimal, selected, doc = cm.doc;
    if (!posEq(doc.sel.from, doc.sel.to)) {
      cm.display.prevInput = "";
      minimal = hasCopyEvent &&
        (doc.sel.to.line - doc.sel.from.line > 100 || (selected = cm.getSelection()).length > 1000);
      var content = minimal ? "-" : selected || cm.getSelection();
      cm.display.input.value = content;
      if (cm.state.focused) selectInput(cm.display.input);
      if (ie && !ie_lt9) cm.display.inputHasSelection = content;
    } else if (user) {
      cm.display.prevInput = cm.display.input.value = "";
      if (ie && !ie_lt9) cm.display.inputHasSelection = null;
    }
    cm.display.inaccurateSelection = minimal;
  }

  function focusInput(cm) {
    if (cm.options.readOnly != "nocursor" && (!mobile || document.activeElement != cm.display.input))
      cm.display.input.focus();
  }

  function isReadOnly(cm) {
    return cm.options.readOnly || cm.doc.cantEdit;
  }

  // EVENT HANDLERS

  function registerEventHandlers(cm) {
    var d = cm.display;
    on(d.scroller, "mousedown", operation(cm, onMouseDown));
    if (ie)
      on(d.scroller, "dblclick", operation(cm, function(e) {
        if (signalDOMEvent(cm, e)) return;
        var pos = posFromMouse(cm, e);
        if (!pos || clickInGutter(cm, e) || eventInWidget(cm.display, e)) return;
        e_preventDefault(e);
        var word = findWordAt(getLine(cm.doc, pos.line).text, pos);
        extendSelection(cm.doc, word.from, word.to);
      }));
    else
      on(d.scroller, "dblclick", function(e) { signalDOMEvent(cm, e) || e_preventDefault(e); });
    on(d.lineSpace, "selectstart", function(e) {
      if (!eventInWidget(d, e)) e_preventDefault(e);
    });
    // Gecko browsers fire contextmenu *after* opening the menu, at
    // which point we can't mess with it anymore. Context menu is
    // handled in onMouseDown for Gecko.
    if (!captureMiddleClick) on(d.scroller, "contextmenu", function(e) {onContextMenu(cm, e);});

    on(d.scroller, "scroll", function() {
      if (d.scroller.clientHeight) {
        setScrollTop(cm, d.scroller.scrollTop);
        setScrollLeft(cm, d.scroller.scrollLeft, true);
        signal(cm, "scroll", cm);
      }
    });
    on(d.scrollbarV, "scroll", function() {
      if (d.scroller.clientHeight) setScrollTop(cm, d.scrollbarV.scrollTop);
    });
    on(d.scrollbarH, "scroll", function() {
      if (d.scroller.clientHeight) setScrollLeft(cm, d.scrollbarH.scrollLeft);
    });

    on(d.scroller, "mousewheel", function(e){onScrollWheel(cm, e);});
    on(d.scroller, "DOMMouseScroll", function(e){onScrollWheel(cm, e);});

    function reFocus() { if (cm.state.focused) setTimeout(bind(focusInput, cm), 0); }
    on(d.scrollbarH, "mousedown", reFocus);
    on(d.scrollbarV, "mousedown", reFocus);
    // Prevent wrapper from ever scrolling
    on(d.wrapper, "scroll", function() { d.wrapper.scrollTop = d.wrapper.scrollLeft = 0; });

    var resizeTimer;
    function onResize() {
      if (resizeTimer == null) resizeTimer = setTimeout(function() {
        resizeTimer = null;
        // Might be a text scaling operation, clear size caches.
        d.cachedCharWidth = d.cachedTextHeight = knownScrollbarWidth = null;
        clearCaches(cm);
        runInOp(cm, bind(regChange, cm));
      }, 100);
    }
    on(window, "resize", onResize);
    // Above handler holds on to the editor and its data structures.
    // Here we poll to unregister it when the editor is no longer in
    // the document, so that it can be garbage-collected.
    function unregister() {
      for (var p = d.wrapper.parentNode; p && p != document.body; p = p.parentNode) {}
      if (p) setTimeout(unregister, 5000);
      else off(window, "resize", onResize);
    }
    setTimeout(unregister, 5000);

    on(d.input, "keyup", operation(cm, function(e) {
      if (signalDOMEvent(cm, e) || cm.options.onKeyEvent && cm.options.onKeyEvent(cm, addStop(e))) return;
      if (e.keyCode == 16) cm.doc.sel.shift = false;
    }));
    on(d.input, "input", bind(fastPoll, cm));
    on(d.input, "keydown", operation(cm, onKeyDown));
    on(d.input, "keypress", operation(cm, onKeyPress));
    on(d.input, "focus", bind(onFocus, cm));
    on(d.input, "blur", bind(onBlur, cm));

    function drag_(e) {
      if (signalDOMEvent(cm, e) || cm.options.onDragEvent && cm.options.onDragEvent(cm, addStop(e))) return;
      e_stop(e);
    }
    if (cm.options.dragDrop) {
      on(d.scroller, "dragstart", function(e){onDragStart(cm, e);});
      on(d.scroller, "dragenter", drag_);
      on(d.scroller, "dragover", drag_);
      on(d.scroller, "drop", operation(cm, onDrop));
    }
    on(d.scroller, "paste", function(e){
      if (eventInWidget(d, e)) return;
      focusInput(cm);
      fastPoll(cm);
    });
    on(d.input, "paste", function() {
      cm.state.pasteIncoming = true;
      fastPoll(cm);
    });

    function prepareCopy() {
      if (d.inaccurateSelection) {
        d.prevInput = "";
        d.inaccurateSelection = false;
        d.input.value = cm.getSelection();
        selectInput(d.input);
      }
    }
    on(d.input, "cut", prepareCopy);
    on(d.input, "copy", prepareCopy);

    // Needed to handle Tab key in KHTML
    if (khtml) on(d.sizer, "mouseup", function() {
        if (document.activeElement == d.input) d.input.blur();
        focusInput(cm);
    });
  }

  function eventInWidget(display, e) {
    for (var n = e_target(e); n != display.wrapper; n = n.parentNode) {
      if (!n || n.ignoreEvents || n.parentNode == display.sizer && n != display.mover) return true;
    }
  }

  function posFromMouse(cm, e, liberal) {
    var display = cm.display;
    if (!liberal) {
      var target = e_target(e);
      if (target == display.scrollbarH || target == display.scrollbarH.firstChild ||
          target == display.scrollbarV || target == display.scrollbarV.firstChild ||
          target == display.scrollbarFiller || target == display.gutterFiller) return null;
    }
    var x, y, space = getRect(display.lineSpace);
    // Fails unpredictably on IE[67] when mouse is dragged around quickly.
    try { x = e.clientX; y = e.clientY; } catch (e) { return null; }
    return coordsChar(cm, x - space.left, y - space.top);
  }

  var lastClick, lastDoubleClick;
  function onMouseDown(e) {
    if (signalDOMEvent(this, e)) return;
    var cm = this, display = cm.display, doc = cm.doc, sel = doc.sel;
    sel.shift = e.shiftKey;

    if (eventInWidget(display, e)) {
      if (!webkit) {
        display.scroller.draggable = false;
        setTimeout(function(){display.scroller.draggable = true;}, 100);
      }
      return;
    }
    if (clickInGutter(cm, e)) return;
    var start = posFromMouse(cm, e);

    switch (e_button(e)) {
    case 3:
      if (captureMiddleClick) onContextMenu.call(cm, cm, e);
      return;
    case 2:
      if (start) extendSelection(cm.doc, start);
      setTimeout(bind(focusInput, cm), 20);
      e_preventDefault(e);
      return;
    }
    // For button 1, if it was clicked inside the editor
    // (posFromMouse returning non-null), we have to adjust the
    // selection.
    if (!start) {if (e_target(e) == display.scroller) e_preventDefault(e); return;}

    if (!cm.state.focused) onFocus(cm);

    var now = +new Date, type = "single";
    if (lastDoubleClick && lastDoubleClick.time > now - 400 && posEq(lastDoubleClick.pos, start)) {
      type = "triple";
      e_preventDefault(e);
      setTimeout(bind(focusInput, cm), 20);
      selectLine(cm, start.line);
    } else if (lastClick && lastClick.time > now - 400 && posEq(lastClick.pos, start)) {
      type = "double";
      lastDoubleClick = {time: now, pos: start};
      e_preventDefault(e);
      var word = findWordAt(getLine(doc, start.line).text, start);
      extendSelection(cm.doc, word.from, word.to);
    } else { lastClick = {time: now, pos: start}; }

    var last = start;
    if (cm.options.dragDrop && dragAndDrop && !isReadOnly(cm) && !posEq(sel.from, sel.to) &&
        !posLess(start, sel.from) && !posLess(sel.to, start) && type == "single") {
      var dragEnd = operation(cm, function(e2) {
        if (webkit) display.scroller.draggable = false;
        cm.state.draggingText = false;
        off(document, "mouseup", dragEnd);
        off(display.scroller, "drop", dragEnd);
        if (Math.abs(e.clientX - e2.clientX) + Math.abs(e.clientY - e2.clientY) < 10) {
          e_preventDefault(e2);
          extendSelection(cm.doc, start);
          focusInput(cm);
        }
      });
      // Let the drag handler handle this.
      if (webkit) display.scroller.draggable = true;
      cm.state.draggingText = dragEnd;
      // IE's approach to draggable
      if (display.scroller.dragDrop) display.scroller.dragDrop();
      on(document, "mouseup", dragEnd);
      on(display.scroller, "drop", dragEnd);
      return;
    }
    e_preventDefault(e);
    if (type == "single") extendSelection(cm.doc, clipPos(doc, start));

    var startstart = sel.from, startend = sel.to, lastPos = start;

    function doSelect(cur) {
      if (posEq(lastPos, cur)) return;
      lastPos = cur;

      if (type == "single") {
        extendSelection(cm.doc, clipPos(doc, start), cur);
        return;
      }

      startstart = clipPos(doc, startstart);
      startend = clipPos(doc, startend);
      if (type == "double") {
        var word = findWordAt(getLine(doc, cur.line).text, cur);
        if (posLess(cur, startstart)) extendSelection(cm.doc, word.from, startend);
        else extendSelection(cm.doc, startstart, word.to);
      } else if (type == "triple") {
        if (posLess(cur, startstart)) extendSelection(cm.doc, startend, clipPos(doc, Pos(cur.line, 0)));
        else extendSelection(cm.doc, startstart, clipPos(doc, Pos(cur.line + 1, 0)));
      }
    }

    var editorSize = getRect(display.wrapper);
    // Used to ensure timeout re-tries don't fire when another extend
    // happened in the meantime (clearTimeout isn't reliable -- at
    // least on Chrome, the timeouts still happen even when cleared,
    // if the clear happens after their scheduled firing time).
    var counter = 0;

    function extend(e) {
      var curCount = ++counter;
      var cur = posFromMouse(cm, e, true);
      if (!cur) return;
      if (!posEq(cur, last)) {
        if (!cm.state.focused) onFocus(cm);
        last = cur;
        doSelect(cur);
        var visible = visibleLines(display, doc);
        if (cur.line >= visible.to || cur.line < visible.from)
          setTimeout(operation(cm, function(){if (counter == curCount) extend(e);}), 150);
      } else {
        var outside = e.clientY < editorSize.top ? -20 : e.clientY > editorSize.bottom ? 20 : 0;
        if (outside) setTimeout(operation(cm, function() {
          if (counter != curCount) return;
          display.scroller.scrollTop += outside;
          extend(e);
        }), 50);
      }
    }

    function done(e) {
      counter = Infinity;
      e_preventDefault(e);
      focusInput(cm);
      off(document, "mousemove", move);
      off(document, "mouseup", up);
    }

    var move = operation(cm, function(e) {
      if (!ie && !e_button(e)) done(e);
      else extend(e);
    });
    var up = operation(cm, done);
    on(document, "mousemove", move);
    on(document, "mouseup", up);
  }

  function clickInGutter(cm, e) {
    var display = cm.display;
    try { var mX = e.clientX, mY = e.clientY; }
    catch(e) { return false; }

    if (mX >= Math.floor(getRect(display.gutters).right)) return false;
    e_preventDefault(e);
    if (!hasHandler(cm, "gutterClick")) return true;

    var lineBox = getRect(display.lineDiv);
    if (mY > lineBox.bottom) return true;
    mY -= lineBox.top - display.viewOffset;

    for (var i = 0; i < cm.options.gutters.length; ++i) {
      var g = display.gutters.childNodes[i];
      if (g && getRect(g).right >= mX) {
        var line = lineAtHeight(cm.doc, mY);
        var gutter = cm.options.gutters[i];
        signalLater(cm, "gutterClick", cm, line, gutter, e);
        break;
      }
    }
    return true;
  }

  // Kludge to work around strange IE behavior where it'll sometimes
  // re-fire a series of drag-related events right after the drop (#1551)
  var lastDrop = 0;

  function onDrop(e) {
    var cm = this;
    if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e) || (cm.options.onDragEvent && cm.options.onDragEvent(cm, addStop(e))))
      return;
    e_preventDefault(e);
    if (ie) lastDrop = +new Date;
    var pos = posFromMouse(cm, e, true), files = e.dataTransfer.files;
    if (!pos || isReadOnly(cm)) return;
    if (files && files.length && window.FileReader && window.File) {
      var n = files.length, text = Array(n), read = 0;
      var loadFile = function(file, i) {
        var reader = new FileReader;
        reader.onload = function() {
          text[i] = reader.result;
          if (++read == n) {
            pos = clipPos(cm.doc, pos);
            makeChange(cm.doc, {from: pos, to: pos, text: splitLines(text.join("\n")), origin: "paste"}, "around");
          }
        };
        reader.readAsText(file);
      };
      for (var i = 0; i < n; ++i) loadFile(files[i], i);
    } else {
      // Don't do a replace if the drop happened inside of the selected text.
      if (cm.state.draggingText && !(posLess(pos, cm.doc.sel.from) || posLess(cm.doc.sel.to, pos))) {
        cm.state.draggingText(e);
        // Ensure the editor is re-focused
        setTimeout(bind(focusInput, cm), 20);
        return;
      }
      try {
        var text = e.dataTransfer.getData("Text");
        if (text) {
          var curFrom = cm.doc.sel.from, curTo = cm.doc.sel.to;
          setSelection(cm.doc, pos, pos);
          if (cm.state.draggingText) replaceRange(cm.doc, "", curFrom, curTo, "paste");
          cm.replaceSelection(text, null, "paste");
          focusInput(cm);
          onFocus(cm);
        }
      }
      catch(e){}
    }
  }

  function onDragStart(cm, e) {
    if (ie && (!cm.state.draggingText || +new Date - lastDrop < 100)) { e_stop(e); return; }
    if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e)) return;

    var txt = cm.getSelection();
    e.dataTransfer.setData("Text", txt);

    // Use dummy image instead of default browsers image.
    // Recent Safari (~6.0.2) have a tendency to segfault when this happens, so we don't do it there.
    if (e.dataTransfer.setDragImage && !safari) {
      var img = elt("img", null, null, "position: fixed; left: 0; top: 0;");
      if (opera) {
        img.width = img.height = 1;
        cm.display.wrapper.appendChild(img);
        // Force a relayout, or Opera won't use our image for some obscure reason
        img._top = img.offsetTop;
      }
      e.dataTransfer.setDragImage(img, 0, 0);
      if (opera) img.parentNode.removeChild(img);
    }
  }

  function setScrollTop(cm, val) {
    if (Math.abs(cm.doc.scrollTop - val) < 2) return;
    cm.doc.scrollTop = val;
    if (!gecko) updateDisplay(cm, [], val);
    if (cm.display.scroller.scrollTop != val) cm.display.scroller.scrollTop = val;
    if (cm.display.scrollbarV.scrollTop != val) cm.display.scrollbarV.scrollTop = val;
    if (gecko) updateDisplay(cm, []);
    startWorker(cm, 100);
  }
  function setScrollLeft(cm, val, isScroller) {
    if (isScroller ? val == cm.doc.scrollLeft : Math.abs(cm.doc.scrollLeft - val) < 2) return;
    val = Math.min(val, cm.display.scroller.scrollWidth - cm.display.scroller.clientWidth);
    cm.doc.scrollLeft = val;
    alignHorizontally(cm);
    if (cm.display.scroller.scrollLeft != val) cm.display.scroller.scrollLeft = val;
    if (cm.display.scrollbarH.scrollLeft != val) cm.display.scrollbarH.scrollLeft = val;
  }

  // Since the delta values reported on mouse wheel events are
  // unstandardized between browsers and even browser versions, and
  // generally horribly unpredictable, this code starts by measuring
  // the scroll effect that the first few mouse wheel events have,
  // and, from that, detects the way it can convert deltas to pixel
  // offsets afterwards.
  //
  // The reason we want to know the amount a wheel event will scroll
  // is that it gives us a chance to update the display before the
  // actual scrolling happens, reducing flickering.

  var wheelSamples = 0, wheelPixelsPerUnit = null;
  // Fill in a browser-detected starting value on browsers where we
  // know one. These don't have to be accurate -- the result of them
  // being wrong would just be a slight flicker on the first wheel
  // scroll (if it is large enough).
  if (ie) wheelPixelsPerUnit = -.53;
  else if (gecko) wheelPixelsPerUnit = 15;
  else if (chrome) wheelPixelsPerUnit = -.7;
  else if (safari) wheelPixelsPerUnit = -1/3;

  function onScrollWheel(cm, e) {
    var dx = e.wheelDeltaX, dy = e.wheelDeltaY;
    if (dx == null && e.detail && e.axis == e.HORIZONTAL_AXIS) dx = e.detail;
    if (dy == null && e.detail && e.axis == e.VERTICAL_AXIS) dy = e.detail;
    else if (dy == null) dy = e.wheelDelta;

    var display = cm.display, scroll = display.scroller;
    // Quit if there's nothing to scroll here
    if (!(dx && scroll.scrollWidth > scroll.clientWidth ||
          dy && scroll.scrollHeight > scroll.clientHeight)) return;

    // Webkit browsers on OS X abort momentum scrolls when the target
    // of the scroll event is removed from the scrollable element.
    // This hack (see related code in patchDisplay) makes sure the
    // element is kept around.
    if (dy && mac && webkit) {
      for (var cur = e.target; cur != scroll; cur = cur.parentNode) {
        if (cur.lineObj) {
          cm.display.currentWheelTarget = cur;
          break;
        }
      }
    }

    // On some browsers, horizontal scrolling will cause redraws to
    // happen before the gutter has been realigned, causing it to
    // wriggle around in a most unseemly way. When we have an
    // estimated pixels/delta value, we just handle horizontal
    // scrolling entirely here. It'll be slightly off from native, but
    // better than glitching out.
    if (dx && !gecko && !opera && wheelPixelsPerUnit != null) {
      if (dy)
        setScrollTop(cm, Math.max(0, Math.min(scroll.scrollTop + dy * wheelPixelsPerUnit, scroll.scrollHeight - scroll.clientHeight)));
      setScrollLeft(cm, Math.max(0, Math.min(scroll.scrollLeft + dx * wheelPixelsPerUnit, scroll.scrollWidth - scroll.clientWidth)));
      e_preventDefault(e);
      display.wheelStartX = null; // Abort measurement, if in progress
      return;
    }

    if (dy && wheelPixelsPerUnit != null) {
      var pixels = dy * wheelPixelsPerUnit;
      var top = cm.doc.scrollTop, bot = top + display.wrapper.clientHeight;
      if (pixels < 0) top = Math.max(0, top + pixels - 50);
      else bot = Math.min(cm.doc.height, bot + pixels + 50);
      updateDisplay(cm, [], {top: top, bottom: bot});
    }

    if (wheelSamples < 20) {
      if (display.wheelStartX == null) {
        display.wheelStartX = scroll.scrollLeft; display.wheelStartY = scroll.scrollTop;
        display.wheelDX = dx; display.wheelDY = dy;
        setTimeout(function() {
          if (display.wheelStartX == null) return;
          var movedX = scroll.scrollLeft - display.wheelStartX;
          var movedY = scroll.scrollTop - display.wheelStartY;
          var sample = (movedY && display.wheelDY && movedY / display.wheelDY) ||
            (movedX && display.wheelDX && movedX / display.wheelDX);
          display.wheelStartX = display.wheelStartY = null;
          if (!sample) return;
          wheelPixelsPerUnit = (wheelPixelsPerUnit * wheelSamples + sample) / (wheelSamples + 1);
          ++wheelSamples;
        }, 200);
      } else {
        display.wheelDX += dx; display.wheelDY += dy;
      }
    }
  }

  function doHandleBinding(cm, bound, dropShift) {
    if (typeof bound == "string") {
      bound = commands[bound];
      if (!bound) return false;
    }
    // Ensure previous input has been read, so that the handler sees a
    // consistent view of the document
    if (cm.display.pollingFast && readInput(cm)) cm.display.pollingFast = false;
    var doc = cm.doc, prevShift = doc.sel.shift, done = false;
    try {
      if (isReadOnly(cm)) cm.state.suppressEdits = true;
      if (dropShift) doc.sel.shift = false;
      done = bound(cm) != Pass;
    } finally {
      doc.sel.shift = prevShift;
      cm.state.suppressEdits = false;
    }
    return done;
  }

  function allKeyMaps(cm) {
    var maps = cm.state.keyMaps.slice(0);
    if (cm.options.extraKeys) maps.push(cm.options.extraKeys);
    maps.push(cm.options.keyMap);
    return maps;
  }

  var maybeTransition;
  function handleKeyBinding(cm, e) {
    // Handle auto keymap transitions
    var startMap = getKeyMap(cm.options.keyMap), next = startMap.auto;
    clearTimeout(maybeTransition);
    if (next && !isModifierKey(e)) maybeTransition = setTimeout(function() {
      if (getKeyMap(cm.options.keyMap) == startMap) {
        cm.options.keyMap = (next.call ? next.call(null, cm) : next);
        keyMapChanged(cm);
      }
    }, 50);

    var name = keyName(e, true), handled = false;
    if (!name) return false;
    var keymaps = allKeyMaps(cm);

    if (e.shiftKey) {
      // First try to resolve full name (including 'Shift-'). Failing
      // that, see if there is a cursor-motion command (starting with
      // 'go') bound to the keyname without 'Shift-'.
      handled = lookupKey("Shift-" + name, keymaps, function(b) {return doHandleBinding(cm, b, true);})
             || lookupKey(name, keymaps, function(b) {
                  if (typeof b == "string" ? /^go[A-Z]/.test(b) : b.motion)
                    return doHandleBinding(cm, b);
                });
    } else {
      handled = lookupKey(name, keymaps, function(b) { return doHandleBinding(cm, b); });
    }

    if (handled) {
      e_preventDefault(e);
      restartBlink(cm);
      if (ie_lt9) { e.oldKeyCode = e.keyCode; e.keyCode = 0; }
      signalLater(cm, "keyHandled", cm, name, e);
    }
    return handled;
  }

  function handleCharBinding(cm, e, ch) {
    var handled = lookupKey("'" + ch + "'", allKeyMaps(cm),
                            function(b) { return doHandleBinding(cm, b, true); });
    if (handled) {
      e_preventDefault(e);
      restartBlink(cm);
      signalLater(cm, "keyHandled", cm, "'" + ch + "'", e);
    }
    return handled;
  }

  var lastStoppedKey = null;
  function onKeyDown(e) {
    var cm = this;
    if (!cm.state.focused) onFocus(cm);
    if (ie && e.keyCode == 27) { e.returnValue = false; }
    if (signalDOMEvent(cm, e) || cm.options.onKeyEvent && cm.options.onKeyEvent(cm, addStop(e))) return;
    var code = e.keyCode;
    // IE does strange things with escape.
    cm.doc.sel.shift = code == 16 || e.shiftKey;
    // First give onKeyEvent option a chance to handle this.
    var handled = handleKeyBinding(cm, e);
    if (opera) {
      lastStoppedKey = handled ? code : null;
      // Opera has no cut event... we try to at least catch the key combo
      if (!handled && code == 88 && !hasCopyEvent && (mac ? e.metaKey : e.ctrlKey))
        cm.replaceSelection("");
    }
  }

  function onKeyPress(e) {
    var cm = this;
    if (signalDOMEvent(cm, e) || cm.options.onKeyEvent && cm.options.onKeyEvent(cm, addStop(e))) return;
    var keyCode = e.keyCode, charCode = e.charCode;
    if (opera && keyCode == lastStoppedKey) {lastStoppedKey = null; e_preventDefault(e); return;}
    if (((opera && (!e.which || e.which < 10)) || khtml) && handleKeyBinding(cm, e)) return;
    var ch = String.fromCharCode(charCode == null ? keyCode : charCode);
    if (this.options.electricChars && this.doc.mode.electricChars &&
        this.options.smartIndent && !isReadOnly(this) &&
        this.doc.mode.electricChars.indexOf(ch) > -1)
      setTimeout(operation(cm, function() {indentLine(cm, cm.doc.sel.to.line, "smart");}), 75);
    if (handleCharBinding(cm, e, ch)) return;
    if (ie && !ie_lt9) cm.display.inputHasSelection = null;
    fastPoll(cm);
  }

  function onFocus(cm) {
    if (cm.options.readOnly == "nocursor") return;
    if (!cm.state.focused) {
      signal(cm, "focus", cm);
      cm.state.focused = true;
      if (cm.display.wrapper.className.search(/\bCodeMirror-focused\b/) == -1)
        cm.display.wrapper.className += " CodeMirror-focused";
      resetInput(cm, true);
    }
    slowPoll(cm);
    restartBlink(cm);
  }
  function onBlur(cm) {
    if (cm.state.focused) {
      signal(cm, "blur", cm);
      cm.state.focused = false;
      cm.display.wrapper.className = cm.display.wrapper.className.replace(" CodeMirror-focused", "");
    }
    clearInterval(cm.display.blinker);
    setTimeout(function() {if (!cm.state.focused) cm.doc.sel.shift = false;}, 150);
  }

  var detectingSelectAll;
  function onContextMenu(cm, e) {
    if (signalDOMEvent(cm, e, "contextmenu")) return;
    var display = cm.display, sel = cm.doc.sel;
    if (eventInWidget(display, e)) return;

    var pos = posFromMouse(cm, e), scrollPos = display.scroller.scrollTop;
    if (!pos || opera) return; // Opera is difficult.
    if (posEq(sel.from, sel.to) || posLess(pos, sel.from) || !posLess(pos, sel.to))
      operation(cm, setSelection)(cm.doc, pos, pos);

    var oldCSS = display.input.style.cssText;
    display.inputDiv.style.position = "absolute";
    display.input.style.cssText = "position: fixed; width: 30px; height: 30px; top: " + (e.clientY - 5) +
      "px; left: " + (e.clientX - 5) + "px; z-index: 1000; background: white; outline: none;" +
      "border-width: 0; outline: none; overflow: hidden; opacity: .05; -ms-opacity: .05; filter: alpha(opacity=5);";
    focusInput(cm);
    resetInput(cm, true);
    // Adds "Select all" to context menu in FF
    if (posEq(sel.from, sel.to)) display.input.value = display.prevInput = " ";

    function prepareSelectAllHack() {
      if (display.input.selectionStart != null) {
        var extval = display.input.value = " " + (posEq(sel.from, sel.to) ? "" : display.input.value);
        display.prevInput = " ";
        display.input.selectionStart = 1; display.input.selectionEnd = extval.length;
      }
    }
    function rehide() {
      display.inputDiv.style.position = "relative";
      display.input.style.cssText = oldCSS;
      if (ie_lt9) display.scrollbarV.scrollTop = display.scroller.scrollTop = scrollPos;
      slowPoll(cm);

      // Try to detect the user choosing select-all
      if (display.input.selectionStart != null) {
        if (!ie || ie_lt9) prepareSelectAllHack();
        clearTimeout(detectingSelectAll);
        var i = 0, poll = function(){
          if (display.prevInput == " " && display.input.selectionStart == 0)
            operation(cm, commands.selectAll)(cm);
          else if (i++ < 10) detectingSelectAll = setTimeout(poll, 500);
          else resetInput(cm);
        };
        detectingSelectAll = setTimeout(poll, 200);
      }
    }

    if (ie && !ie_lt9) prepareSelectAllHack();
    if (captureMiddleClick) {
      e_stop(e);
      var mouseup = function() {
        off(window, "mouseup", mouseup);
        setTimeout(rehide, 20);
      };
      on(window, "mouseup", mouseup);
    } else {
      setTimeout(rehide, 50);
    }
  }

  // UPDATING

  var changeEnd = CodeMirror.changeEnd = function(change) {
    if (!change.text) return change.to;
    return Pos(change.from.line + change.text.length - 1,
               lst(change.text).length + (change.text.length == 1 ? change.from.ch : 0));
  };

  // Make sure a position will be valid after the given change.
  function clipPostChange(doc, change, pos) {
    if (!posLess(change.from, pos)) return clipPos(doc, pos);
    var diff = (change.text.length - 1) - (change.to.line - change.from.line);
    if (pos.line > change.to.line + diff) {
      var preLine = pos.line - diff, lastLine = doc.first + doc.size - 1;
      if (preLine > lastLine) return Pos(lastLine, getLine(doc, lastLine).text.length);
      return clipToLen(pos, getLine(doc, preLine).text.length);
    }
    if (pos.line == change.to.line + diff)
      return clipToLen(pos, lst(change.text).length + (change.text.length == 1 ? change.from.ch : 0) +
                       getLine(doc, change.to.line).text.length - change.to.ch);
    var inside = pos.line - change.from.line;
    return clipToLen(pos, change.text[inside].length + (inside ? 0 : change.from.ch));
  }

  // Hint can be null|"end"|"start"|"around"|{anchor,head}
  function computeSelAfterChange(doc, change, hint) {
    if (hint && typeof hint == "object") // Assumed to be {anchor, head} object
      return {anchor: clipPostChange(doc, change, hint.anchor),
              head: clipPostChange(doc, change, hint.head)};

    if (hint == "start") return {anchor: change.from, head: change.from};

    var end = changeEnd(change);
    if (hint == "around") return {anchor: change.from, head: end};
    if (hint == "end") return {anchor: end, head: end};

    // hint is null, leave the selection alone as much as possible
    var adjustPos = function(pos) {
      if (posLess(pos, change.from)) return pos;
      if (!posLess(change.to, pos)) return end;

      var line = pos.line + change.text.length - (change.to.line - change.from.line) - 1, ch = pos.ch;
      if (pos.line == change.to.line) ch += end.ch - change.to.ch;
      return Pos(line, ch);
    };
    return {anchor: adjustPos(doc.sel.anchor), head: adjustPos(doc.sel.head)};
  }

  function filterChange(doc, change, update) {
    var obj = {
      canceled: false,
      from: change.from,
      to: change.to,
      text: change.text,
      origin: change.origin,
      cancel: function() { this.canceled = true; }
    };
    if (update) obj.update = function(from, to, text, origin) {
      if (from) this.from = clipPos(doc, from);
      if (to) this.to = clipPos(doc, to);
      if (text) this.text = text;
      if (origin !== undefined) this.origin = origin;
    };
    signal(doc, "beforeChange", doc, obj);
    if (doc.cm) signal(doc.cm, "beforeChange", doc.cm, obj);

    if (obj.canceled) return null;
    return {from: obj.from, to: obj.to, text: obj.text, origin: obj.origin};
  }

  // Replace the range from from to to by the strings in replacement.
  // change is a {from, to, text [, origin]} object
  function makeChange(doc, change, selUpdate, ignoreReadOnly) {
    if (doc.cm) {
      if (!doc.cm.curOp) return operation(doc.cm, makeChange)(doc, change, selUpdate, ignoreReadOnly);
      if (doc.cm.state.suppressEdits) return;
    }

    if (hasHandler(doc, "beforeChange") || doc.cm && hasHandler(doc.cm, "beforeChange")) {
      change = filterChange(doc, change, true);
      if (!change) return;
    }

    // Possibly split or suppress the update based on the presence
    // of read-only spans in its range.
    var split = sawReadOnlySpans && !ignoreReadOnly && removeReadOnlyRanges(doc, change.from, change.to);
    if (split) {
      for (var i = split.length - 1; i >= 1; --i)
        makeChangeNoReadonly(doc, {from: split[i].from, to: split[i].to, text: [""]});
      if (split.length)
        makeChangeNoReadonly(doc, {from: split[0].from, to: split[0].to, text: change.text}, selUpdate);
    } else {
      makeChangeNoReadonly(doc, change, selUpdate);
    }
  }

  function makeChangeNoReadonly(doc, change, selUpdate) {
    var selAfter = computeSelAfterChange(doc, change, selUpdate);
    addToHistory(doc, change, selAfter, doc.cm ? doc.cm.curOp.id : NaN);

    makeChangeSingleDoc(doc, change, selAfter, stretchSpansOverChange(doc, change));
    var rebased = [];

    linkedDocs(doc, function(doc, sharedHist) {
      if (!sharedHist && indexOf(rebased, doc.history) == -1) {
        rebaseHist(doc.history, change);
        rebased.push(doc.history);
      }
      makeChangeSingleDoc(doc, change, null, stretchSpansOverChange(doc, change));
    });
  }

  function makeChangeFromHistory(doc, type) {
    if (doc.cm && doc.cm.state.suppressEdits) return;

    var hist = doc.history;
    var event = (type == "undo" ? hist.done : hist.undone).pop();
    if (!event) return;

    var anti = {changes: [], anchorBefore: event.anchorAfter, headBefore: event.headAfter,
                anchorAfter: event.anchorBefore, headAfter: event.headBefore,
                generation: hist.generation};
    (type == "undo" ? hist.undone : hist.done).push(anti);
    hist.generation = event.generation || ++hist.maxGeneration;

    var filter = hasHandler(doc, "beforeChange") || doc.cm && hasHandler(doc.cm, "beforeChange");

    for (var i = event.changes.length - 1; i >= 0; --i) {
      var change = event.changes[i];
      change.origin = type;
      if (filter && !filterChange(doc, change, false)) {
        (type == "undo" ? hist.done : hist.undone).length = 0;
        return;
      }

      anti.changes.push(historyChangeFromChange(doc, change));

      var after = i ? computeSelAfterChange(doc, change, null)
                    : {anchor: event.anchorBefore, head: event.headBefore};
      makeChangeSingleDoc(doc, change, after, mergeOldSpans(doc, change));
      var rebased = [];

      linkedDocs(doc, function(doc, sharedHist) {
        if (!sharedHist && indexOf(rebased, doc.history) == -1) {
          rebaseHist(doc.history, change);
          rebased.push(doc.history);
        }
        makeChangeSingleDoc(doc, change, null, mergeOldSpans(doc, change));
      });
    }
  }

  function shiftDoc(doc, distance) {
    function shiftPos(pos) {return Pos(pos.line + distance, pos.ch);}
    doc.first += distance;
    if (doc.cm) regChange(doc.cm, doc.first, doc.first, distance);
    doc.sel.head = shiftPos(doc.sel.head); doc.sel.anchor = shiftPos(doc.sel.anchor);
    doc.sel.from = shiftPos(doc.sel.from); doc.sel.to = shiftPos(doc.sel.to);
  }

  function makeChangeSingleDoc(doc, change, selAfter, spans) {
    if (doc.cm && !doc.cm.curOp)
      return operation(doc.cm, makeChangeSingleDoc)(doc, change, selAfter, spans);

    if (change.to.line < doc.first) {
      shiftDoc(doc, change.text.length - 1 - (change.to.line - change.from.line));
      return;
    }
    if (change.from.line > doc.lastLine()) return;

    // Clip the change to the size of this doc
    if (change.from.line < doc.first) {
      var shift = change.text.length - 1 - (doc.first - change.from.line);
      shiftDoc(doc, shift);
      change = {from: Pos(doc.first, 0), to: Pos(change.to.line + shift, change.to.ch),
                text: [lst(change.text)], origin: change.origin};
    }
    var last = doc.lastLine();
    if (change.to.line > last) {
      change = {from: change.from, to: Pos(last, getLine(doc, last).text.length),
                text: [change.text[0]], origin: change.origin};
    }

    change.removed = getBetween(doc, change.from, change.to);

    if (!selAfter) selAfter = computeSelAfterChange(doc, change, null);
    if (doc.cm) makeChangeSingleDocInEditor(doc.cm, change, spans, selAfter);
    else updateDoc(doc, change, spans, selAfter);
  }

  function makeChangeSingleDocInEditor(cm, change, spans, selAfter) {
    var doc = cm.doc, display = cm.display, from = change.from, to = change.to;

    var recomputeMaxLength = false, checkWidthStart = from.line;
    if (!cm.options.lineWrapping) {
      checkWidthStart = lineNo(visualLine(doc, getLine(doc, from.line)));
      doc.iter(checkWidthStart, to.line + 1, function(line) {
        if (line == display.maxLine) {
          recomputeMaxLength = true;
          return true;
        }
      });
    }

    if (!posLess(doc.sel.head, change.from) && !posLess(change.to, doc.sel.head))
      cm.curOp.cursorActivity = true;

    updateDoc(doc, change, spans, selAfter, estimateHeight(cm));

    if (!cm.options.lineWrapping) {
      doc.iter(checkWidthStart, from.line + change.text.length, function(line) {
        var len = lineLength(doc, line);
        if (len > display.maxLineLength) {
          display.maxLine = line;
          display.maxLineLength = len;
          display.maxLineChanged = true;
          recomputeMaxLength = false;
        }
      });
      if (recomputeMaxLength) cm.curOp.updateMaxLine = true;
    }

    // Adjust frontier, schedule worker
    doc.frontier = Math.min(doc.frontier, from.line);
    startWorker(cm, 400);

    var lendiff = change.text.length - (to.line - from.line) - 1;
    // Remember that these lines changed, for updating the display
    regChange(cm, from.line, to.line + 1, lendiff);

    if (hasHandler(cm, "change")) {
      var changeObj = {from: from, to: to,
                       text: change.text,
                       removed: change.removed,
                       origin: change.origin};
      if (cm.curOp.textChanged) {
        for (var cur = cm.curOp.textChanged; cur.next; cur = cur.next) {}
        cur.next = changeObj;
      } else cm.curOp.textChanged = changeObj;
    }
  }

  function replaceRange(doc, code, from, to, origin) {
    if (!to) to = from;
    if (posLess(to, from)) { var tmp = to; to = from; from = tmp; }
    if (typeof code == "string") code = splitLines(code);
    makeChange(doc, {from: from, to: to, text: code, origin: origin}, null);
  }

  // POSITION OBJECT

  function Pos(line, ch) {
    if (!(this instanceof Pos)) return new Pos(line, ch);
    this.line = line; this.ch = ch;
  }
  CodeMirror.Pos = Pos;

  function posEq(a, b) {return a.line == b.line && a.ch == b.ch;}
  function posLess(a, b) {return a.line < b.line || (a.line == b.line && a.ch < b.ch);}
  function copyPos(x) {return Pos(x.line, x.ch);}

  // SELECTION

  function clipLine(doc, n) {return Math.max(doc.first, Math.min(n, doc.first + doc.size - 1));}
  function clipPos(doc, pos) {
    if (pos.line < doc.first) return Pos(doc.first, 0);
    var last = doc.first + doc.size - 1;
    if (pos.line > last) return Pos(last, getLine(doc, last).text.length);
    return clipToLen(pos, getLine(doc, pos.line).text.length);
  }
  function clipToLen(pos, linelen) {
    var ch = pos.ch;
    if (ch == null || ch > linelen) return Pos(pos.line, linelen);
    else if (ch < 0) return Pos(pos.line, 0);
    else return pos;
  }
  function isLine(doc, l) {return l >= doc.first && l < doc.first + doc.size;}

  // If shift is held, this will move the selection anchor. Otherwise,
  // it'll set the whole selection.
  function extendSelection(doc, pos, other, bias) {
    if (doc.sel.shift || doc.sel.extend) {
      var anchor = doc.sel.anchor;
      if (other) {
        var posBefore = posLess(pos, anchor);
        if (posBefore != posLess(other, anchor)) {
          anchor = pos;
          pos = other;
        } else if (posBefore != posLess(pos, other)) {
          pos = other;
        }
      }
      setSelection(doc, anchor, pos, bias);
    } else {
      setSelection(doc, pos, other || pos, bias);
    }
    if (doc.cm) doc.cm.curOp.userSelChange = true;
  }

  function filterSelectionChange(doc, anchor, head) {
    var obj = {anchor: anchor, head: head};
    signal(doc, "beforeSelectionChange", doc, obj);
    if (doc.cm) signal(doc.cm, "beforeSelectionChange", doc.cm, obj);
    obj.anchor = clipPos(doc, obj.anchor); obj.head = clipPos(doc, obj.head);
    return obj;
  }

  // Update the selection. Last two args are only used by
  // updateDoc, since they have to be expressed in the line
  // numbers before the update.
  function setSelection(doc, anchor, head, bias, checkAtomic) {
    if (!checkAtomic && hasHandler(doc, "beforeSelectionChange") || doc.cm && hasHandler(doc.cm, "beforeSelectionChange")) {
      var filtered = filterSelectionChange(doc, anchor, head);
      head = filtered.head;
      anchor = filtered.anchor;
    }

    var sel = doc.sel;
    sel.goalColumn = null;
    // Skip over atomic spans.
    if (checkAtomic || !posEq(anchor, sel.anchor))
      anchor = skipAtomic(doc, anchor, bias, checkAtomic != "push");
    if (checkAtomic || !posEq(head, sel.head))
      head = skipAtomic(doc, head, bias, checkAtomic != "push");

    if (posEq(sel.anchor, anchor) && posEq(sel.head, head)) return;

    sel.anchor = anchor; sel.head = head;
    var inv = posLess(head, anchor);
    sel.from = inv ? head : anchor;
    sel.to = inv ? anchor : head;

    if (doc.cm)
      doc.cm.curOp.updateInput = doc.cm.curOp.selectionChanged =
        doc.cm.curOp.cursorActivity = true;

    signalLater(doc, "cursorActivity", doc);
  }

  function reCheckSelection(cm) {
    setSelection(cm.doc, cm.doc.sel.from, cm.doc.sel.to, null, "push");
  }

  function skipAtomic(doc, pos, bias, mayClear) {
    var flipped = false, curPos = pos;
    var dir = bias || 1;
    doc.cantEdit = false;
    search: for (;;) {
      var line = getLine(doc, curPos.line);
      if (line.markedSpans) {
        for (var i = 0; i < line.markedSpans.length; ++i) {
          var sp = line.markedSpans[i], m = sp.marker;
          if ((sp.from == null || (m.inclusiveLeft ? sp.from <= curPos.ch : sp.from < curPos.ch)) &&
              (sp.to == null || (m.inclusiveRight ? sp.to >= curPos.ch : sp.to > curPos.ch))) {
            if (mayClear) {
              signal(m, "beforeCursorEnter");
              if (m.explicitlyCleared) {
                if (!line.markedSpans) break;
                else {--i; continue;}
              }
            }
            if (!m.atomic) continue;
            var newPos = m.find()[dir < 0 ? "from" : "to"];
            if (posEq(newPos, curPos)) {
              newPos.ch += dir;
              if (newPos.ch < 0) {
                if (newPos.line > doc.first) newPos = clipPos(doc, Pos(newPos.line - 1));
                else newPos = null;
              } else if (newPos.ch > line.text.length) {
                if (newPos.line < doc.first + doc.size - 1) newPos = Pos(newPos.line + 1, 0);
                else newPos = null;
              }
              if (!newPos) {
                if (flipped) {
                  // Driven in a corner -- no valid cursor position found at all
                  // -- try again *with* clearing, if we didn't already
                  if (!mayClear) return skipAtomic(doc, pos, bias, true);
                  // Otherwise, turn off editing until further notice, and return the start of the doc
                  doc.cantEdit = true;
                  return Pos(doc.first, 0);
                }
                flipped = true; newPos = pos; dir = -dir;
              }
            }
            curPos = newPos;
            continue search;
          }
        }
      }
      return curPos;
    }
  }

  // SCROLLING

  function scrollCursorIntoView(cm) {
    var coords = scrollPosIntoView(cm, cm.doc.sel.head, cm.options.cursorScrollMargin);
    if (!cm.state.focused) return;
    var display = cm.display, box = getRect(display.sizer), doScroll = null;
    if (coords.top + box.top < 0) doScroll = true;
    else if (coords.bottom + box.top > (window.innerHeight || document.documentElement.clientHeight)) doScroll = false;
    if (doScroll != null && !phantom) {
      var hidden = display.cursor.style.display == "none";
      if (hidden) {
        display.cursor.style.display = "";
        display.cursor.style.left = coords.left + "px";
        display.cursor.style.top = (coords.top - display.viewOffset) + "px";
      }
      display.cursor.scrollIntoView(doScroll);
      if (hidden) display.cursor.style.display = "none";
    }
  }

  function scrollPosIntoView(cm, pos, margin) {
    if (margin == null) margin = 0;
    for (;;) {
      var changed = false, coords = cursorCoords(cm, pos);
      var scrollPos = calculateScrollPos(cm, coords.left, coords.top - margin, coords.left, coords.bottom + margin);
      var startTop = cm.doc.scrollTop, startLeft = cm.doc.scrollLeft;
      if (scrollPos.scrollTop != null) {
        setScrollTop(cm, scrollPos.scrollTop);
        if (Math.abs(cm.doc.scrollTop - startTop) > 1) changed = true;
      }
      if (scrollPos.scrollLeft != null) {
        setScrollLeft(cm, scrollPos.scrollLeft);
        if (Math.abs(cm.doc.scrollLeft - startLeft) > 1) changed = true;
      }
      if (!changed) return coords;
    }
  }

  function scrollIntoView(cm, x1, y1, x2, y2) {
    var scrollPos = calculateScrollPos(cm, x1, y1, x2, y2);
    if (scrollPos.scrollTop != null) setScrollTop(cm, scrollPos.scrollTop);
    if (scrollPos.scrollLeft != null) setScrollLeft(cm, scrollPos.scrollLeft);
  }

  function calculateScrollPos(cm, x1, y1, x2, y2) {
    var display = cm.display, snapMargin = textHeight(cm.display);
    if (y1 < 0) y1 = 0;
    var screen = display.scroller.clientHeight - scrollerCutOff, screentop = display.scroller.scrollTop, result = {};
    var docBottom = cm.doc.height + paddingVert(display);
    var atTop = y1 < snapMargin, atBottom = y2 > docBottom - snapMargin;
    if (y1 < screentop) {
      result.scrollTop = atTop ? 0 : y1;
    } else if (y2 > screentop + screen) {
      var newTop = Math.min(y1, (atBottom ? docBottom : y2) - screen);
      if (newTop != screentop) result.scrollTop = newTop;
    }

    var screenw = display.scroller.clientWidth - scrollerCutOff, screenleft = display.scroller.scrollLeft;
    x1 += display.gutters.offsetWidth; x2 += display.gutters.offsetWidth;
    var gutterw = display.gutters.offsetWidth;
    var atLeft = x1 < gutterw + 10;
    if (x1 < screenleft + gutterw || atLeft) {
      if (atLeft) x1 = 0;
      result.scrollLeft = Math.max(0, x1 - 10 - gutterw);
    } else if (x2 > screenw + screenleft - 3) {
      result.scrollLeft = x2 + 10 - screenw;
    }
    return result;
  }

  function updateScrollPos(cm, left, top) {
    cm.curOp.updateScrollPos = {scrollLeft: left == null ? cm.doc.scrollLeft : left,
                                scrollTop: top == null ? cm.doc.scrollTop : top};
  }

  function addToScrollPos(cm, left, top) {
    var pos = cm.curOp.updateScrollPos || (cm.curOp.updateScrollPos = {scrollLeft: cm.doc.scrollLeft, scrollTop: cm.doc.scrollTop});
    var scroll = cm.display.scroller;
    pos.scrollTop = Math.max(0, Math.min(scroll.scrollHeight - scroll.clientHeight, pos.scrollTop + top));
    pos.scrollLeft = Math.max(0, Math.min(scroll.scrollWidth - scroll.clientWidth, pos.scrollLeft + left));
  }

  // API UTILITIES

  function indentLine(cm, n, how, aggressive) {
    var doc = cm.doc;
    if (how == null) how = "add";
    if (how == "smart") {
      if (!cm.doc.mode.indent) how = "prev";
      else var state = getStateBefore(cm, n);
    }

    var tabSize = cm.options.tabSize;
    var line = getLine(doc, n), curSpace = countColumn(line.text, null, tabSize);
    var curSpaceString = line.text.match(/^\s*/)[0], indentation;
    if (how == "smart") {
      indentation = cm.doc.mode.indent(state, line.text.slice(curSpaceString.length), line.text);
      if (indentation == Pass) {
        if (!aggressive) return;
        how = "prev";
      }
    }
    if (how == "prev") {
      if (n > doc.first) indentation = countColumn(getLine(doc, n-1).text, null, tabSize);
      else indentation = 0;
    } else if (how == "add") {
      indentation = curSpace + cm.options.indentUnit;
    } else if (how == "subtract") {
      indentation = curSpace - cm.options.indentUnit;
    } else if (typeof how == "number") {
      indentation = curSpace + how;
    }
    indentation = Math.max(0, indentation);

    var indentString = "", pos = 0;
    if (cm.options.indentWithTabs)
      for (var i = Math.floor(indentation / tabSize); i; --i) {pos += tabSize; indentString += "\t";}
    if (pos < indentation) indentString += spaceStr(indentation - pos);

    if (indentString != curSpaceString)
      replaceRange(cm.doc, indentString, Pos(n, 0), Pos(n, curSpaceString.length), "+input");
    line.stateAfter = null;
  }

  function changeLine(cm, handle, op) {
    var no = handle, line = handle, doc = cm.doc;
    if (typeof handle == "number") line = getLine(doc, clipLine(doc, handle));
    else no = lineNo(handle);
    if (no == null) return null;
    if (op(line, no)) regChange(cm, no, no + 1);
    else return null;
    return line;
  }

  function findPosH(doc, pos, dir, unit, visually) {
    var line = pos.line, ch = pos.ch, origDir = dir;
    var lineObj = getLine(doc, line);
    var possible = true;
    function findNextLine() {
      var l = line + dir;
      if (l < doc.first || l >= doc.first + doc.size) return (possible = false);
      line = l;
      return lineObj = getLine(doc, l);
    }
    function moveOnce(boundToLine) {
      var next = (visually ? moveVisually : moveLogically)(lineObj, ch, dir, true);
      if (next == null) {
        if (!boundToLine && findNextLine()) {
          if (visually) ch = (dir < 0 ? lineRight : lineLeft)(lineObj);
          else ch = dir < 0 ? lineObj.text.length : 0;
        } else return (possible = false);
      } else ch = next;
      return true;
    }

    if (unit == "char") moveOnce();
    else if (unit == "column") moveOnce(true);
    else if (unit == "word" || unit == "group") {
      var sawType = null, group = unit == "group";
      for (var first = true;; first = false) {
        if (dir < 0 && !moveOnce(!first)) break;
        var cur = lineObj.text.charAt(ch) || "\n";
        var type = isWordChar(cur) ? "w"
          : !group ? null
          : /\s/.test(cur) ? null
          : "p";
        if (sawType && sawType != type) {
          if (dir < 0) {dir = 1; moveOnce();}
          break;
        }
        if (type) sawType = type;
        if (dir > 0 && !moveOnce(!first)) break;
      }
    }
    var result = skipAtomic(doc, Pos(line, ch), origDir, true);
    if (!possible) result.hitSide = true;
    return result;
  }

  function findPosV(cm, pos, dir, unit) {
    var doc = cm.doc, x = pos.left, y;
    if (unit == "page") {
      var pageSize = Math.min(cm.display.wrapper.clientHeight, window.innerHeight || document.documentElement.clientHeight);
      y = pos.top + dir * (pageSize - (dir < 0 ? 1.5 : .5) * textHeight(cm.display));
    } else if (unit == "line") {
      y = dir > 0 ? pos.bottom + 3 : pos.top - 3;
    }
    for (;;) {
      var target = coordsChar(cm, x, y);
      if (!target.outside) break;
      if (dir < 0 ? y <= 0 : y >= doc.height) { target.hitSide = true; break; }
      y += dir * 5;
    }
    return target;
  }

  function findWordAt(line, pos) {
    var start = pos.ch, end = pos.ch;
    if (line) {
      if ((pos.xRel < 0 || end == line.length) && start) --start; else ++end;
      var startChar = line.charAt(start);
      var check = isWordChar(startChar) ? isWordChar
        : /\s/.test(startChar) ? function(ch) {return /\s/.test(ch);}
        : function(ch) {return !/\s/.test(ch) && !isWordChar(ch);};
      while (start > 0 && check(line.charAt(start - 1))) --start;
      while (end < line.length && check(line.charAt(end))) ++end;
    }
    return {from: Pos(pos.line, start), to: Pos(pos.line, end)};
  }

  function selectLine(cm, line) {
    extendSelection(cm.doc, Pos(line, 0), clipPos(cm.doc, Pos(line + 1, 0)));
  }

  // PROTOTYPE

  // The publicly visible API. Note that operation(null, f) means
  // 'wrap f in an operation, performed on its `this` parameter'

  CodeMirror.prototype = {
    constructor: CodeMirror,
    focus: function(){window.focus(); focusInput(this); onFocus(this); fastPoll(this);},

    setOption: function(option, value) {
      var options = this.options, old = options[option];
      if (options[option] == value && option != "mode") return;
      options[option] = value;
      if (optionHandlers.hasOwnProperty(option))
        operation(this, optionHandlers[option])(this, value, old);
    },

    getOption: function(option) {return this.options[option];},
    getDoc: function() {return this.doc;},

    addKeyMap: function(map, bottom) {
      this.state.keyMaps[bottom ? "push" : "unshift"](map);
    },
    removeKeyMap: function(map) {
      var maps = this.state.keyMaps;
      for (var i = 0; i < maps.length; ++i)
        if (maps[i] == map || (typeof maps[i] != "string" && maps[i].name == map)) {
          maps.splice(i, 1);
          return true;
        }
    },

    addOverlay: operation(null, function(spec, options) {
      var mode = spec.token ? spec : CodeMirror.getMode(this.options, spec);
      if (mode.startState) throw new Error("Overlays may not be stateful.");
      this.state.overlays.push({mode: mode, modeSpec: spec, opaque: options && options.opaque});
      this.state.modeGen++;
      regChange(this);
    }),
    removeOverlay: operation(null, function(spec) {
      var overlays = this.state.overlays;
      for (var i = 0; i < overlays.length; ++i) {
        var cur = overlays[i].modeSpec;
        if (cur == spec || typeof spec == "string" && cur.name == spec) {
          overlays.splice(i, 1);
          this.state.modeGen++;
          regChange(this);
          return;
        }
      }
    }),

    indentLine: operation(null, function(n, dir, aggressive) {
      if (typeof dir != "string" && typeof dir != "number") {
        if (dir == null) dir = this.options.smartIndent ? "smart" : "prev";
        else dir = dir ? "add" : "subtract";
      }
      if (isLine(this.doc, n)) indentLine(this, n, dir, aggressive);
    }),
    indentSelection: operation(null, function(how) {
      var sel = this.doc.sel;
      if (posEq(sel.from, sel.to)) return indentLine(this, sel.from.line, how);
      var e = sel.to.line - (sel.to.ch ? 0 : 1);
      for (var i = sel.from.line; i <= e; ++i) indentLine(this, i, how);
    }),

    // Fetch the parser token for a given character. Useful for hacks
    // that want to inspect the mode state (say, for completion).
    getTokenAt: function(pos, precise) {
      var doc = this.doc;
      pos = clipPos(doc, pos);
      var state = getStateBefore(this, pos.line, precise), mode = this.doc.mode;
      var line = getLine(doc, pos.line);
      var stream = new StringStream(line.text, this.options.tabSize);
      while (stream.pos < pos.ch && !stream.eol()) {
        stream.start = stream.pos;
        var style = mode.token(stream, state);
      }
      return {start: stream.start,
              end: stream.pos,
              string: stream.current(),
              className: style || null, // Deprecated, use 'type' instead
              type: style || null,
              state: state};
    },

    getTokenTypeAt: function(pos) {
      pos = clipPos(this.doc, pos);
      var styles = getLineStyles(this, getLine(this.doc, pos.line));
      var before = 0, after = (styles.length - 1) / 2, ch = pos.ch;
      if (ch == 0) return styles[2];
      for (;;) {
        var mid = (before + after) >> 1;
        if ((mid ? styles[mid * 2 - 1] : 0) >= ch) after = mid;
        else if (styles[mid * 2 + 1] < ch) before = mid + 1;
        else return styles[mid * 2 + 2];
      }
    },

    getModeAt: function(pos) {
      var mode = this.doc.mode;
      if (!mode.innerMode) return mode;
      return CodeMirror.innerMode(mode, this.getTokenAt(pos).state).mode;
    },

    getHelper: function(pos, type) {
      if (!helpers.hasOwnProperty(type)) return;
      var help = helpers[type], mode = this.getModeAt(pos);
      return mode[type] && help[mode[type]] ||
        mode.helperType && help[mode.helperType] ||
        help[mode.name];
    },

    getStateAfter: function(line, precise) {
      var doc = this.doc;
      line = clipLine(doc, line == null ? doc.first + doc.size - 1: line);
      return getStateBefore(this, line + 1, precise);
    },

    cursorCoords: function(start, mode) {
      var pos, sel = this.doc.sel;
      if (start == null) pos = sel.head;
      else if (typeof start == "object") pos = clipPos(this.doc, start);
      else pos = start ? sel.from : sel.to;
      return cursorCoords(this, pos, mode || "page");
    },

    charCoords: function(pos, mode) {
      return charCoords(this, clipPos(this.doc, pos), mode || "page");
    },

    coordsChar: function(coords, mode) {
      coords = fromCoordSystem(this, coords, mode || "page");
      return coordsChar(this, coords.left, coords.top);
    },

    lineAtHeight: function(height, mode) {
      height = fromCoordSystem(this, {top: height, left: 0}, mode || "page").top;
      return lineAtHeight(this.doc, height + this.display.viewOffset);
    },
    heightAtLine: function(line, mode) {
      var end = false, last = this.doc.first + this.doc.size - 1;
      if (line < this.doc.first) line = this.doc.first;
      else if (line > last) { line = last; end = true; }
      var lineObj = getLine(this.doc, line);
      return intoCoordSystem(this, getLine(this.doc, line), {top: 0, left: 0}, mode || "page").top +
        (end ? lineObj.height : 0);
    },

    defaultTextHeight: function() { return textHeight(this.display); },
    defaultCharWidth: function() { return charWidth(this.display); },

    setGutterMarker: operation(null, function(line, gutterID, value) {
      return changeLine(this, line, function(line) {
        var markers = line.gutterMarkers || (line.gutterMarkers = {});
        markers[gutterID] = value;
        if (!value && isEmpty(markers)) line.gutterMarkers = null;
        return true;
      });
    }),

    clearGutter: operation(null, function(gutterID) {
      var cm = this, doc = cm.doc, i = doc.first;
      doc.iter(function(line) {
        if (line.gutterMarkers && line.gutterMarkers[gutterID]) {
          line.gutterMarkers[gutterID] = null;
          regChange(cm, i, i + 1);
          if (isEmpty(line.gutterMarkers)) line.gutterMarkers = null;
        }
        ++i;
      });
    }),

    addLineClass: operation(null, function(handle, where, cls) {
      return changeLine(this, handle, function(line) {
        var prop = where == "text" ? "textClass" : where == "background" ? "bgClass" : "wrapClass";
        if (!line[prop]) line[prop] = cls;
        else if (new RegExp("(?:^|\\s)" + cls + "(?:$|\\s)").test(line[prop])) return false;
        else line[prop] += " " + cls;
        return true;
      });
    }),

    removeLineClass: operation(null, function(handle, where, cls) {
      return changeLine(this, handle, function(line) {
        var prop = where == "text" ? "textClass" : where == "background" ? "bgClass" : "wrapClass";
        var cur = line[prop];
        if (!cur) return false;
        else if (cls == null) line[prop] = null;
        else {
          var found = cur.match(new RegExp("(?:^|\\s+)" + cls + "(?:$|\\s+)"));
          if (!found) return false;
          var end = found.index + found[0].length;
          line[prop] = cur.slice(0, found.index) + (!found.index || end == cur.length ? "" : " ") + cur.slice(end) || null;
        }
        return true;
      });
    }),

    addLineWidget: operation(null, function(handle, node, options) {
      return addLineWidget(this, handle, node, options);
    }),

    removeLineWidget: function(widget) { widget.clear(); },

    lineInfo: function(line) {
      if (typeof line == "number") {
        if (!isLine(this.doc, line)) return null;
        var n = line;
        line = getLine(this.doc, line);
        if (!line) return null;
      } else {
        var n = lineNo(line);
        if (n == null) return null;
      }
      return {line: n, handle: line, text: line.text, gutterMarkers: line.gutterMarkers,
              textClass: line.textClass, bgClass: line.bgClass, wrapClass: line.wrapClass,
              widgets: line.widgets};
    },

    getViewport: function() { return {from: this.display.showingFrom, to: this.display.showingTo};},

    addWidget: function(pos, node, scroll, vert, horiz) {
      var display = this.display;
      pos = cursorCoords(this, clipPos(this.doc, pos));
      var top = pos.bottom, left = pos.left;
      node.style.position = "absolute";
      display.sizer.appendChild(node);
      if (vert == "over") {
        top = pos.top;
      } else if (vert == "above" || vert == "near") {
        var vspace = Math.max(display.wrapper.clientHeight, this.doc.height),
        hspace = Math.max(display.sizer.clientWidth, display.lineSpace.clientWidth);
        // Default to positioning above (if specified and possible); otherwise default to positioning below
        if ((vert == 'above' || pos.bottom + node.offsetHeight > vspace) && pos.top > node.offsetHeight)
          top = pos.top - node.offsetHeight;
        else if (pos.bottom + node.offsetHeight <= vspace)
          top = pos.bottom;
        if (left + node.offsetWidth > hspace)
          left = hspace - node.offsetWidth;
      }
      node.style.top = top + "px";
      node.style.left = node.style.right = "";
      if (horiz == "right") {
        left = display.sizer.clientWidth - node.offsetWidth;
        node.style.right = "0px";
      } else {
        if (horiz == "left") left = 0;
        else if (horiz == "middle") left = (display.sizer.clientWidth - node.offsetWidth) / 2;
        node.style.left = left + "px";
      }
      if (scroll)
        scrollIntoView(this, left, top, left + node.offsetWidth, top + node.offsetHeight);
    },

    triggerOnKeyDown: operation(null, onKeyDown),

    execCommand: function(cmd) {return commands[cmd](this);},

    findPosH: function(from, amount, unit, visually) {
      var dir = 1;
      if (amount < 0) { dir = -1; amount = -amount; }
      for (var i = 0, cur = clipPos(this.doc, from); i < amount; ++i) {
        cur = findPosH(this.doc, cur, dir, unit, visually);
        if (cur.hitSide) break;
      }
      return cur;
    },

    moveH: operation(null, function(dir, unit) {
      var sel = this.doc.sel, pos;
      if (sel.shift || sel.extend || posEq(sel.from, sel.to))
        pos = findPosH(this.doc, sel.head, dir, unit, this.options.rtlMoveVisually);
      else
        pos = dir < 0 ? sel.from : sel.to;
      extendSelection(this.doc, pos, pos, dir);
    }),

    deleteH: operation(null, function(dir, unit) {
      var sel = this.doc.sel;
      if (!posEq(sel.from, sel.to)) replaceRange(this.doc, "", sel.from, sel.to, "+delete");
      else replaceRange(this.doc, "", sel.from, findPosH(this.doc, sel.head, dir, unit, false), "+delete");
      this.curOp.userSelChange = true;
    }),

    findPosV: function(from, amount, unit, goalColumn) {
      var dir = 1, x = goalColumn;
      if (amount < 0) { dir = -1; amount = -amount; }
      for (var i = 0, cur = clipPos(this.doc, from); i < amount; ++i) {
        var coords = cursorCoords(this, cur, "div");
        if (x == null) x = coords.left;
        else coords.left = x;
        cur = findPosV(this, coords, dir, unit);
        if (cur.hitSide) break;
      }
      return cur;
    },

    moveV: operation(null, function(dir, unit) {
      var sel = this.doc.sel;
      var pos = cursorCoords(this, sel.head, "div");
      if (sel.goalColumn != null) pos.left = sel.goalColumn;
      var target = findPosV(this, pos, dir, unit);

      if (unit == "page") addToScrollPos(this, 0, charCoords(this, target, "div").top - pos.top);
      extendSelection(this.doc, target, target, dir);
      sel.goalColumn = pos.left;
    }),

    toggleOverwrite: function(value) {
      if (value != null && value == this.state.overwrite) return;
      if (this.state.overwrite = !this.state.overwrite)
        this.display.cursor.className += " CodeMirror-overwrite";
      else
        this.display.cursor.className = this.display.cursor.className.replace(" CodeMirror-overwrite", "");
    },
    hasFocus: function() { return this.state.focused; },

    scrollTo: operation(null, function(x, y) {
      updateScrollPos(this, x, y);
    }),
    getScrollInfo: function() {
      var scroller = this.display.scroller, co = scrollerCutOff;
      return {left: scroller.scrollLeft, top: scroller.scrollTop,
              height: scroller.scrollHeight - co, width: scroller.scrollWidth - co,
              clientHeight: scroller.clientHeight - co, clientWidth: scroller.clientWidth - co};
    },

    scrollIntoView: operation(null, function(pos, margin) {
      if (typeof pos == "number") pos = Pos(pos, 0);
      if (!margin) margin = 0;
      var coords = pos;

      if (!pos || pos.line != null) {
        this.curOp.scrollToPos = pos ? clipPos(this.doc, pos) : this.doc.sel.head;
        this.curOp.scrollToPosMargin = margin;
        coords = cursorCoords(this, this.curOp.scrollToPos);
      }
      var sPos = calculateScrollPos(this, coords.left, coords.top - margin, coords.right, coords.bottom + margin);
      updateScrollPos(this, sPos.scrollLeft, sPos.scrollTop);
    }),

    setSize: operation(null, function(width, height) {
      function interpret(val) {
        return typeof val == "number" || /^\d+$/.test(String(val)) ? val + "px" : val;
      }
      if (width != null) this.display.wrapper.style.width = interpret(width);
      if (height != null) this.display.wrapper.style.height = interpret(height);
      if (this.options.lineWrapping)
        this.display.measureLineCache.length = this.display.measureLineCachePos = 0;
      this.curOp.forceUpdate = true;
    }),

    operation: function(f){return runInOp(this, f);},

    refresh: operation(null, function() {
      clearCaches(this);
      updateScrollPos(this, this.doc.scrollLeft, this.doc.scrollTop);
      regChange(this);
    }),

    swapDoc: operation(null, function(doc) {
      var old = this.doc;
      old.cm = null;
      attachDoc(this, doc);
      clearCaches(this);
      resetInput(this, true);
      updateScrollPos(this, doc.scrollLeft, doc.scrollTop);
      return old;
    }),

    getInputField: function(){return this.display.input;},
    getWrapperElement: function(){return this.display.wrapper;},
    getScrollerElement: function(){return this.display.scroller;},
    getGutterElement: function(){return this.display.gutters;}
  };
  eventMixin(CodeMirror);

  // OPTION DEFAULTS

  var optionHandlers = CodeMirror.optionHandlers = {};

  // The default configuration options.
  var defaults = CodeMirror.defaults = {};

  function option(name, deflt, handle, notOnInit) {
    CodeMirror.defaults[name] = deflt;
    if (handle) optionHandlers[name] =
      notOnInit ? function(cm, val, old) {if (old != Init) handle(cm, val, old);} : handle;
  }

  var Init = CodeMirror.Init = {toString: function(){return "CodeMirror.Init";}};

  // These two are, on init, called from the constructor because they
  // have to be initialized before the editor can start at all.
  option("value", "", function(cm, val) {
    cm.setValue(val);
  }, true);
  option("mode", null, function(cm, val) {
    cm.doc.modeOption = val;
    loadMode(cm);
  }, true);

  option("indentUnit", 2, loadMode, true);
  option("indentWithTabs", false);
  option("smartIndent", true);
  option("tabSize", 4, function(cm) {
    loadMode(cm);
    clearCaches(cm);
    regChange(cm);
  }, true);
  option("electricChars", true);
  option("rtlMoveVisually", !windows);

  option("theme", "default", function(cm) {
    themeChanged(cm);
    guttersChanged(cm);
  }, true);
  option("keyMap", "default", keyMapChanged);
  option("extraKeys", null);

  option("onKeyEvent", null);
  option("onDragEvent", null);

  option("lineWrapping", false, wrappingChanged, true);
  option("gutters", [], function(cm) {
    setGuttersForLineNumbers(cm.options);
    guttersChanged(cm);
  }, true);
  option("fixedGutter", true, function(cm, val) {
    cm.display.gutters.style.left = val ? compensateForHScroll(cm.display) + "px" : "0";
    cm.refresh();
  }, true);
  option("coverGutterNextToScrollbar", false, updateScrollbars, true);
  option("lineNumbers", false, function(cm) {
    setGuttersForLineNumbers(cm.options);
    guttersChanged(cm);
  }, true);
  option("firstLineNumber", 1, guttersChanged, true);
  option("lineNumberFormatter", function(integer) {return integer;}, guttersChanged, true);
  option("showCursorWhenSelecting", false, updateSelection, true);

  option("readOnly", false, function(cm, val) {
    if (val == "nocursor") {onBlur(cm); cm.display.input.blur();}
    else if (!val) resetInput(cm, true);
  });
  option("dragDrop", true);

  option("cursorBlinkRate", 530);
  option("cursorScrollMargin", 0);
  option("cursorHeight", 1);
  option("workTime", 100);
  option("workDelay", 100);
  option("flattenSpans", true);
  option("pollInterval", 100);
  option("undoDepth", 40, function(cm, val){cm.doc.history.undoDepth = val;});
  option("historyEventDelay", 500);
  option("viewportMargin", 10, function(cm){cm.refresh();}, true);
  option("maxHighlightLength", 10000, function(cm){loadMode(cm); cm.refresh();}, true);
  option("moveInputWithCursor", true, function(cm, val) {
    if (!val) cm.display.inputDiv.style.top = cm.display.inputDiv.style.left = 0;
  });

  option("tabindex", null, function(cm, val) {
    cm.display.input.tabIndex = val || "";
  });
  option("autofocus", null);

  // MODE DEFINITION AND QUERYING

  // Known modes, by name and by MIME
  var modes = CodeMirror.modes = {}, mimeModes = CodeMirror.mimeModes = {};

  CodeMirror.defineMode = function(name, mode) {
    if (!CodeMirror.defaults.mode && name != "null") CodeMirror.defaults.mode = name;
    if (arguments.length > 2) {
      mode.dependencies = [];
      for (var i = 2; i < arguments.length; ++i) mode.dependencies.push(arguments[i]);
    }
    modes[name] = mode;
  };

  CodeMirror.defineMIME = function(mime, spec) {
    mimeModes[mime] = spec;
  };

  CodeMirror.resolveMode = function(spec) {
    if (typeof spec == "string" && mimeModes.hasOwnProperty(spec)) {
      spec = mimeModes[spec];
    } else if (spec && typeof spec.name == "string" && mimeModes.hasOwnProperty(spec.name)) {
      var found = mimeModes[spec.name];
      spec = createObj(found, spec);
      spec.name = found.name;
    } else if (typeof spec == "string" && /^[\w\-]+\/[\w\-]+\+xml$/.test(spec)) {
      return CodeMirror.resolveMode("application/xml");
    }
    if (typeof spec == "string") return {name: spec};
    else return spec || {name: "null"};
  };

  CodeMirror.getMode2015-09-19 12:40:00,728 [main] INFO  c.n.h.c.p.n.NettyAsyncHttpProvider - Number of application's worked threads is 4
2015-09-19 12:40:02,940 [pool-5-thread-1] INFO  c.n.h.c.p.n.NettyAsyncHttpProvider - Number of application's worked threads is 4
2015-09-19 12:40:03,205 [main] ERROR o.e.r.i.r.repo.ModelRepositoryIndex - Failed to open search index.
org.apache.lucene.index.IndexNotFoundException: no segments* file found in org.apache.lucene.store.SimpleFSDirectory@E:\Orientacion a objetos\EclipsePortable\Data\workspace\.metadata\.plugins\org.eclipse.recommenders.rcp\index lockFactory=org.apache.lucene.store.NativeFSLockFactory@14c350e: files: []
	at org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(SegmentInfos.java:712) ~[org.apache.lucene.core_3.5.0.v20120319-2345.jar:3.5.0 1204988 - simon - 2011-11-22 14:46:51]
	at org.apache.lucene.index.DirectoryReader.open(DirectoryReader.java:75) ~[org.apache.lucene.core_3.5.0.v20120319-2345.jar:3.5.0 1204988 - simon - 2011-11-22 14:46:51]
	at org.apache.lucene.index.IndexReader.open(IndexReader.java:462) ~[org.apache.lucene.core_3.5.0.v20120319-2345.jar:3.5.0 1204988 - simon - 2011-11-22 14:46:51]
	at org.apache.lucene.index.IndexReader.open(IndexReader.java:308) ~[org.apache.lucene.core_3.5.0.v20120319-2345.jar:3.5.0 1204988 - simon - 2011-11-22 14:46:51]
	at org.eclipse.recommenders.internal.rcp.repo.ModelRepositoryIndex.open(ModelRepositoryIndex.java:64) ~[org.eclipse.recommenders.rcp_1.0.0.v20120612-2305-b156.jar:na]
	at org.eclipse.recommenders.internal.rcp.wiring.RecommendersModule$ServicesInitializer.<init>(RecommendersModule.java:353) [org.eclipse.recommenders.rcp_1.0.0.v20120612-2305-b156.jar:na]
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) [na:1.6.0_31]
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source) [na:1.6.0_31]
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source) [na:1.6.0_31]
	at java.lang.reflect.Constructor.newInstance(Unknown Source) [na:1.6.0_31]
	at com.google.inject.internal.DefaultConstructionProxyFactory$1.newInstance(DefaultConstructionProxyFactory.java:85) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.ConstructorInjector.construct(ConstructorInjector.java:85) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.ConstructorBindingImpl$Factory.get(ConstructorBindingImpl.java:254) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:46) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1031) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:40) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.Scopes$1$1.get(Scopes.java:65) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:40) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.InternalInjectorCreator$1.call(InternalInjectorCreator.java:204) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.InternalInjectorCreator$1.call(InternalInjectorCreator.java:198) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.InjectorImpl.callInContext(InjectorImpl.java:1024) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.InternalInjectorCreator.loadEagerSingletons(InternalInjectorCreator.java:198) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.InternalInjectorCreator.injectDynamically(InternalInjectorCreator.java:179) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.internal.InternalInjectorCreator.build(InternalInjectorCreator.java:109) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.Guice.createInjector(Guice.java:95) [com.google.inject_3.0.0.v201203062045.jar:na]
	at com.google.inject.Guice.createInjector(Guice.java:72) [com.google.inject_3.0.0.v201203062045.jar:na]
	at org.eclipse.recommenders.injection.InjectionService.getInjector(InjectionService.java:47) [org.eclipse.recommenders.injection_1.0.0.v20120612-2305-b156.jar:na]
	at org.eclipse.recommenders.injection.ExtensionFactory.<init>(ExtensionFactory.java:28) [org.eclipse.recommenders.injection_1.0.0.v20120612-2305-b156.jar:na]
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) [na:1.6.0_31]
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source) [na:1.6.0_31]
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source) [na:1.6.0_31]
	at java.lang.reflect.Constructor.newInstance(Unknown Source) [na:1.6.0_31]
	at java.lang.Class.newInstance0(Unknown Source) [na:1.6.0_31]
	at java.lang.Class.newInstance(Unknown Source) [na:1.6.0_31]
	at org.eclipse.core.internal.registry.osgi.RegistryStrategyOSGI.createExecutableExtension(RegistryStrategyOSGI.java:184) [org.eclipse.equinox.registry_3.5.200.v20120522-1841.jar:na]
	at org.eclipse.core.internal.registry.ExtensionRegistry.createExecutableExtension(ExtensionRegistry.java:905) [org.eclipse.equinox.registry_3.5.200.v20120522-1841.jar:na]
	at org.eclipse.core.internal.registry.ConfigurationElement.createExecutableExtension(ConfigurationElement.java:243) [org.eclipse.equinox.registry_3.5.200.v20120522-1841.jar:na]
	at org.eclipse.core.internal.registry.ConfigurationElementHandle.createExecutableExtension(ConfigurationElementHandle.java:55) [org.eclipse.equinox.registry_3.5.200.v20120522-1841.jar:na]
	at org.eclipse.jdt.internal.ui.text.java.CompletionProposalComputerDescriptor.createComputer(CompletionProposalComputerDescriptor.java:308) [org.eclipse.jdt.ui_3.8.0.v20120524-1551.jar:na]
	at org.eclipse.jdt.internal.ui.text.java.CompletionProposalComputerDescriptor.getComputer(CompletionProposalComputerDescriptor.java:275) [org.eclipse.jdt.ui_3.8.0.v20120524-1551.jar:na]
	at org.eclipse.jdt.internal.ui.text.java.CompletionProposalComputerDescriptor.sessionStarted(CompletionProposalComputerDescriptor.java:418) [org.eclipse.jdt.ui_3.8.0.v20120524-1551.jar:na]
	at org.eclipse.jdt.internal.ui.text.java.CompletionProposalCategory.sessionStarted(CompletionProposalCategory.java:379) [org.eclipse.jdt.ui_3.8.0.v20120524-1551.jar:na]
	at org.eclipse.jdt.internal.ui.text.java.ContentAssistProcessor$CompletionListener.assistSessionStarted(ContentAssistProcessor.java:117) [org.eclipse.jdt.ui_3.8.0.v20120524-1551.jar:na]
	at org.eclipse.jface.text.contentassist.ContentAssistant.fireSessionBeginEvent(ContentAssistant.java:2221) [org.eclipse.jface.text_3.8.0.v20120531-0600.jar:na]
	at org.eclipse.jface.text.contentassist.ContentAssistant.prepareToShowCompletions(ContentAssistant.java:1696) [org.eclipse.jface.text_3.8.0.v20120531-0600.jar:na]
	at org.eclipse.jface.text.contentassist.ContentAssistant.access$6(ContentAssistant.java:1687) [org.eclipse.jface.text_3.8.0.v20120531-0600.jar:na]
	at org.eclipse.jface.text.contentassist.ContentAssistant$2.run(ContentAssistant.java:376) [org.eclipse.jface.text_3.8.0.v20120531-0600.jar:na]
	at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35) [org.eclipse.swt.win32.win32.x86_3.100.0.v4233d.jar:na]
	at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:135) [org.eclipse.swt.win32.win32.x86_3.100.0.v4233d.jar:na]
	at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:4144) [org.eclipse.swt.win32.win32.x86_3.100.0.v4233d.jar:na]
	at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3761) [org.eclipse.swt.win32.win32.x86_3.100.0.v4233d.jar:na]
	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1022) [org.eclipse.e4.ui.workbench.swt_0.10.1.v20120525-2014.jar:na]
	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) [org.eclipse.core.databinding.observable_1.4.1.v20120521-2329.jar:na]
	at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:916) [org.eclipse.e4.ui.workbench.swt_0.10.1.v20120525-2014.jar:na]
	at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:86) [org.eclipse.e4.ui.workbench_0.10.2.v20120531-1742.jar:na]
	at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:585) [org.eclipse.ui.workbench_3.103.0.v20120530-1824.jar:na]
	at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) [org.eclipse.core.databinding.observable_1.4.1.v20120521-2329.jar:na]
	at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:540) [org.eclipse.ui.workbench_3.103.0.v20120530-1824.jar:na]
	at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149) [org.eclipse.ui.workbench_3.103.0.v20120530-1824.jar:na]
	at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:124) [org.eclipse.ui.ide.application_1.0.400.v20120523-1955.jar:na]
	at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) [org.eclipse.equinox.app_1.3.100.v20120522-1841.jar:na]
	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110) [org.eclipse.osgi_3.8.0.v20120529-1548.jar:na]
	at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79) [org.eclipse.osgi_3.8.0.v20120529-1548.jar:na]
	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:353) [org.eclipse.osgi_3.8.0.v20120529-1548.jar:na]
	at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:180) [org.eclipse.osgi_3.8.0.v20120529-1548.jar:na]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.6.0_31]
	at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) ~[na:1.6.0_31]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) ~[na:1.6.0_31]
	at java.lang.reflect.Method.invoke(Unknown Source) ~[na:1.6.0_31]
	at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:629) [org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar:na]
	at org.eclipse.equinox.launcher.Main.basicRun(Main.java:584) [org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar:na]
	at org.eclipse.equinox.launcher.Main.run(Main.java:1438) [org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar:na]
2015-09-19 12:40:09,870 [pool-8-thread-1] INFO  c.n.h.c.p.n.NettyAsyncHttpProvider - Number of application's worked threads is 4
2015-09-19 12:42:39,100 [pool-10-thread-1] INFO  c.n.h.c.p.n.NettyAsyncHttpProvider - Number of application's worked threads is 4
2015-09-19 12:42:40,478 [pool-12-thread-1] INFO  c.n.h.c.p.n.NettyAsyncHttpProvider - Number of application's worked threads is 4
2015-09-19 12:42:41,623 [pool-14-thread-1] INFO  c.n.h.c.p.n.NettyAsyncHttpProvider - Number of application's worked threads is 4
2015-09-20 20:02:57,410 [main] INFO  c.n.h.c.p.n.NettyAsyncHttpProvider - Number of application's worked threads is 4
2015-09-21 18:53:33,828 [main] INFO  c.n.h.c.p.n.NettyAsyncHttpProvider - Number of application's worked threads is 2
2015-09-21 18:53:36,093 [Worker-0] WARN  o.e.r.i.rcp.repo.ModelRepository - 'remote-models (http://download.eclipse.org/recommenders/models/juno/, releases+snapshots)' did not send ETAG header for 'org.eclipse.recommenders:index:zip:0.0.0'.
2015-09-21 18:53:39,296 [pool-6-thread-1] INFO  c.n.h.c.p.n.NettyAsyncHttpProvider - Number of application's worked threads is 2
2015-09-21 18:53:39,625 [Worker-0] WARN  o.e.r.i.rcp.repo.ModelRepository - 'remote-models (http://download.eclipse.org/recommenders/models/juno/, releases+snapshots)' did not send ETAG header for 'org.eclipse.recommenders:index:zip:0.0.0'.
